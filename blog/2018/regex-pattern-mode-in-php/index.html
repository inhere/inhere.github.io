<!doctype html><html lang=zh-Hans><head><meta charset=UTF-8><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://inhere.github.io name=base><title>
Inhere's Site • php中正则表达式的模式修饰符</title><link href=https://inhere.github.io/icons/favicon.ico rel=icon type=image/png><link title="Inhere's Site - Atom Feed" href=https://inhere.github.io/atom.xml rel=alternate type=application/atom+xml><link href="https://inhere.github.io/custom_subset.css?h=0b9535a28bc3d5bf2321" rel=stylesheet><link href="https://inhere.github.io/main.css?h=045c365e19a4d50a64bb" rel=stylesheet><link href="https://inhere.github.io/custom.css?h=b0b090835487d694b863" rel=stylesheet><link href="https://inhere.github.io/skins/blue.css?h=a4dc1e94d3f5759784d2" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="PHP正则表达式模式中可用的模式修饰符 — 模式修饰符…" name=description><meta content="PHP正则表达式模式中可用的模式修饰符 — 模式修饰符…" property=og:description><meta content=php中正则表达式的模式修饰符 property=og:title><meta content=article property=og:type><meta content=zh_CN property=og:locale><meta content=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/ property=og:url><meta content="Inhere's Site" property=og:site_name><noscript><link href=https://inhere.github.io/no_js.css rel=stylesheet></noscript><script src=https://inhere.github.io/js/initializeTheme.min.js></script><script defer src=https://inhere.github.io/js/themeSwitcher.min.js></script><body><a href=#main-content id=skip-link>跳到内容</a><header><nav class=navbar><div class=nav-title><a class=home-title href=https://inhere.github.io/>Inhere's Site</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/blog/>📝 Blog </a><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/projects/>🚀 Projects </a><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/collections/>📚 Collections </a><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/tags/>🏷️ Tags </a><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/archive/>🗄️ Archive </a><li><a class="nav-links no-hover-padding" href=https://github.com/inhere>🐱 Github </a><li class=menu-icons-container><ul class=menu-icons-group><li class="theme-switcher-wrapper js"><div aria-label=切换到暗模式 aria-pressed=false class=theme-switcher role=button tabindex=0 title=切换到暗/亮模式></div><div class="theme-resetter arrow" aria-hidden=true aria-label=将模式重置为网站默认值 role=button tabindex=0 title=将模式重置为网站默认值></div></ul></ul></div></nav></header><div class=content id=main-content><main><article class=h-entry><h1 class="p-name article-title">php中正则表达式的模式修饰符</h1><a class="u-url u-uid" href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/></a><ul class=meta><span class="hidden p-author h-card"> <a class=u-url href=https://inhere.github.io rel=author title=Inhere>Inhere</a> </span><li><time class=dt-published datetime=2018-01-03T21:04:00>3 1月 2018</time><li title="1488 字"><span aria-hidden=true class=separator>•</span>8 分钟阅读<li class=tag><span aria-hidden=true class=separator>•</span>标签: <li class=tag><a class=p-category href=https://inhere.github.io/tags/php/>php</a>, <li class=tag><a class=p-category href=https://inhere.github.io/tags/regex/>regex</a></ul><section class="e-content body"><p>PHP正则表达式模式中可用的模式修饰符 — 模式修饰符</p><span id=continue-reading></span><pre class="language-php z-code" data-lang=php><code class=language-php data-lang=php><span class="z-embedding z-php"><span class="z-text z-html z-basic">$pattern = '/\{\*.*?\*\}/sm'
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic">                          |
</span></span><span class="z-embedding z-php"><span class="z-text z-html z-basic">                      模式修饰符
</span></span></code></pre><p>下面列出了当前可用的 PCRE 修饰符。括号中提到的名字是 PCRE 内部这些修饰符的名称。 模式修饰符中的空格，换行符会被忽略，其他字符会导致错误。<h2 id=i-pcre-caseless><a aria-label="Anchor link for: i-pcre-caseless" class="header-anchor no-hover-padding" href=#i-pcre-caseless><span aria-hidden=true class=link-icon></span></a> i (PCRE_CASELESS)</h2><p>如果设置了这个修饰符，模式中的字母会进行<strong>大小写不敏感匹配</strong>。<h2 id=m-pcre-multiline><a aria-label="Anchor link for: m-pcre-multiline" class="header-anchor no-hover-padding" href=#m-pcre-multiline><span aria-hidden=true class=link-icon></span></a> m (PCRE_MULTILINE)</h2><p>默认情况下，PCRE 认为目标字符串是由单行字符组成的(然而实际上它可能会包含多行)， “行首“元字符 (<code>^</code>) 仅匹配字符串的开始位置， 而“行末“元字符 (<code>$</code>) 仅匹配字符串末尾， 或者最后的换行符(除非设置了 <code>D</code> 修饰符)。这个行为和 perl 相同。<p>当这个修饰符设置之后，“行首”和“行末”就会匹配目标字符串中 <strong>任意换行符之前或之后</strong>，另外， 还分别匹配目标字符串的 <strong>最开始和最末尾</strong>位置。<blockquote><p>这等同于 perl 的 <code>/m</code> 修饰符。如果目标字符串 中没有 <code>\n</code> 字符，或者模式中没有出现 <code>^</code> 或 <code>$</code>，设置这个修饰符不产生任何影响。</blockquote><h2 id=s-pcre-dotall><a aria-label="Anchor link for: s-pcre-dotall" class="header-anchor no-hover-padding" href=#s-pcre-dotall><span aria-hidden=true class=link-icon></span></a> s (PCRE_DOTALL)</h2><p>如果设置了这个修饰符，模式中的点号(<code>.</code>)元字符匹配所有字符，<strong>包含换行符</strong>。 如果没有这个修饰符，点号(<code>.</code>)不匹配换行符。<blockquote><p>这个修饰符等同于 perl 中的 <code>/s</code> 修饰符。 一个取反字符类比如 <code>[^a]</code> 总是匹配换行符，而不依赖于这个修饰符的设置。</blockquote><h2 id=x-pcre-extended><a aria-label="Anchor link for: x-pcre-extended" class="header-anchor no-hover-padding" href=#x-pcre-extended><span aria-hidden=true class=link-icon></span></a> x (PCRE_EXTENDED)</h2><p>如果设置了这个修饰符，模式中的没有经过转义的或不在字符类中的空白数据字符总会被忽略， 并且位于一个未转义的字符类外部的 <code>#</code> 字符和下一个换行符之间的字符也被忽略。<blockquote><p>这个修饰符 等同于 perl 中的 <code>/x</code> 修饰符，使被编译模式中可以包含注释。</blockquote><p><strong>注意：</strong><blockquote><p>这仅用于数据字符。 空白字符 还是不能在模式的特殊字符序列中出现，比如序列 <code>(?(</code> 引入了一个条件子组 (译注: 这种语法定义的 特殊字符序列中如果出现空白字符会导致编译错误。 比如<code>(?(</code>就会导致错误)。</blockquote><h2 id=e-preg-replace-eval><a aria-label="Anchor link for: e-preg-replace-eval" class="header-anchor no-hover-padding" href=#e-preg-replace-eval><span aria-hidden=true class=link-icon></span></a> e (PREG_REPLACE_EVAL)</h2><blockquote><p>Warning: This feature was DEPRECATED in PHP 5.5.0, and REMOVED as of PHP 7.0.0.</blockquote><p>如果设置了这个被弃用的修饰符， <code>preg_replace()</code> 在进行了对替换字符串的 后向引用替换之后, 将替换后的字符串作为php 代码评估执行(eval 函数方式)，并使用执行结果 作为实际参与替换的字符串。单引号、双引号、反斜线()和 NULL 字符在 后向引用替换时会被用反斜线转义.<p>请确保 replacement 参数由合法 php 代码字符串组成，否则 php 将会 在<code>preg_replace()</code> 调用的行上产生一个解释错误。<p>不建议使用此修饰符，它很容易产生安全漏洞：<blockquote><p>Notice: 仅 <code>preg_replace()</code> 使用此修饰符，其他 PCRE 函数忽略此修饰符。</blockquote><h2 id=a-pcre-anchored><a aria-label="Anchor link for: a-pcre-anchored" class="header-anchor no-hover-padding" href=#a-pcre-anchored><span aria-hidden=true class=link-icon></span></a> A (PCRE_ANCHORED)</h2><p>如果设置了这个修饰符，模式被强制为“锚定“模式，也就是说约束匹配使其仅从 目标字符串的开始位置搜索。 这个效果同样可以使用适当的模式构造出来，并且 这也是 perl 种实现这种模式的唯一途径。<h2 id=d-pcre-dollar-endonly><a aria-label="Anchor link for: d-pcre-dollar-endonly" class="header-anchor no-hover-padding" href=#d-pcre-dollar-endonly><span aria-hidden=true class=link-icon></span></a> D (PCRE_DOLLAR_ENDONLY)</h2><p>如果这个修饰符被设置，模式中的元字符美元符号(<code>$</code>)仅仅匹配目标字符串的末尾。 如果这个修饰符 没有设置，当字符串以一个换行符结尾时， 美元符号还会匹配该换行符(但不会匹配之前的任何换行符)。 如果设置了修饰符 <code>m</code>，这个修饰符被忽略.<blockquote><p>在 perl 中没有与此修饰符等同的修饰符。</blockquote><h2 id=s><a aria-label="Anchor link for: s" class="header-anchor no-hover-padding" href=#s><span aria-hidden=true class=link-icon></span></a> S</h2><p>当一个模式需要多次使用的时候，为了得到匹配速度的提升，值得花费一些时间 对其进行一些额外的分析。 如果设置了这个修饰符，这个额外的分析就会执行。 当前， 这种对一个模式的分析仅仅适用于非锚定模式的匹配(即没有单独的固定开始字符)。<h2 id=u-pcre-ungreedy><a aria-label="Anchor link for: u-pcre-ungreedy" class="header-anchor no-hover-padding" href=#u-pcre-ungreedy><span aria-hidden=true class=link-icon></span></a> U (PCRE_UNGREEDY)</h2><p>这个修饰符逆转了量词的“贪婪“模式。 使量词默认为非贪婪的，通过量词后紧跟 <code>?</code> 的方式可以使其成为贪婪的。 这和 perl 是不兼容的。 它同样可以使用 <a rel="noopener nofollow noreferrer" class=external href=http://php.net/manual/zh/regexp.reference.internal-options.php target=_blank>模式内修饰符设置</a> <code>(?U)</code> 进行设置， 或者在量词后以问号标记其非贪婪(比如<code>.*?</code>)。<blockquote><p>Note: 在非贪婪模式，通常不能匹配超过 <code>pcre.backtrack_limit</code> 的字符。</blockquote><h2 id=x-pcre-extra><a aria-label="Anchor link for: x-pcre-extra" class="header-anchor no-hover-padding" href=#x-pcre-extra><span aria-hidden=true class=link-icon></span></a> X (PCRE_EXTRA)</h2><p>这个修饰符打开了 PCRE 与 perl 不兼容的附件功能。模式中的任意反斜线后就 ingen 一个 没有特殊含义的字符都会导致一个错误，以此保留这些字符以保证向后兼容性。 默认情况下，在 perl 中，反斜线紧跟一个没有特殊含义的字符被认为是该字符的原文。 当前没有其他特性由这个修饰符控制。<h2 id=j-pcre-info-jchanged><a aria-label="Anchor link for: j-pcre-info-jchanged" class="header-anchor no-hover-padding" href=#j-pcre-info-jchanged><span aria-hidden=true class=link-icon></span></a> J (PCRE_INFO_JCHANGED)</h2><p>内部选项设置(<code>?J</code>)修改本地的 PCRE_DUPNAMES 选项。允许子组重名， (译注：只能通过内部选项设置，外部的 <code>/J</code> 设置会产生错误。)<h2 id=u-pcre-utf8><a aria-label="Anchor link for: u-pcre-utf8" class="header-anchor no-hover-padding" href=#u-pcre-utf8><span aria-hidden=true class=link-icon></span></a> u (PCRE_UTF8)</h2><p>此修正符打开一个与 perl 不兼容的附加功能。 模式和目标字符串都被认为是 <code>utf-8</code> 的。 无效的目标字符串会导致 <code>preg_*</code> 函数什么都匹配不到； 无效的模式字符串会导致 E_WARNING 级别的错误。<p>PHP 5.3.4 后，5字节和6字节的 UTF-8 字符序列被考虑为无效（resp. PCRE 7.3 2007-08-28）。 以前就被认为是无效的 UTF-8。<blockquote><p>From: http://php.net/manual/zh/reference.pcre.pattern.modifiers.php</blockquote></section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=button for=toc-toggle id=toc-button title=切换目录><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#i-pcre-caseless>i (PCRE_CASELESS)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#m-pcre-multiline>m (PCRE_MULTILINE)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#s-pcre-dotall>s (PCRE_DOTALL)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#x-pcre-extended>x (PCRE_EXTENDED)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#e-preg-replace-eval>e (PREG_REPLACE_EVAL)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#a-pcre-anchored>A (PCRE_ANCHORED)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#d-pcre-dollar-endonly>D (PCRE_DOLLAR_ENDONLY)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#s>S</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#u-pcre-ungreedy>U (PCRE_UNGREEDY)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#x-pcre-extra>X (PCRE_EXTRA)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#j-pcre-info-jchanged>J (PCRE_INFO_JCHANGED)</a><li><a href=https://inhere.github.io/blog/2018/regex-pattern-mode-in-php/#u-pcre-utf8>u (PCRE_UTF8)</a></ul></div></div></div><a class=no-hover-padding href=# id=top-button title=返回页面顶部> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> 已复制! </span><span class=hidden id=copy-init> 复制代码到剪贴板 </span><script defer src=https://inhere.github.io/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer" href=https://inhere.github.io/atom.xml target=_blank> <img alt=feed loading=lazy src=https://inhere.github.io/social_icons/rss.svg title=feed> </a><li><a class="nav-links no-hover-padding social" rel="noopener noreferrer me" href=https://github.com/inhere/ target=_blank> <img alt=github loading=lazy src=https://inhere.github.io/social_icons/github.svg title=github> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/pages/about> 🐶 About </a><li><a class="nav-links no-hover-padding" href=https://github.com/gookit> 🐱 Gookit </a><li><a class="nav-links no-hover-padding" href=https://github.com/phppkg> 🐱 PHPPkg </a><li><a class="nav-links no-hover-padding" href=https://inhere.github.io/sitemap.xml> 📄 Sitemap </a></ul> </small></nav><div class=credits><small> 网站基于 <a rel="noopener noreferrer" href=https://www.getzola.org target=_blank>Zola</a> 和 <a rel="noopener noreferrer" href=https://github.com/welpo/tabi target=_blank>tabi</a> • <a rel="noopener noreferrer" href=https://github.com/inhere/inhere.github.io target=_blank> 查看原始码 </a></small></div></section></footer>