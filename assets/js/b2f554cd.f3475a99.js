"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1477],{10:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"gookit-config-intro","metadata":{"permalink":"/blog/gookit-config-intro","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2022/08-31-gookit-config-intro.md","source":"@site/blog/2022/08-31-gookit-config-intro.md","title":"gookit/config - Go\u8bed\u8a00\u8bfb\u53d6\u591a\u79cd\u683c\u5f0f\u914d\u7f6e\u6587\u4ef6","description":"gookit/config - Go\u5e94\u7528\u914d\u7f6e\u7ba1\u7406\uff0c\u652f\u6301\u8bfb\u53d6\u591a\u79cd\u683c\u5f0f JSON(\u9ed8\u8ba4), JSON5, INI, Properties, YAML, TOML, HCL, ENV, Flags\uff0c\u591a\u6587\u4ef6\u52a0\u8f7d\uff0c\u652f\u6301\u6570\u636e\u5408\u5e76\uff0c\u89e3\u6790\u73af\u5883\u53d8\u91cf\u540d\u7b49\u7b49","date":"2022-08-31T13:25:00.000Z","formattedDate":"2022\u5e748\u670831\u65e5","tags":[{"label":"golang","permalink":"/blog/tags/golang"},{"label":"config","permalink":"/blog/tags/config"},{"label":"management","permalink":"/blog/tags/management"},{"label":"gookit","permalink":"/blog/tags/gookit"}],"readingTime":5.025,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"gookit/config - Go\u8bed\u8a00\u8bfb\u53d6\u591a\u79cd\u683c\u5f0f\u914d\u7f6e\u6587\u4ef6","tags":["golang","config","management","gookit"],"date":"2022-08-31T13:25","slug":"gookit-config-intro","authors":"inhere"},"nextItem":{"title":"\u901a\u8fc7 scoop \u5728Windows \u4e0b\u5b89\u88c5\u5de5\u5177","permalink":"/blog/install-tools-by-scoop-on-windows"}},"content":"`gookit/config` - Go\u5e94\u7528\u914d\u7f6e\u7ba1\u7406\uff0c\u652f\u6301\u8bfb\u53d6\u591a\u79cd\u683c\u5f0f `JSON`(\u9ed8\u8ba4), `JSON5`, `INI`, `Properties`, `YAML`, `TOML`, `HCL`, `ENV`, `Flags`\uff0c\u591a\u6587\u4ef6\u52a0\u8f7d\uff0c\u652f\u6301\u6570\u636e\u5408\u5e76\uff0c\u89e3\u6790\u73af\u5883\u53d8\u91cf\u540d\u7b49\u7b49\\n\\n\x3c!--truncate--\x3e\\n\\n## \u529f\u80fd\u7b80\u4ecb\\n\\n- \u652f\u6301\u591a\u79cd\u683c\u5f0f: `JSON`(\u9ed8\u8ba4), `JSON5`, `INI`, `Properties`, `YAML`, `TOML`, `HCL`, `ENV`, `Flags`\\n  - `JSON` \u5185\u5bb9\u652f\u6301\u6ce8\u91ca\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u89e3\u6790\u65f6\u6e05\u9664\u6ce8\u91ca\\n  - \u5176\u4ed6\u9a71\u52a8\u90fd\u662f\u6309\u9700\u4f7f\u7528\uff0c\u4e0d\u4f7f\u7528\u7684\u4e0d\u4f1a\u52a0\u8f7d\u7f16\u8bd1\u5230\u5e94\u7528\u4e2d\\n- \u652f\u6301\u591a\u4e2a\u6587\u4ef6\u3001\u591a\u6570\u636e\u52a0\u8f7d\\n- \u652f\u6301\u4ece OS ENV \u53d8\u91cf\u6570\u636e\u52a0\u8f7d\u914d\u7f6e\\n- \u652f\u6301\u4ece\u8fdc\u7a0b URL \u52a0\u8f7d\u914d\u7f6e\u6570\u636e\\n- \u652f\u6301\u4ece\u547d\u4ee4\u884c\u53c2\u6570(`flags`)\u8bbe\u7f6e\u914d\u7f6e\u6570\u636e\\n- \u652f\u6301\u5728\u914d\u7f6e\u6570\u636e\u66f4\u6539\u65f6\u89e6\u53d1\u4e8b\u4ef6\\n  - \u53ef\u7528\u4e8b\u4ef6: `set.value`, `set.data`, `load.data`, `clean.data`\\n- \u652f\u6301\u6570\u636e\u8986\u76d6\u5408\u5e76\uff0c\u52a0\u8f7d\u591a\u4efd\u6570\u636e\u65f6\u5c06\u6309key\u81ea\u52a8\u5408\u5e76\\n- \u652f\u6301\u5c06\u5168\u90e8\u6216\u90e8\u5206\u914d\u7f6e\u6570\u636e\u7ed1\u5b9a\u5230\u7ed3\u6784\u4f53 `config.BindStruct(\\"key\\", &s)`\\n  - NEW: \u652f\u6301\u901a\u8fc7\u7ed3\u6784\u4f53\u6807\u7b7e `default` \u89e3\u6790\u5e76\u8bbe\u7f6e\u9ed8\u8ba4\u503c\\n- \u652f\u6301\u901a\u8fc7 `.` \u5206\u9694\u7b26\u6765\u6309\u8def\u5f84\u83b7\u53d6\u5b50\u7ea7\u503c\uff0c\u4e5f\u652f\u6301\u81ea\u5b9a\u4e49\u5206\u9694\u7b26\u3002 e.g `map.key` `arr.2`\\n- \u652f\u6301\u89e3\u6790ENV\u53d8\u91cf\u540d\u79f0\u3002 like `shell: ${SHELL}` -> `shell: /bin/zsh`\\n- \u7b80\u6d01\u7684\u4f7f\u7528API `Get` `Int` `Uint` `Int64` `String` `Bool` `Ints` `IntMap` `Strings` `StringMap` ...\\n- \u5b8c\u5584\u7684\u5355\u5143\u6d4b\u8bd5(code coverage > 95%)\\n\\n> Github: https://github.com/gookit/config\\n\\n## \u4f7f\u7528\u793a\u4f8b\\n\\n\u8fd9\u91cc\u4f7f\u7528yaml\u683c\u5f0f\u5185\u5bb9\u4f5c\u4e3a\u793a\u4f8b:\\n\\n```yaml\\nname: app2\\ndebug: false\\nbaseKey: value2\\nshell: ${SHELL}\\nenvKey1: ${NotExist|defValue}\\n\\nmap1:\\n    key: val2\\n    key2: val20\\n\\narr1:\\n    - val1\\n    - val21\\n```\\n\\n\\n> \u793a\u4f8b\u4ee3\u7801\u8bf7\u770b [_examples/yaml.go](https://github.com/gookit/config/blob/master/_examples/yaml.go):\\n\\n```go\\npackage main\\n\\nimport (\\n    \\"github.com/gookit/config/v2\\"\\n    \\"github.com/gookit/config/v2/yamlv3\\"\\n)\\n\\n// go run ./examples/yaml.go\\nfunc main() {\\n\\t// \u8bbe\u7f6e\u9009\u9879\u652f\u6301 ENV \u89e3\u6790\\n\\tconfig.WithOptions(config.ParseEnv)\\n\\n\\t// \u6dfb\u52a0\u9a71\u52a8\u7a0b\u5e8f\u4ee5\u652f\u6301yaml\u5185\u5bb9\u89e3\u6790\uff08\u9664\u4e86JSON\u662f\u9ed8\u8ba4\u652f\u6301\uff0c\u5176\u4ed6\u7684\u5219\u662f\u6309\u9700\u4f7f\u7528\uff09\\n\\tconfig.AddDriver(yamlv3.Driver)\\n\\n\\t// \u52a0\u8f7d\u914d\u7f6e\uff0c\u53ef\u4ee5\u540c\u65f6\u4f20\u5165\u591a\u4e2a\u6587\u4ef6\\n\\terr := config.LoadFiles(\\"testdata/yml_base.yml\\")\\n\\tif err != nil {\\n\\t\\tpanic(err)\\n\\t}\\n\\n\\t// fmt.Printf(\\"config data: \\\\n %#v\\\\n\\", config.Data())\\n\\n\\t// \u52a0\u8f7d\u66f4\u591a\u6587\u4ef6\\n\\terr = config.LoadFiles(\\"testdata/yml_other.yml\\")\\n\\t// \u4e5f\u53ef\u4ee5\u4e00\u6b21\u6027\u52a0\u8f7d\u591a\u4e2a\u6587\u4ef6\\n\\t// err := config.LoadFiles(\\"testdata/yml_base.yml\\", \\"testdata/yml_other.yml\\")\\n\\tif err != nil {\\n\\t\\tpanic(err)\\n\\t}\\n}\\n```\\n\\n### \u4f7f\u7528\u8bf4\u660e\\n\\n- \u53ef\u4ee5\u4f7f\u7528 `WithOptions()` \u6dfb\u52a0\u66f4\u591a\u989d\u5916\u9009\u9879\u529f\u80fd. \u4f8b\u5982: `ParseEnv`, `ParseDefault`\\n- \u53ef\u4ee5\u4f7f\u7528 `AddDriver()` \u6dfb\u52a0\u9700\u8981\u4f7f\u7528\u7684\u683c\u5f0f\u9a71\u52a8\u5668(`json` \u662f\u9ed8\u8ba4\u52a0\u8f7d\u7684\u7684,\u65e0\u9700\u6dfb\u52a0)\\n- \u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528 `LoadFiles()` `LoadStrings()` \u7b49\u65b9\u6cd5\u52a0\u8f7d\u914d\u7f6e\u6570\u636e\\n  - \u53ef\u4ee5\u4f20\u5165\u591a\u4e2a\u6587\u4ef6,\u4e5f\u53ef\u4ee5\u8c03\u7528\u591a\u6b21\\n  - \u591a\u6b21\u52a0\u8f7d\u7684\u6570\u636e\u4f1a\u81ea\u52a8\u6309key\u8fdb\u884c\u5408\u5e76\u5904\u7406\\n\\n### \u7ed1\u5b9a\u6570\u636e\u5230\u7ed3\u6784\u4f53\\n\\n> \u6ce8\u610f\uff1a\u7ed3\u6784\u4f53\u9ed8\u8ba4\u7684\u7ed1\u5b9a\u6620\u5c04tag\u662f `mapstructure`\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e `Options.TagName` \u6765\u66f4\u6539\u5b83\\n\\n```go\\ntype User struct {\\n  Age  int  `mapstructure:\\"age\\"`\\n  Key  string `mapstructure:\\"key\\"`\\n  UserName  string `mapstructure:\\"user_name\\"`\\n  Tags []int  `mapstructure:\\"tags\\"`\\n}\\n\\nuser := User{}\\nerr = config.BindStruct(\\"user\\", &user)\\n\\nfmt.Println(user.UserName) // inhere\\n```\\n\\n**\u66f4\u6539\u7ed3\u6784\u6807\u7b7e\u540d\u79f0**\\n\\n```go\\nconfig.WithOptions(func(opt *Options) {\\n    options.DecoderConfig.TagName = \\"config\\"\\n})\\n\\n// use custom tag name.\\ntype User struct {\\n  Age  int  `config:\\"age\\"`\\n  Key  string `config:\\"key\\"`\\n  UserName  string `config:\\"user_name\\"`\\n  Tags []int  `config:\\"tags\\"`\\n}\\n\\nuser := User{}\\nerr = config.Decode(&user)\\n```\\n\\n\u5c06\u6240\u6709\u914d\u7f6e\u6570\u636e\u7ed1\u5b9a\u5230\u7ed3\u6784:\\n\\n```go\\nconfig.Decode(&myConf)\\n// \u4e5f\u53ef\u4ee5\\nconfig.BindStruct(\\"\\", &myConf)\\n```\\n\\n> `config.MapOnExists` \u4e0e `BindStruct` \u4e00\u6837\uff0c\u4f46\u4ec5\u5f53 key \u5b58\u5728\u65f6\u624d\u8fdb\u884c\u6620\u5c04\u7ed1\u5b9a\\n\\n### \u5feb\u901f\u83b7\u53d6\u6570\u636e\\n\\n```go\\n// \u83b7\u53d6\u6574\u578b\\nage := config.Int(\\"age\\")\\nfmt.Print(age) // 100\\n\\n// \u83b7\u53d6\u5e03\u5c14\u503c\\nval := config.Bool(\\"debug\\")\\nfmt.Print(val) // true\\n\\n// \u83b7\u53d6\u5b57\u7b26\u4e32\\nname := config.String(\\"name\\")\\nfmt.Print(name) // inhere\\n\\n// \u83b7\u53d6\u5b57\u7b26\u4e32\u6570\u7ec4\\narr1 := config.Strings(\\"arr1\\")\\nfmt.Printf(\\"%v %#v\\", arr1) // []string{\\"val1\\", \\"val21\\"}\\n\\n// \u83b7\u53d6\u5b57\u7b26\u4e32KV\u6620\u5c04\\nval := config.StringMap(\\"map1\\")\\nfmt.Printf(\\"%v %#v\\",val) // map[string]string{\\"key\\":\\"val2\\", \\"key2\\":\\"val20\\"}\\n\\n// \u503c\u5305\u542bENV\u53d8\u91cf\\nvalue := config.String(\\"shell\\")\\nfmt.Print(value) // /bin/zsh\\n\\n// \u901a\u8fc7key\u8def\u5f84\u83b7\u53d6\u503c\\n// from array\\nvalue := config.String(\\"arr1.0\\")\\nfmt.Print(value) // \\"val1\\"\\n\\n// from map\\nvalue := config.String(\\"map1.key\\")\\nfmt.Print(value) // \\"val2\\"\\n```\\n\\n### \u8bbe\u7f6e\u65b0\u7684\u503c\\n\\n```go\\n// set value\\nconfig.Set(\\"name\\", \\"new name\\")\\n// get\\nname = config.String(\\"name\\")\\nfmt.Print(name) // new name\\n```\\n\\n## \u4eceENV\u8f7d\u5165\u6570\u636e\\n\\n```go\\n// os env: APP_NAME=config APP_DEBUG=true\\n// load ENV info\\nconfig.LoadOSEnvs(map[string]string{\\"APP_NAME\\": \\"app_name\\", \\"APP_DEBUG\\": \\"app_debug\\"})\\n\\n// read\\nconfig.Bool(\\"app_debug\\") // true\\nconfig.String(\\"app_name\\") // \\"config\\"\\n```\\n\\n## \u4ece\u547d\u4ee4\u884c\u53c2\u6570\u8f7d\u5165\u6570\u636e\\n\\n\u652f\u6301\u7b80\u5355\u7684\u4ece\u547d\u4ee4\u884c `flag` \u53c2\u6570\u89e3\u6790\uff0c\u52a0\u8f7d\u6570\u636e\\n\\n```go\\n// flags like: --name inhere --env dev --age 99 --debug\\n\\n// load flag info\\nkeys := []string{\\"name\\", \\"env\\", \\"age:int\\" \\"debug:bool\\"}\\nerr := config.LoadFlags(keys)\\n\\n// read\\nconfig.String(\\"name\\") // \\"inhere\\"\\nconfig.String(\\"env\\") // \\"dev\\"\\nconfig.Int(\\"age\\") // 99\\nconfig.Bool(\\"debug\\") // true\\n```\\n\\n## \u66f4\u591a\\n\\n\u66f4\u591a\u4f7f\u7528\u8bf4\u660e\u8bf7\u770b [README](https://github.com/gookit/config/blob/master/README.zh-CN.md)"},{"id":"install-tools-by-scoop-on-windows","metadata":{"permalink":"/blog/install-tools-by-scoop-on-windows","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2022/07-10-install-tools-by-scoop-on-windows.md","source":"@site/blog/2022/07-10-install-tools-by-scoop-on-windows.md","title":"\u901a\u8fc7 scoop \u5728Windows \u4e0b\u5b89\u88c5\u5de5\u5177","description":"scoop \u662f\u4e00\u4e2aWindows \u4e0b\u7684\u5e94\u7528\u5305\u5b89\u88c5\u7ba1\u7406\u5de5\u5177\uff0c\u7c7b\u4f3c\u4e8e Linux \u4e0b\u7684 yum,apt \u548cMacOs \u4e0b\u7684 brew\u3002","date":"2022-07-10T14:38:00.000Z","formattedDate":"2022\u5e747\u670810\u65e5","tags":[{"label":"tool","permalink":"/blog/tags/tool"},{"label":"windows","permalink":"/blog/tags/windows"},{"label":"scoop","permalink":"/blog/tags/scoop"}],"readingTime":1.6,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u901a\u8fc7 scoop \u5728Windows \u4e0b\u5b89\u88c5\u5de5\u5177","tags":["tool","windows","scoop"],"date":"2022-07-10T14:38","slug":"install-tools-by-scoop-on-windows","authors":"inhere"},"prevItem":{"title":"gookit/config - Go\u8bed\u8a00\u8bfb\u53d6\u591a\u79cd\u683c\u5f0f\u914d\u7f6e\u6587\u4ef6","permalink":"/blog/gookit-config-intro"},"nextItem":{"title":"\u5b89\u88c5\u5e76\u914d\u7f6e docusaurus v2\u7ad9\u70b9","permalink":"/blog/install-and-config-docusaurus-v2.md"}},"content":"`scoop` \u662f\u4e00\u4e2aWindows \u4e0b\u7684\u5e94\u7528\u5305\u5b89\u88c5\u7ba1\u7406\u5de5\u5177\uff0c\u7c7b\u4f3c\u4e8e Linux \u4e0b\u7684 `yum,apt` \u548cMacOs \u4e0b\u7684 `brew`\u3002\\n\\n\u901a\u8fc7\u4f7f\u7528 scoop \u53ef\u4ee5\u65b9\u4fbf\u5feb\u901f\u7684\u5b89\u88c5\u5e38\u7528\u7684\u5f00\u53d1\u5de5\u5177\uff0c\u4f1a\u81ea\u52a8\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u4f8b\u5982 php, go, rust \u7b49\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n> Scoop github: https://github.com/ScoopInstaller/Scoop \\n\\n## \u5b89\u88c5Scoop\\n\\n```bash powershell\\niwr -useb get.scoop.sh | iex\\n```\\n\\n\u6dfb\u52a0bucket \u652f\u6301\u66f4\u591a\u5de5\u5177:\\n\\n```bash\\nscoop bucket add extras\\n```\\n\\n## \u57fa\u672c\u4f7f\u7528\\n\\n\u67e5\u770b\u53ef\u7528\u547d\u4ee4\uff1a\\n\\n```bash\\nscoop \\n```\\n\\n### \u641c\u7d22\u5de5\u5177\\n\\n```bash\\nscoop search git\\nscoop search php\\nscoop search go\\n```\\n\\n\u8f93\u51fa\u7c7b\u4f3c\uff1a\\n\\n```text\\ninhere@Inhere-win10 MINGW64 /f/work\\n$ scoop search php\\nResults from local buckets...\\n\\nName           Version              Source Binaries\\n----           -------              ------ --------\\nappengine-go   1.9.70               extras php_cli.ps1\\neclipse-php    2022-06              extras\\nphp-nts-xdebug 3.1.5-8.1            extras\\nphp-xdebug     3.1.5-8.1            extras\\nphpstorm       2022.1.3-221.5921.28 extras\\nxampp          8.1.6-0              extras php.exe\\nphp-nts        8.1.8                main\\nphp            8.1.8                main\\n```\\n\\n### \u5b89\u88c5\u5de5\u5177\\n\\n```bash\\nscoop install git\\n```\\n\\n### \u5378\u8f7d\u8f6f\u4ef6\\n\\n```bash\\nscoop uninstall git\\n```\\n\\n### \u66f4\u65b0scoop\u53ca\u8f6f\u4ef6\\n\\n```bash\\nscoop update #\u66f4\u65b0 scoop \u81ea\u5df1\\nscoop update git #\u66f4\u65b0 git\\n```\\n\\n### \u5b89\u88c5aria2\u52a0\u901f\u4e0b\u8f7d\\n\\nscoop\u5b89\u88c5aria2\u540e\uff0cscoop\u4f1a\u81ea\u52a8\u8c03\u7528aria2\u8fdb\u884c\u591a\u7ebf\u7a0b\u4e0b\u8f7d\u4ee5\u52a0\u901f\u4e0b\u8f7d\uff1a\\n\\n```bash\\nscoop install aria2\\n# \u5173\u95ed\u6bcf\u6b21\u8fd0\u884c\u65f6\u7684\u544a\u8b66\u63d0\u793a\\nscoop config aria2-warning-enabled false\\n```\\n\\n## \u5b89\u88c5\u5e38\u7528\u5de5\u5177\\n\\n### \u57fa\u7840\u5de5\u5177\\n\\n```bash\\nscoop search git\\n```\\n\\n### \u8bed\u8a00\u73af\u5883\\n\\n```bash\\nscoop search php\\nscoop search go\\nscoop search nodejs\\n```\\n\\n### \u5176\u4ed6\u5de5\u5177\\n\\n```bash\\nscoop install composer\\nscoop install yarn\\n```"},{"id":"install-and-config-docusaurus-v2.md","metadata":{"permalink":"/blog/install-and-config-docusaurus-v2.md","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2022/07-09-install-and-config-docusaurus-v2.md","source":"@site/blog/2022/07-09-install-and-config-docusaurus-v2.md","title":"\u5b89\u88c5\u5e76\u914d\u7f6e docusaurus v2\u7ad9\u70b9","description":"\u7b80\u5355\u8bb0\u5f55\u4e00\u4e0b\u5982\u4f55\u5b89\u88c5\u548c\u4f7f\u7528 Docusaurus \u6765\u6784\u5efa\u81ea\u5df1\u7684\u535a\u5ba2\u548c\u6587\u6863\u7ad9\u70b9\u3002","date":"2022-07-09T17:13:00.000Z","formattedDate":"2022\u5e747\u67089\u65e5","tags":[{"label":"docusaurus","permalink":"/blog/tags/docusaurus"}],"readingTime":3.985,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u5b89\u88c5\u5e76\u914d\u7f6e docusaurus v2\u7ad9\u70b9","tags":["docusaurus"],"date":"2022-07-09T17:13","slug":"install-and-config-docusaurus-v2.md","authors":"inhere"},"prevItem":{"title":"\u901a\u8fc7 scoop \u5728Windows \u4e0b\u5b89\u88c5\u5de5\u5177","permalink":"/blog/install-tools-by-scoop-on-windows"},"nextItem":{"title":"cflag - \u5305\u88c5Go FlagSet\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f","permalink":"/blog/gookit-goutil-cflag-intro"}},"content":"\u7b80\u5355\u8bb0\u5f55\u4e00\u4e0b\u5982\u4f55\u5b89\u88c5\u548c\u4f7f\u7528 Docusaurus \u6765\u6784\u5efa\u81ea\u5df1\u7684\u535a\u5ba2\u548c\u6587\u6863\u7ad9\u70b9\u3002\\n\\n> Docusaurus \u7684\u5b98\u65b9\u6587\u6863 https://docusaurus.io/zh-CN/docs\\n\\n\x3c!--truncate--\x3e\\n\\n## \u751f\u6210\u65b0\u7ad9\u70b9\\n\\n\u4f7f\u7528 `classic` \u6a21\u677f\u751f\u6210\u4e00\u4e2a\u65b0\u7684 Docusaurus \u7ad9\u70b9 `my-website`\u3002\\n\\n\u8fd0\u884c\u547d\u4ee4\u540e\uff0c\u7ecf\u5178\u6a21\u677f\u5c06\u81ea\u52a8\u6dfb\u52a0\u5230\u60a8\u7684\u9879\u76ee\u4e2d\\n\\n```bash npm2yarn\\nnpm init docusaurus@latest my-website classic\\n```\\n\\n\u8fdb\u5165\u751f\u6210\u7684\u7ad9\u70b9\u76ee\u5f55\\n\\n```bash\\ncd my-website\\n```\\n\\n\u542f\u52a8\u5e76\u8fd0\u884c\u5f00\u53d1\u670d\u52a1\u5668:\\n\\n```bash npm2yarn\\nnpm run start\\n```\\n\\n\u6253\u5f00\u9875\u9762 `docs/intro.md` \u5e76\u7f16\u8f91\u4e00\u4e9b\u884c,\u53ef\u4ee5\u770b\u5230\u8be5\u7ad9\u70b9\u4f1a\u81ea\u52a8\u91cd\u65b0\u52a0\u8f7d\u5e76\u663e\u793a\u6700\u65b0\u7684\u66f4\u6539\u3002\\n\\n## \u914d\u7f6e\u7ad9\u70b9\\n\\n\\n\u57fa\u7840\u914d\u7f6e\\n\\n```js title=\\"docusaurus.config.js\\"\\nconst config = {\\n  title: \\"Inhere\'s Site\\",\\n  tagline: \\"Inhere\'s site, blogs and project docs\\",\\n  url: \'https://inhere.github.io\',\\n  baseUrl: \'/\',\\n  trailingSlash: false,\\n\\n  organizationName: \'inhere\', // Usually your GitHub org/user name.\\n  projectName: \'inhere.github.io\', // Usually your repo name.\\n  deploymentBranch: \'gh-pages\',\\n\\n  // ...\\n}\\n```\\n\\n\u6587\u6863\u548c\u535a\u5ba2\u914d\u7f6e\uff1a\\n\\n```js title=\\"docusaurus.config.js\\"\\n  presets: [\\n    [\\n      \'classic\',\\n      /** @type {import(\'@docusaurus/preset-classic\').Options} */\\n      ({\\n        docs: {\\n          sidebarPath: require.resolve(\'./sidebars.js\'),\\n          // Please change this to your repo.\\n          // Remove this to remove the \\"edit this page\\" links.\\n          editUrl: \'https://github.com/inhere/inhere.github.io/tree/main/\',\\n        },\\n        blog: {\\n          showReadingTime: true,\\n          postsPerPage: 6,\\n          // routeBasePath: \'/\', // \u628a\u535a\u5ba2\u653e\u5728\u7ad9\u70b9\u6839\u90e8\\n          blogSidebarCount: 6, // \u9ed8\u8ba4 5\\n          // Remove this to remove the \\"edit this page\\" links.\\n          editUrl: \'https://github.com/inhere/inhere.github.io/tree/main/\',\\n        },\\n      }),\\n    ],\\n  ],\\n```\\n\\n:::info\\n\\n\u5b8c\u6574\u914d\u7f6e\u8bf7\u770b https://github.com/inhere/inhere.github.io/blob/main/docusaurus.config.js\\n\\n:::\\n\\n\\n### \u914d\u7f6e\u591a\u8bed\u8a00\\n\\n```js title=\\"docusaurus.config.js\\"\\ni18n: {\\n    defaultLocale: \'zh-CN\',\\n    locales: [ \\"zh-CN\\", \'en\'],\\n    localeConfigs: {\\n      en: {\\n        htmlLang: \'en-GB\',\\n      },\\n    },\\n  },\\n```\\n\\n\\n\u8fd9\u91cc\u6211\u662f\u4ee5 `zh-CN` \u4e3a\u4e3b\uff0c\u751f\u6210 `en` \u7ffb\u8bd1\u6587\u6863\\n\\n```bash\\nnpm run write-translations -- --locale en\\n```\\n\\n\\n\\n## GitHab Pages\\n\\n\u53c2\u8003\u5b98\u65b9\u6587\u6863\u6dfb\u52a0 GitHab Actions \u5982\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u6837\u5728\u6bcf\u6b21\u63a8\u9001\u5230\u4ed3\u5e93\u65f6\u5c31\u4f1a\u89e6\u53d1\u81ea\u52a8\u6784\u5efa\uff0c\\n\u5e76\u4e14\u4f1a\u81ea\u52a8\u90e8\u7f72\u6784\u5efa\u7684\u9759\u6001\u6587\u4ef6\u5230 `gh-pages` \u5206\u652f\u3002\\n\\n```text\\n.github/workflows/deploy.yml\\n.github/workflows/test-deploy.yml\\n```\\n\\n## \u6dfb\u52a0\u5e38\u7528\u63d2\u4ef6\\n\\n\\n### npm2yarn\\n\\n\u53ef\u4ee5\u540c\u65f6\u663e\u793a npm \u548c Yarn \u7684 CLI \u547d\u4ee4\u3002\\n\u7136\u540e\u8981\u4f7f\u7528\u5b83\uff0c\u53ea\u9700\u5728\u4ee3\u7801\u5757\u4e2d\u6dfb\u52a0 `npm2yarn` \u952e\uff1a\\n\\n\\n```bash npm2yarn\\nnpm install @docusaurus/remark-plugin-npm2yarn\\n```\\n\\n\u914d\u7f6e\u63d2\u4ef6\uff1a\\n\\n```js title=\\"docusaurus.config.js\\"\\nmodule.exports = {\\n  // ...\\n  presets: [\\n    [\\n      \'@docusaurus/preset-classic\',\\n      {\\n        docs: {\\n          // highlight-start\\n          remarkPlugins: [\\n            [require(\'@docusaurus/remark-plugin-npm2yarn\'), {sync: true}],\\n          ],\\n          // highlight-end\\n        },\\n        pages: {\\n          // highlight-next-line\\n          remarkPlugins: [require(\'@docusaurus/remark-plugin-npm2yarn\')],\\n        },\\n        blog: {\\n          // ...\\n        },\\n      },\\n    ],\\n  ],\\n};\\n```\\n\\n### docusaurus-search-local\\n\\n\\n\u7528\u4e8e Docusaurus v2 \u7684\u652f\u6301\u79bb\u7ebf\u672c\u5730\u641c\u7d22\u7684\u63d2\u4ef6\\n\\n> \u63d2\u4ef6\u4ed3\u5e93 https://github.com/easyops-cn/docusaurus-search-local\\n\\n\u5b89\u88c5\u63d2\u4ef6\uff1a\\n\\n```bash npm2yarn\\nnpm install --save @easyops-cn/docusaurus-search-local\\n```\\n\\n\u914d\u7f6e\u63d2\u4ef6\uff1a\\n\\n```js title=\\"docusaurus.config.js\\"\\nmodule.exports = {\\n  // ... Your other configurations.\\n  themes: [\\n    // ... Your other themes.\\n    [\\n      // highlight-start\\n      require.resolve(\\"@easyops-cn/docusaurus-search-local\\"),\\n      {\\n        // ... Your options.\\n        // `hashed` is recommended as long-term-cache of index file is possible.\\n        hashed: true,\\n        // For Docs using Chinese, The is recommended to set to:\\n        language: [\\"en\\", \\"zh\\"],\\n      },\\n      // highlight-end\\n    ],\\n  ],\\n};\\n```\\n\\n\u7c7b\u4f3c\u63d2\u4ef6\uff1a\\n\\n- https://github.com/praveenn77/docusaurus-lunr-search\\n- https://github.com/cmfcmf/docusaurus-search-local\\n\\n\\n### openapi-docs\\n\\n> GitHub https://github.com/PaloAltoNetworks/docusaurus-openapi-docs\\n\\nInstallation\\n\\nPlugin:\\n\\n```bash\\nyarn add docusaurus-plugin-openapi-docs\\n```\\n\\nTheme:\\n\\n```bash\\nyarn add docusaurus-theme-openapi-docs\\n```\\n\\n## \u4e00\u4e9b\u4f7f\u7528\u8bf4\u660e\\n\\n\u4e00\u4e9b\u6709\u7528\u7684\u4f7f\u7528\u8bf4\u660e\\n\\n### \u5f3a\u8c03\u63d0\u793a\\n\\n```markdown\\n:::note\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n\\n:::tip\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n\\n:::info\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n\\n:::caution\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n\\n:::danger\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n```\\n\\n\u6548\u679c\u5982\u4e0b\uff1a\\n\\n\\n:::info\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n\\n:::caution\\n\\n\u4e00\u4e9b\u5305\u542b _Markdown_ `\u8bed\u6cd5` \u7684 **\u5185\u5bb9**\u3002\\n\\n:::\\n\\n\\n### \u4ee3\u7801\u884c\u9ad8\u4eae\\n\\n\u4f60\u53ef\u4ee5\u7528 `highlight-next-line`\u3001`highlight-start`\u3001`highlight-end` \u7b49\u6ce8\u91ca\u6765\u9009\u62e9\u8981\u9ad8\u4eae\u7684\u884c\u3002\\n\\n\u6548\u679c\u5982\u4e0b\uff1a\\n\\n```js\\nfunction HighlightSomeText(highlight) {\\n  if (highlight) {\\n    // highlight-next-line\\n    return \'\u8fd9\u884c\u88ab\u9ad8\u4eae\u4e86\uff01\';\\n  }\\n\\n  return \'\u8fd9\u91cc\u4e0d\u4f1a\';\\n}\\n\\nfunction HighlightMoreText(highlight) {\\n  // highlight-start\\n  if (highlight) {\\n    return \'\u8fd9\u5757\u88ab\u9ad8\u4eae\u4e86\uff01\';\\n  }\\n  // highlight-end\\n\\n  return \'\u8fd9\u91cc\u4e0d\u4f1a\';\\n}\\n```\\n\\n> \u539f\u6587\u6863 https://docusaurus.io/zh-CN/docs/markdown-features/code-blocks#line-highlighting"},{"id":"gookit-goutil-cflag-intro","metadata":{"permalink":"/blog/gookit-goutil-cflag-intro","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2022/07-09-gookit-goutil-cflag-usage.md","source":"@site/blog/2022/07-09-gookit-goutil-cflag-usage.md","title":"cflag - \u5305\u88c5Go FlagSet\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f","description":"cflag - \u5305\u88c5\u548c\u6269\u5c55 Go flag.FlagSet \u4ee5\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f\u3002","date":"2022-07-09T16:00:00.000Z","formattedDate":"2022\u5e747\u67089\u65e5","tags":[{"label":"golang","permalink":"/blog/tags/golang"},{"label":"gookit","permalink":"/blog/tags/gookit"},{"label":"flag","permalink":"/blog/tags/flag"},{"label":"cli","permalink":"/blog/tags/cli"},{"label":"console","permalink":"/blog/tags/console"},{"label":"command-line","permalink":"/blog/tags/command-line"}],"readingTime":4.175,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"cflag - \u5305\u88c5Go FlagSet\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f","tags":["golang","gookit","flag","cli","console","command-line"],"date":"2022-07-09T16:00","slug":"gookit-goutil-cflag-intro","authors":"inhere","image":"https://raw.githubusercontent.com/gookit/goutil/master/cflag/_example/cmd-help.png"},"prevItem":{"title":"\u5b89\u88c5\u5e76\u914d\u7f6e docusaurus v2\u7ad9\u70b9","permalink":"/blog/install-and-config-docusaurus-v2.md"},"nextItem":{"title":"gitw - Git \u547d\u4ee4\u5305\u88c5\u5668\uff0c\u751f\u6210 git \u53d8\u66f4\u8bb0\u5f55\u65e5\u5fd7","permalink":"/blog/gookit-gitw-intro"}},"content":"`cflag` - \u5305\u88c5\u548c\u6269\u5c55 Go `flag.FlagSet` \u4ee5\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f\u3002\\n\\n![cmd-help](https://raw.githubusercontent.com/gookit/goutil/master/cflag/_example/cmd-help.png)\\n\\n\x3c!--truncate--\x3e\\n\\n## \u4f7f\u7528 flag \u5305\\n\\nGo `flag` \u662fGo\u5185\u7f6e\u7684\u5305\uff0c\u4f7f\u7528  `flag` \u5305\u6784\u5efa\u4e00\u4e2a\u547d\u4ee4\u5e94\u7528\u975e\u5e38\u7b80\u5355\u3002\\n\\n```go title=\\"cflag/_example/rawflag.go\\"\\npackage main\\n\\nimport (\\n    \\"flag\\"\\n    \\"os\\"\\n\\n    \\"github.com/gookit/goutil/cliutil\\"\\n    \\"github.com/gookit/goutil/dump\\"\\n)\\n\\nvar opts1 = struct {\\n    age  int\\n    name string\\n    str1 string\\n    lOpt string\\n}{}\\n\\n// go run ./_example/rawflag.go\\n// go run ./cflag/_example/rawflag.go -h\\nfunc main() {\\n    c := flag.NewFlagSet(\\"mycmd\\", flag.ContinueOnError)\\n\\n    c.IntVar(&opts1.age, \\"age\\", 0, \\"this is a int option\\")\\n    c.StringVar(&opts1.name, \\"name\\", \\"\\", \\"this is a string option and required\\")\\n    c.StringVar(&opts1.str1, \\"str1\\", \\"def-val\\", \\"this is a string option with default value\\")\\n    c.StringVar(&opts1.lOpt, \\"long-opt\\", \\"\\", \\"this is a string option with shorts\\")\\n\\n    err := c.Parse(os.Args[1:])\\n    if err != nil {\\n        if err != flag.ErrHelp {\\n            cliutil.Errorln(\\"Error:\\", err.Error())\\n        }\\n        return\\n    }\\n\\n    // after parse, do something\\n    handleFunc1()\\n}\\n\\nfunc handleFunc1() {\\n    cliutil.Infoln(\\"after parse, do something\\")\\n\\n    dump.P(opts1)\\n}\\n```\\n\\n### \u663e\u793a\u5e2e\u52a9\\n\\n```bash\\ngo run ./cflag/_example/rawflag.go -h\\n```\\n\\n![rawflag-help](https://raw.githubusercontent.com/gookit/goutil/master/cflag/_example/rawflag-help.png)\\n\\n### \u4e0d\u8db3\u7684\u70b9\\n\\n\u5b83\u662fGo\u5185\u7f6e\u7684\u5305\uff0c\u4f7f\u7528\u4e5f\u975e\u5e38\u7b80\u5355\u3002\u4f46\u662f\u6709\u4e00\u4e9b\u4e0d\u8db3\u7684\u70b9\uff1a\\n\\n- \u4e0d\u652f\u6301\u7ed9\u9009\u9879\u6dfb\u52a0\u77ed\u9009\u9879\\n- \u4e0d\u652f\u6301\u89e3\u6790\u540e\u7eed\u53c2\u6570\u4fe1\u606f\\n- \u4e0d\u80fd\u68c0\u67e5\u9009\u9879\u662f\u5426\u4e3a\u7a7a\\n- \u6e32\u67d3\u7684\u5e2e\u52a9\u4fe1\u606f\u975e\u5e38\u7b80\u964b\\n\\n## \u4f7f\u7528 cflag \u5305\\n\\n`cflag` - \u5305\u88c5\u548c\u6269\u5c55 Go `flag.FlagSet` \u4ee5\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f\\n\\n- \u4f7f\u7528\u8ddf Go `flag` \u4e00\u6837\u7b80\u5355\\n- \u652f\u6301\u81ea\u52a8\u6e32\u67d3\u6f02\u4eae\u7684\u5e2e\u52a9\u4fe1\u606f\\n- \u5141\u8bb8\u4e3a\u6807\u5fd7\u9009\u9879\u6dfb\u52a0\u77ed\u9009\u9879,\u5e76\u4e14\u5141\u8bb8\u591a\u4e2a\\n- \u5141\u8bb8\u7ed1\u5b9a\u547d\u540d\u53c2\u6570\\n- \u5141\u8bb8\u8bbe\u7f6e\u53c2\u6570\u6216\u9009\u9879\u4e3a\u5fc5\u987b\\n- \u5141\u8bb8\u8bbe\u7f6e\u53c2\u6570\u6216\u9009\u9879\u7684\u9a8c\u8bc1\u5668\\n\\n### \u5b89\u88c5\\n\\n```shell\\ngo get github.com/gookit/goutil/cflag\\n```\\n\\n### \u4f7f\u7528\u793a\u4f8b\\n\\n\u8ddf Go `flag` \u4e00\u6837\u7684\u7ed1\u5b9a\u9009\u9879\u4fe1\u606f\u3002\u540c\u65f6\u989d\u5916\u65b0\u589e\u4e86\u4e00\u4e9b\u4fe1\u606f\uff0c\u6bd4\u5982 \u7248\u672c\uff0c\u63cf\u8ff0\u7b49\\n\\n```go title=\\"cflag/_example/cmd.go\\"\\npackage main\\n\\nimport (\\n\\t\\"os\\"\\n\\n\\t\\"github.com/gookit/goutil/cflag\\"\\n\\t\\"github.com/gookit/goutil/cliutil\\"\\n)\\n\\nvar opts = struct {\\n\\tage  int\\n\\tname string\\n\\tstr1 string\\n\\tlOpt string\\n\\tbol  bool\\n}{}\\n\\n// go run ./_example/cmd.go\\n// go run ./cflag/_example/cmd.go -h\\n// go run ./cflag/_example/cmd.go --name inhere -a 12 --lo val ab cd\\nfunc main() {\\n\\tc := cflag.New(func(c *cflag.CFlags) {\\n\\t\\tc.Desc = \\"this is a demo command\\"\\n\\t\\tc.Version = \\"0.5.1\\"\\n\\t})\\n\\tc.IntVar(&opts.age, \\"age\\", 0, \\"this is a int option;;a\\")\\n\\tc.StringVar(&opts.name, \\"name\\", \\"\\", \\"this is a string option and required;true\\")\\n\\tc.StringVar(&opts.str1, \\"str1\\", \\"def-val\\", \\"this is a string option with default value;;s\\")\\n\\tc.StringVar(&opts.lOpt, \\"long-opt\\", \\"\\", \\"this is a string option with shorts;;lo\\")\\n\\n    // highlight-start\\n\\tc.AddArg(\\"arg1\\", \\"this is arg1\\", true, nil)\\n\\tc.AddArg(\\"arg2\\", \\"this is arg2\\", true, nil)\\n    // highlight-end\\n\\n\\t// add handle func\\n\\tc.Func = handleFunc\\n\\n\\tc.MustParse(os.Args[1:])\\n}\\n\\nfunc handleFunc(c *cflag.CFlags) error {\\n\\tcliutil.Magentaln(\\"hello, this is command:\\", c.Name())\\n\\tcliutil.Infoln(\\"after parse, do something ...\\")\\n\\n\\tcliutil.Yellowln(\\"option values:\\")\\n\\tcliutil.Infoln(\\"opts.age =\\", opts.age)\\n\\tcliutil.Infoln(\\"opts.name =\\", opts.name)\\n\\tcliutil.Infoln(\\"opts.str1 =\\", opts.str1)\\n\\tcliutil.Infoln(\\"opts.lOpt =\\", opts.lOpt)\\n\\n    // highlight-start\\n\\tcliutil.Yellowln(\\"argument values:\\")\\n\\tcliutil.Infoln(\\"arg1 =\\", c.Arg(\\"arg1\\").String())\\n\\tcliutil.Infoln(\\"arg2 =\\", c.Arg(\\"arg2\\").String())\\n    // highlight-end\\n\\n\\tcliutil.Infoln(\\"\\\\nremain args =\\", c.RemainArgs())\\n\\n\\treturn nil\\n}\\n```\\n\\n### \u8bbe\u7f6e\u5fc5\u987b\u548c\u77ed\u9009\u9879\\n\\n\u53ef\u4ee5\u8bbe\u7f6e\u9009\u9879\u4e3a `required` \u5fc5\u586b\u9879\uff0c\u5e76\u4e14\u652f\u6301\u8bbe\u7f6e **\u77ed\u9009\u9879** \u540d\u79f0\u3002\\n\\n> TIPs: \u901a\u8fc7\u6269\u5c55\u89e3\u6790\u4e86\u9009\u9879\u7684 `usage` \u6765\u5b9e\u73b0 `required` \u548c `shorts`\\n\\n#### `usage` \u683c\u5f0f\\n\\n- \u9ed8\u8ba4\uff1a`desc`\\n- \u683c\u5f0f1: `desc;required`\\n- \u683c\u5f0f2: `desc;required;shorts`\\n- `required`: \u4e00\u4e2a\u5e03\u5c14\u5b57\u7b26\u4e32\u3002\u6807\u8bb0\u9009\u9879\u662f\u5fc5\u9700\u7684\\n  - True: `true,on,yes`\\n  - False: `false,off,no,\'\'`\\n- `shorts`: \u9009\u9879\u7684\u5feb\u6377\u65b9\u5f0f\u540d\u79f0\uff0c\u5141\u8bb8\u591a\u503c\uff0c\u7528\u9017\u53f7 `,` \u5206\u9694\\n\\n**\u793a\u4f8b**:\\n\\n```go\\n    // set option \'name\' is required\\n\\tc.StringVar(&opts.name, \\"name\\", \\"\\", \\"this is a string option and required;true\\")\\n    // set option \'str1\' shorts: s\\n\\tc.StringVar(&opts.str1, \\"str1\\", \\"def-val\\", \\"this is a string option with default value;;s\\")\\n```\\n\\n### \u7ed1\u5b9a\u548c\u83b7\u53d6\u53c2\u6570\\n\\n**\u7ed1\u5b9a\u53c2\u6570\u4fe1\u606f**\\n\\n```go\\n\\tc.AddArg(\\"arg1\\", \\"this is arg1\\", true, nil)\\n\\tc.AddArg(\\"arg2\\", \\"this is arg2\\", true, nil)\\n```\\n\\n**\u83b7\u53d6\u53c2\u6570\u4fe1\u606f**\\n\\n```go\\n\\tcliutil.Infoln(\\"arg1 =\\", c.Arg(\\"arg1\\").String())\\n\\tcliutil.Infoln(\\"arg2 =\\", c.Arg(\\"arg2\\").Int())\\n```\\n\\n### \u663e\u793a\u5e2e\u52a9\u4fe1\u606f\\n\\n```shell\\ngo run ./cflag/_example/cmd.go -h\\n```\\n\\n**Output**:\\n\\n![cmd-help](https://raw.githubusercontent.com/gookit/goutil/master/cflag/_example/cmd-help.png)\\n\\n### \u8fd0\u884c\u547d\u4ee4\\n\\n```shell\\ngo run ./cflag/_example/cmd.go --name inhere -a 12 --lo val ab cd\\ngo run ./cflag/_example/cmd.go --name inhere -a 12 --lo val ab cd de fg\\n```\\n\\n**Output**:\\n\\n![cmd-run](https://raw.githubusercontent.com/gookit/goutil/master/cflag/_example/cmd-run.png)\\n\\n### `required` \u68c0\u67e5\\n\\n```shell\\ngo run ./cflag/_example/cmd.go -a 22\\ngo run ./cflag/_example/cmd.go --name inhere\\n```\\n\\n**Output**:\\n\\n![cmd-required.png](https://raw.githubusercontent.com/gookit/goutil/master/cflag/_example/cmd-required.png)\\n\\n## GitHub\\n\\n- [gookit/goutil/cflag](https://github.com/gookit/goutil/tree/master/cflag)"},{"id":"gookit-gitw-intro","metadata":{"permalink":"/blog/gookit-gitw-intro","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2022/07-06-gookit-gitw-intro.md","source":"@site/blog/2022/07-06-gookit-gitw-intro.md","title":"gitw - Git \u547d\u4ee4\u5305\u88c5\u5668\uff0c\u751f\u6210 git \u53d8\u66f4\u8bb0\u5f55\u65e5\u5fd7","description":"gitw - Git \u547d\u4ee4\u5305\u88c5\u5668\uff0c\u751f\u6210 git \u53d8\u66f4\u8bb0\u5f55\u65e5\u5fd7\uff0c\u83b7\u53d6 repo \u4fe1\u606f\u548c\u4e00\u4e9b git \u547d\u4ee4\u5de5\u5177\u3002","date":"2022-07-06T21:00:00.000Z","formattedDate":"2022\u5e747\u67086\u65e5","tags":[{"label":"golang","permalink":"/blog/tags/golang"},{"label":"gookit","permalink":"/blog/tags/gookit"},{"label":"git","permalink":"/blog/tags/git"}],"readingTime":1.095,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"gitw - Git \u547d\u4ee4\u5305\u88c5\u5668\uff0c\u751f\u6210 git \u53d8\u66f4\u8bb0\u5f55\u65e5\u5fd7","tags":["golang","gookit","git"],"date":"2022-07-06T21:00","slug":"gookit-gitw-intro","authors":"inhere"},"prevItem":{"title":"cflag - \u5305\u88c5Go FlagSet\u6784\u5efa\u7b80\u5355\u4e14\u6f02\u4eae\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f","permalink":"/blog/gookit-goutil-cflag-intro"},"nextItem":{"title":"slog - \u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\uff0c\u6613\u6269\u5c55\u3001\u53ef\u914d\u7f6e\u7684\u65e5\u5fd7\u5e93","permalink":"/blog/gookit-slog-intro"}},"content":"`gitw` - Git \u547d\u4ee4\u5305\u88c5\u5668\uff0c\u751f\u6210 git \u53d8\u66f4\u8bb0\u5f55\u65e5\u5fd7\uff0c\u83b7\u53d6 repo \u4fe1\u606f\u548c\u4e00\u4e9b git \u547d\u4ee4\u5de5\u5177\u3002\\n\\n- \u5305\u88c5\u672c\u5730 `git` \u547d\u4ee4\\n- \u5feb\u901f\u8fd0\u884c `git` \u547d\u4ee4\\n- \u5feb\u901f\u67e5\u8be2\u5b58\u50a8\u5e93\u4fe1\u606f\\n  - \u83b7\u53d6 remote, branch \u8be6\u7ec6\u4fe1\u606f\\n- \u901a\u8fc7 `git log` \u5feb\u901f\u751f\u6210\u7248\u672c\u53d8\u66f4\u65e5\u5fd7\\n  - \u5141\u8bb8\u81ea\u5b9a\u4e49\u751f\u6210\u914d\u7f6e\\n  - \u5141\u8bb8\u81ea\u5b9a\u4e49\u751f\u6210\u8fc7\u6ee4\u3001\u6837\u5f0f\u7b49\\n  - \u53ef\u4ee5\u76f4\u63a5\u5728 GitHub Actions \u4e2d\u4f7f\u7528\\n\\n\x3c!--truncate--\x3e\\n\\n> Github https://github.com/gookit/gitw\\n\\n## \u751f\u6210\u53d8\u66f4\u65e5\u5fd7\\n\\n\u53ef\u4ee5\u901a\u8fc7 `gitw/chlog` \u5305\u5feb\u901f\u751f\u6210\u53d8\u66f4\u65e5\u5fd7\u3002\\n\\n\\n### \u5b89\u88c5\\n\\n```shell\\ngo install github.com/gookit/gitw/cmd/chlog@latest\\n```\\n\\n### \u4f7f\u7528\\n\\n**\u751f\u6210\u53d8\u66f4\u65e5\u5fd7:**:\\n\\n```shell\\nchlog prev last\\nchlog last head\\nchlog -c .github/changelog.yml last head\\n```\\n\\n**Outputs**:\\n\\n![chlog-demo](https://raw.githubusercontent.com/gookit/gitw/main/_examples/images/chlog-demo.png)\\n\\n\\n## \u4ed3\u5e93\u4fe1\u606f\\n\\n\u53ef\u4ee5\u901a\u8fc7 gitw \u5728\u672c\u5730\u5feb\u901f\u83b7\u53d6 git \u5b58\u50a8\u5e93\u4fe1\u606f\u3002\\n\\n```go\\nrepo := gitw.NewRepo(\\"/path/to/my-repo\\")\\n```\\n\\n### Branch \u4fe1\u606f\\n\\n```go\\nbrInfo := repo.CurBranchInfo()\\n\\ndump.Println(brInfo)\\n```\\n\\n**Output**:\\n\\n![one-remote-info](https://raw.githubusercontent.com/gookit/gitw/main/_examples/images/one-branch-info.png)\\n\\n## \u66f4\u591a\\n\\n\u66f4\u591a\u4f7f\u7528\u8bf4\u660e\u8bf7\u770bREADME\u548cgodoc\\n\\n> Github https://github.com/gookit/gitw"},{"id":"gookit-slog-intro","metadata":{"permalink":"/blog/gookit-slog-intro","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2022/06-16-gookit-slog-intro.md","source":"@site/blog/2022/06-16-gookit-slog-intro.md","title":"slog - \u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\uff0c\u6613\u6269\u5c55\u3001\u53ef\u914d\u7f6e\u7684\u65e5\u5fd7\u5e93","description":"slog - Go \u5b9e\u73b0\u7684\u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\uff0c\u8f7b\u91cf\u7ea7\u3001\u53ef\u914d\u7f6e\u3001\u53ef\u6269\u5c55\u7684\u65e5\u5fd7\u5e93","date":"2022-06-16T21:00:00.000Z","formattedDate":"2022\u5e746\u670816\u65e5","tags":[{"label":"golang","permalink":"/blog/tags/golang"},{"label":"gookit","permalink":"/blog/tags/gookit"},{"label":"log","permalink":"/blog/tags/log"},{"label":"logger","permalink":"/blog/tags/logger"}],"readingTime":2.685,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"slog - \u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\uff0c\u6613\u6269\u5c55\u3001\u53ef\u914d\u7f6e\u7684\u65e5\u5fd7\u5e93","tags":["golang","gookit","log","logger"],"date":"2022-06-16T21:00","slug":"gookit-slog-intro","authors":"inhere"},"prevItem":{"title":"gitw - Git \u547d\u4ee4\u5305\u88c5\u5668\uff0c\u751f\u6210 git \u53d8\u66f4\u8bb0\u5f55\u65e5\u5fd7","permalink":"/blog/gookit-gitw-intro"},"nextItem":{"title":"pflag - \u66f4\u597d\u7684PHP\u547d\u4ee4\u884c\u9009\u9879\u89e3\u6790\u5e93","permalink":"/blog/pflag-better-php-command-line-parse-library"}},"content":"slog - Go \u5b9e\u73b0\u7684\u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\uff0c\u8f7b\u91cf\u7ea7\u3001\u53ef\u914d\u7f6e\u3001\u53ef\u6269\u5c55\u7684\u65e5\u5fd7\u5e93\\n\\n![image](https://raw.githubusercontent.com/gookit/slog/master/\\\\_example/images/console-log-all-level.png)\\n\\n\x3c!--truncate--\x3e\\n\\n## \u529f\u80fd\u7279\u8272\\n\\n* \u7b80\u5355\uff0c\u65e0\u9700\u914d\u7f6e\uff0c\u5f00\u7bb1\u5373\u7528\\n* \u652f\u6301\u5e38\u7528\u7684\u65e5\u5fd7\u7ea7\u522b\u5904\u7406\\n   * \u5982\uff1a `trace` `debug` `info` `notice` `warn` `error` `fatal` `panic`\\n* \u53ef\u4ee5\u4efb\u610f\u6269\u5c55\u81ea\u5df1\u9700\u8981\u7684 `Handler` `Formatter`\\n* \u652f\u6301\u540c\u65f6\u6dfb\u52a0\u591a\u4e2a `Handler` \u65e5\u5fd7\u5904\u7406\uff0c\u8f93\u51fa\u65e5\u5fd7\u5230\u4e0d\u540c\u7684\u5730\u65b9\\n* \u652f\u6301\u81ea\u5b9a\u4e49\u6784\u5efa `Handler` \u5904\u7406\u5668\\n   * \u5185\u7f6e\u7684 `handler.Config` `handler.Builder`,\u53ef\u4ee5\u65b9\u4fbf\u5feb\u6377\u7684\u6784\u5efa\u60f3\u8981\u7684\u65e5\u5fd7\u5904\u7406\u5668\\n* \u652f\u6301\u81ea\u5b9a\u4e49 `Formatter` \u683c\u5f0f\u5316\u5904\u7406\\n   * \u5185\u7f6e\u4e86 `json` `text` \u4e24\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u683c\u5f0f\u5316 `Formatter`\\n* \u5df2\u7ecf\u5185\u7f6e\u4e86\u5e38\u7528\u7684\u65e5\u5fd7\u5904\u7406\u5668\\n   * `console` \u8f93\u51fa\u65e5\u5fd7\u5230\u63a7\u5236\u53f0\uff0c\u652f\u6301\u8272\u5f69\u8f93\u51fa\\n   * `writer` \u8f93\u51fa\u65e5\u5fd7\u5230\u6307\u5b9a\u7684 `io.Writer`\\n   * `file` \u8f93\u51fa\u65e5\u5fd7\u5230\u6307\u5b9a\u6587\u4ef6\uff0c\u53ef\u9009\u542f\u7528 `buffer` \u7f13\u51b2\u5199\u5165\\n   * `simple` \u8f93\u51fa\u65e5\u5fd7\u5230\u6307\u5b9a\u6587\u4ef6\uff0c\u65e0\u7f13\u51b2\u76f4\u63a5\u5199\u5165\u6587\u4ef6\\n   * `rotate_file` \u8f93\u51fa\u65e5\u5fd7\u5230\u6307\u5b9a\u6587\u4ef6\uff0c\u5e76\u4e14\u540c\u65f6\u652f\u6301\u6309\u65f6\u95f4\u3001\u6309\u5927\u5c0f\u5206\u5272\u6587\u4ef6\uff0c\u9ed8\u8ba4\u542f\u7528 `buffer` \u7f13\u51b2\u5199\u5165\\n   * \u66f4\u591a\u5185\u7f6e\u5b9e\u73b0\u8bf7\u67e5\u770b ./handler \u6587\u4ef6\u5939\\n\\n### \u8f93\u51fa\u65e5\u5fd7\u5230\u6587\u4ef6\\n\\n* \u652f\u6301\u542f\u7528 `buffer` \u7f13\u51b2\u65e5\u5fd7\u5199\u5165\\n* \u652f\u6301\u6309\u65f6\u95f4\u3001\u6309\u5927\u5c0f\u81ea\u52a8\u5206\u5272\u6587\u4ef6\\n* \u652f\u6301\u914d\u7f6e\u901a\u8fc7 `gzip` \u538b\u7f29\u65e5\u5fd7\u6587\u4ef6\\n* \u652f\u6301\u6e05\u7406\u65e7\u65e5\u5fd7\u6587\u4ef6 \u914d\u7f6e: `BackupNum` `BackupTime`\\n\\n## Git \u4ed3\u5e93\\n\\n* Github: https://github.com/gookit/slog\\n* Gitee: https://gitee.com/gookit/slog\\n\\n## \u5b89\u88c5\\n\\n```bash\\ngo get github.com/gookit/slog\\n```\\n\\n## \u5feb\u901f\u5f00\u59cb\\n\\n```go\\npackage main\\n\\nimport (\\n\\t\\"github.com/gookit/slog\\"\\n)\\n\\nfunc main() {\\n\\tslog.Trace(\\"this is a log message\\")\\n\\tslog.Debug(\\"this is a log message\\")\\n\\tslog.Info(\\"this is a log message\\")\\n\\tslog.Notice(\\"this is a log message\\")\\n\\tslog.Warn(\\"this is a log message\\")\\n\\tslog.Error(\\"this is a log message\\")\\n\\tslog.Fatal(\\"this is a log message\\")\\n}\\n```\\n\\n**\u63a7\u5236\u53f0\u65e5\u5fd7\u6548\u679c:**\\n\\n![image](https://raw.githubusercontent.com/gookit/slog/master/\\\\_example/images/console-log-all-level.png)\\n\\n## \u8bb0\u5f55\u5230\u6587\u4ef6\\n\\n\u4f7f\u7528 `slog` \u8f93\u51fa\u65e5\u5fd7\u5230\u6587\u4ef6\u975e\u5e38\u65b9\u4fbf\uff0c\u5e76\u4e14\u652f\u6301\u591a\u6587\u4ef6\uff0c\u6309\u65f6\u95f4\u5206\u5272\u7b49\\n\\n```go\\npackage main\\n\\nimport (\\n\\t\\"github.com/gookit/slog\\"\\n\\t\\"github.com/gookit/slog/handler\\"\\n\\t\\"github.com/gookit/slog/rotatefile\\"\\n)\\n\\nfunc main() {\\n\\tdefer slog.MustFlush()\\n\\n\\t// DangerLevels \u5305\u542b: slog.PanicLevel, slog.ErrorLevel, slog.WarnLevel\\n\\th1 := handler.MustRotateFile(\\"/tmp/logs/app_error.log\\", rotatefile.EveryHour,\\n\\t\\thandler.WithLogLevels(slog.DangerLevels),\\n\\t)\\n\\n\\t// NormalLevels \u5305\u542b: slog.InfoLevel, slog.NoticeLevel, slog.DebugLevel, slog.TraceLevel\\n\\th2 := handler.MustRotateFile(\\"/tmp/logs/app_info.log\\", rotatefile.EveryHour,\\n\\t\\thandler.WithLogLevels(slog.NormalLevels),\\n\\t)\\n\\n\\tslog.PushHandler(h1)\\n\\tslog.PushHandler(h2)\\n\\n\\t// add logs\\n\\tslog.Info(\\"info message text\\")\\n\\tslog.Error(\\"error message text\\")\\n}\\n```\\n\\n\u67e5\u770b\u65e5\u5fd7\u76ee\u5f55:\\n\\n```bash\\n$ ls /tmp/logs\\napp_error.log\\napp_info.log\\n```\\n\\n## \u66f4\u591a\u4f7f\u7528\\n\\n> \u66f4\u591a\u4f7f\u7528\u8bf4\u660e\u8bf7\u770b README https://github.com/gookit/slog/blob/master/README.zh-CN.md"},{"id":"pflag-better-php-command-line-parse-library","metadata":{"permalink":"/blog/pflag-better-php-command-line-parse-library","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2021/10-11-pflag-better-php-command-line-parse-library.md","source":"@site/blog/2021/10-11-pflag-better-php-command-line-parse-library.md","title":"pflag - \u66f4\u597d\u7684PHP\u547d\u4ee4\u884c\u9009\u9879\u89e3\u6790\u5e93","description":"php-toolkit/pflag \u662f\u4e00\u4e2aPHP\u7f16\u5199\u7684\uff0c\u901a\u7528\u7684\u547d\u4ee4\u884c\u6807\u5fd7(\u9009\u9879\u548c\u53c2\u6570)\u89e3\u6790\u5e93\u3002","date":"2021-10-11T15:11:00.000Z","formattedDate":"2021\u5e7410\u670811\u65e5","tags":[{"label":"php","permalink":"/blog/tags/php"},{"label":"cli","permalink":"/blog/tags/cli"},{"label":"command-line","permalink":"/blog/tags/command-line"},{"label":"parser","permalink":"/blog/tags/parser"}],"readingTime":7.755,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"pflag - \u66f4\u597d\u7684PHP\u547d\u4ee4\u884c\u9009\u9879\u89e3\u6790\u5e93","tags":["php","cli","command-line","parser"],"date":"2021-10-11T15:11","slug":"pflag-better-php-command-line-parse-library","authors":"inhere"},"prevItem":{"title":"slog - \u4e00\u4e2a\u6613\u4e8e\u4f7f\u7528\u7684\uff0c\u6613\u6269\u5c55\u3001\u53ef\u914d\u7f6e\u7684\u65e5\u5fd7\u5e93","permalink":"/blog/gookit-slog-intro"},"nextItem":{"title":"\u5b66\u4e60\u7f16\u5199bash\u547d\u4ee4\u81ea\u52a8\u8865\u5168","permalink":"/blog/2021/08/09/learn-bash-completion"}},"content":"`php-toolkit/pflag` \u662f\u4e00\u4e2aPHP\u7f16\u5199\u7684\uff0c\u901a\u7528\u7684\u547d\u4ee4\u884c\u6807\u5fd7(\u9009\u9879\u548c\u53c2\u6570)\u89e3\u6790\u5e93\u3002\\n\\n![flags-demo](https://github.com/php-toolkit/pflag/blob/main/example/images/flags-demo.png?raw=true)\\n\\n> Github \u4ed3\u5e93: [php-toolkit/pflag](https://github.com/php-toolkit/pflag)\\n\\n\x3c!--truncate--\x3e\\n\\n## \u529f\u80fd\u8bf4\u660e\\n\\n- \u901a\u7528\u7684\u547d\u4ee4\u884c\u9009\u9879\u548c\u53c2\u6570\u89e3\u6790\u5668\\n- \u652f\u6301\u8bbe\u7f6e\u503c\u6570\u636e\u7c7b\u578b(`int,string,bool,array`)\uff0c\u5c06\u81ea\u52a8\u683c\u5f0f\u5316\u8f93\u5165\u503c\\n- \u652f\u6301\u4e3a\u9009\u9879/\u53c2\u6570\u8bbe\u7f6e\u9ed8\u8ba4\u503c\\n- \u652f\u6301\u4e3a\u4e00\u4e2a\u9009\u9879\u8bbe\u7f6e\u591a\u4e2a\u77ed\u540d\u79f0\\n- \u652f\u6301\u4ece\u73af\u5883\u53d8\u91cf\u8bfb\u53d6\u6807\u5fd7\u503c\\n- \u652f\u6301\u8bbe\u7f6e\u9009\u9879/\u53c2\u6570\u4e3a\u5fc5\u987b\u7684(`required`)\\n- \u652f\u6301\u8bbe\u7f6e\u9a8c\u8bc1\u5668\u4ee5\u68c0\u67e5\u8f93\u5165\u503c\\n- \u652f\u6301\u81ea\u52a8\u6e32\u67d3\u6f02\u4eae\u7684\u5e2e\u52a9\u4fe1\u606f\u3002\\n\\n**\u547d\u4ee4\u884c\u9009\u9879**:\\n\\n- \u9009\u9879\u4ee5 `-` \u6216\u8005 `--` \u5f00\u5934\u7684\uff0c\u4e14\u9996\u5b57\u7b26\u5fc5\u987b\u662f\u5b57\u6bcd\\n- \u4ee5 `--` \u5f00\u5934\u7684\u4e3a\u957f\u9009\u9879. eg: `--long` `--long value`\\n- \u4ee5 `-` \u5f00\u5934\u7684\u4e3a\u77ed\u9009\u9879 `-s -a value`\\n- \u652f\u6301\u5b9a\u4e49\u6570\u7ec4\u9009\u9879\\n    - eg: `--tag php --tag go` \u5c06\u4f1a\u5f97\u5230 `$tag = [php, go]`\\n\\n**\u547d\u4ee4\u884c\u53c2\u6570**:\\n\\n- \u4e0d\u80fd\u6ee1\u8db3\u9009\u9879\u7684\u90fd\u8ba4\u4f5c\u53c2\u6570\\n- \u652f\u6301\u7ed1\u5b9a\u547d\u540d\u53c2\u6570\\n- \u652f\u6301\u5b9a\u4e49\u6570\u7ec4\u53c2\u6570\\n\\n## \u5b89\u88c5\\n\\n**composer \u5b89\u88c5**\\n\\n```bash\\ncomposer require toolkit/pflag\\n```\\n\\n-----------\\n\\n## Flags \u4f7f\u7528\\n\\nFlags - \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u6807\u5fd7\uff08\u9009\u9879\u548c\u53c2\u6570\uff09\u89e3\u6790\u5668\u548c\u7ba1\u7406\u5668\u3002\\n\\n> \u793a\u4f8b\u4ee3\u7801\u8bf7\u53c2\u89c1 [example/flags-demo.php](https://github.com/php-toolkit/pflag/blob/main/example/flags-demo.php)\\n\\n### \u521b\u5efa\u89e3\u6790\u5668\\n\\n\u521b\u5efa\u548c\u521d\u59cb\u5316\u89e3\u6790\u5668\\n\\n```php\\nuse Toolkit\\\\PFlag\\\\Flags;\\n\\nrequire dirname(__DIR__) . \'/test/bootstrap.php\';\\n\\n$flags = $_SERVER[\'argv\'];\\n// NOTICE: must shift first element.\\n$scriptFile = array_shift($flags);\\n\\n$fs = Flags::new();\\n\\n// \uff08\u53ef\u9009\u7684\uff09\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e9b\u81ea\u5b9a\u4e49\u8bbe\u7f6e\\n$fs->setScriptFile($scriptFile);\\n/** @see Flags::$settings */\\n$fs->setSettings([\\n    \'descNlOnOptLen\' => 26\\n]);\\n\\n// ...\\n```\\n\\n### \u5b9a\u4e49\u9009\u9879\\n\\n\u5b9a\u4e49\u9009\u9879 - \u5b9a\u4e49\u597d\u652f\u6301\u7684\u9009\u9879\u8bbe\u7f6e\uff0c\u89e3\u6790\u65f6\u5c06\u4f1a\u6839\u636e\u5b9a\u4e49\u6765\u89e3\u6790\u8f93\u5165\\n\\n\u6dfb\u52a0\u9009\u9879\u5b9a\u4e49\u7684\u793a\u4f8b:\\n\\n```php\\nuse Toolkit\\\\PFlag\\\\Flag\\\\Option;\\nuse Toolkit\\\\PFlag\\\\FlagType;\\nuse Toolkit\\\\PFlag\\\\Validator\\\\EnumValidator;\\n\\n// add options\\n// - quick add\\n$fs->addOpt(\'age\', \'a\', \'this is a int option\', FlagType::INT);\\n\\n// - \u4f7f\u7528\u5b57\u7b26\u4e32\u89c4\u5219\u5feb\u901f\u6dfb\u52a0\u9009\u9879\u5b9a\u4e49\\n$fs->addOptByRule(\'name,n\', \'string;this is a string option;true\');\\n\\n// -- \u4e00\u6b21\u6dfb\u52a0\u591a\u4e2a\u9009\u9879\\n$fs->addOptsByRules([\\n    \'tag,t\' => \'strings;array option, allow set multi times\',\\n    \'f\'     => \'bool;this is an bool option\',\\n]);\\n\\n// - \u4f7f\u7528\u6570\u7ec4\u5b9a\u4e49\\n/** @see Flags::DEFINE_ITEM for array rule */\\n$fs->addOptByRule(\'name-is-very-lang\', [\\n    \'type\'   => FlagType::STRING,\\n    \'desc\'   => \'option name is to lang, desc will print on newline\',\\n    \'shorts\' => [\'d\',\'e\',\'f\'],\\n    // TIP: add validator limit input value.\\n    \'validator\' => EnumValidator::new([\'one\', \'two\', \'three\']),\\n]);\\n\\n// - \u4f7f\u7528 Option \u5bf9\u8c61\\n$opt = Option::new(\'str1\', \\"this is  string option, \\\\ndesc has multi line, \\\\nhaha...\\");\\n$opt->setDefault(\'defVal\');\\n$fs->addOption($opt);\\n```\\n\\n### \u5b9a\u4e49\u53c2\u6570\\n\\n\u5b9a\u4e49\u53c2\u6570 - \u5b9a\u4e49\u597d\u652f\u6301\u7684\u9009\u9879\u8bbe\u7f6e\uff0c\u89e3\u6790\u65f6\u5c06\u4f1a\u6839\u636e\u5b9a\u4e49\u6765\u89e3\u6790\u8f93\u5165\\n\\n\u6dfb\u52a0\u53c2\u6570\u5b9a\u4e49\u7684\u793a\u4f8b:\\n\\n```php\\nuse Toolkit\\\\PFlag\\\\Flag\\\\Argument;\\nuse Toolkit\\\\PFlag\\\\FlagType;\\n\\n// add arguments\\n// - quick add\\n$fs->addArg(\'strArg1\', \'the is string arg and is required\', \'string\', true);\\n\\n// - \u4f7f\u7528\u5b57\u7b26\u4e32\u89c4\u5219\u5feb\u901f\u6dfb\u52a0\u5b9a\u4e49\\n$fs->addArgByRule(\'intArg2\', \'int;this is a int arg and with default value;no;89\');\\n\\n// - \u4f7f\u7528 Argument \u5bf9\u8c61\\n$arg = Argument::new(\'arrArg\');\\n// OR $arg->setType(FlagType::ARRAY);\\n$arg->setType(FlagType::STRINGS);\\n$arg->setDesc(\\"this is an array arg,\\\\n allow multi value,\\\\n must define at last\\");\\n\\n$fs->addArgument($arg);\\n```\\n\\n### \u89e3\u6790\u547d\u4ee4\u884c\u8f93\u5165\\n\\n\u6700\u540e\u8c03\u7528 `parse()` \u89e3\u6790\u547d\u4ee4\u884c\u8f93\u5165\u6570\u636e\\n\\n```php\\n// ...\\n\\nif (!$fs->parse($flags)) {\\n    // on render help\\n    return;\\n}\\n\\nvdump($fs->getOpts(), $fs->getArgs());\\n```\\n\\n**\u663e\u793a\u5e2e\u52a9**\\n\\n\u5f53\u8f93\u5165 `-h` \u6216 `--help` \u4f1a\u81ea\u52a8\u6e32\u67d3\u5e2e\u52a9\u4fe1\u606f\u3002\\n\\n```bash\\n$ php example/flags-demo.php --help\\n```\\n\\nOutput:\\n\\n![flags-demo](https://github.com/php-toolkit/pflag/blob/main/example/images/flags-demo.png?raw=true)\\n\\n**\u8fd0\u884c\u793a\u4f8b:**\\n\\n```bash\\n$ php example/flags-demo.php --name inhere --age 99 --tag go -t php -t java -d one -f arg0 80 arr0 arr1\\n```\\n\\n\u8f93\u51fa\u7ed3\u679c:\\n\\n```text\\n# \u9009\u9879\u6570\u636e\\narray(6) {\\n  [\\"str1\\"]=> string(6) \\"defVal\\"\\n  [\\"name\\"]=> string(6) \\"inhere\\"\\n  [\\"age\\"]=> int(99)\\n  [\\"tag\\"]=> array(3) {\\n    [0]=> string(2) \\"go\\"\\n    [1]=> string(3) \\"php\\"\\n    [2]=> string(4) \\"java\\"\\n  }\\n  [\\"name-is-very-lang\\"]=> string(3) \\"one\\"\\n  [\\"f\\"]=> bool(true)\\n}\\n\\n# \u53c2\u6570\u6570\u636e\\narray(3) {\\n  [0]=> string(4) \\"arg0\\"\\n  [1]=> int(80)\\n  [2]=> array(2) {\\n    [0]=> string(4) \\"arr0\\"\\n    [1]=> string(4) \\"arr1\\"\\n  }\\n}\\n```\\n\\n-----------\\n\\n## \u83b7\u53d6\u8f93\u5165\u503c\\n\\n\u83b7\u53d6flag\u503c\u5f88\u7b80\u5355\uff0c\u4f7f\u7528\u65b9\u6cd5 `getOpt(string $name)` `getArg($nameOrIndex)` \u5373\u53ef.\\n\\n> TIP: \u5c06\u901a\u8fc7\u5b9a\u4e49\u7684\u6570\u636e\u7c7b\u578b\u81ea\u52a8\u683c\u5f0f\u5316\u8f93\u5165\u503c\\n\\n**\u9009\u9879\u6570\u636e**\\n\\n```php\\n$force = $fs->getOpt(\'f\'); // bool(true)\\n$age  = $fs->getOpt(\'age\'); // int(99)\\n$name = $fs->getOpt(\'name\'); // string(inhere)\\n$tags = $fs->getOpt(\'tags\'); // array{\\"php\\", \\"go\\", \\"java\\"}\\n```\\n\\n**\u53c2\u6570\u6570\u636e**\\n\\n```php\\n$arg0 = $fs->getArg(0); // string(arg0)\\n// get an array arg\\n$arrArg = $fs->getArg(1); // array{\\"arr0\\", \\"arr1\\"}\\n// get value by name\\n$arrArg = $fs->getArg(\'arrArg\'); // array{\\"arr0\\", \\"arr1\\"}\\n```\\n\\n-----------\\n\\n## \u6269\u5c55\uff1a\u89c4\u5219\u5b9a\u4e49\\n\\n\u9009\u9879\u53c2\u6570\u89c4\u5219\u3002\u4f7f\u7528\u89c4\u5219\u53ef\u4ee5\u5feb\u901f\u5b9a\u4e49\u4e00\u4e2a\u9009\u9879\u6216\u53c2\u6570\u3002\\n\\n- string \u5b57\u7b26\u4e32\u89c4\u5219\u4ee5\u5206\u53f7 `;` \u5206\u5272\u6bcf\u4e2a\u90e8\u5206 (\u5b8c\u6574\u89c4\u5219\uff1a`type;desc;required;default;shorts`).\\n- array \u89c4\u5219\u6309 `SFlags::DEFINE_ITEM` \u8bbe\u7f6e\u5b9a\u4e49\\n- \u652f\u6301\u7684\u7c7b\u578b\u5e38\u91cf\u8bf7\u770b `FlagType::*`\\n\\n```php\\nuse Toolkit\\\\PFlag\\\\FlagType;\\n\\n$rules = [\\n     // v: \u53ea\u6709\u503c\uff0c\u4f5c\u4e3a\u540d\u79f0\u5e76\u4f7f\u7528\u9ed8\u8ba4\u7c7b\u578b FlagType::STRING\\n     // k-v: \u952e\u662f\u540d\u79f0\uff0c\u503c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32|\u6570\u7ec4\\n     \'long,s\',\\n     // name => rule\\n     \'long,a,b\' => \'int;an int option\', // long is option name, a and b is shorts.\\n     \'f\'      => FlagType::BOOL,\\n     \'str1\'   => [\'type\' => \'int\', \'desc\' => \'an string option\'],\\n     \'tags\'   => \'array; an array option\', // can also: ints, strings\\n     \'name\'   => \'type;the description message;required;default\', // with desc, default, required\\n]\\n```\\n\\n**\u5bf9\u4e8e\u9009\u9879**\\n\\n- \u9009\u9879\u5141\u8bb8\u8bbe\u7f6e\u77ed\u540d\u79f0 `shorts`\\n\\n> TIP: \u4f8b\u5982 `long,a,b` - `long` \u662f\u9009\u9879\u540d\u79f0. \u5269\u4f59\u7684 `a,b` \u90fd\u662f\u5b83\u7684\u77ed\u9009\u9879\u540d.\\n\\n**\u5bf9\u4e8e\u53c2\u6570**\\n\\n- \u53c2\u6570\u6ca1\u6709\u522b\u540d\u6216\u8005\u77ed\u540d\u79f0\\n- \u6570\u7ec4\u53c2\u6570\u53ea\u5141\u8bb8\u5b9a\u4e49\u5728\u6700\u540e\\n\\n**\u6570\u7ec4\u5b9a\u4e49\u9879**\\n\\n\u5e38\u91cf `Flags::DEFINE_ITEM`:\\n\\n```php\\npublic const DEFINE_ITEM = [\\n    \'name\'      => \'\',\\n    \'desc\'      => \'\',\\n    \'type\'      => FlagType::STRING,\\n    \'helpType\'  => \'\', // use for render help\\n    // \'index\'    => 0, // only for argument\\n    \'required\'  => false,\\n    \'default\'   => null,\\n    \'shorts\'    => [], // only for option\\n    // value validator\\n    \'validator\' => null,\\n    // \'category\' => null\\n];\\n```\\n\\n-----------\\n\\n## \u81ea\u5b9a\u4e49\u8bbe\u7f6e\\n\\n### \u89e3\u6790\u8bbe\u7f6e\\n\\n```php\\n    // -------------------- \u9009\u9879\u89e3\u6790\u8bbe\u7f6e --------------------\\n\\n    /**\\n     * Stop parse option on found first argument.\\n     *\\n     * - Useful for support multi commands. eg: `top --opt ... sub --opt ...`\\n     *\\n     * @var bool\\n     */\\n    protected $stopOnFistArg = true;\\n\\n    /**\\n     * Skip on found undefined option.\\n     *\\n     * - FALSE will throw FlagException error.\\n     * - TRUE  will skip it and collect as raw arg, then continue parse next.\\n     *\\n     * @var bool\\n     */\\n    protected $skipOnUndefined = false;\\n\\n    // -------------------- \u53c2\u6570\u89e3\u6790\u8bbe\u7f6e --------------------\\n\\n    /**\\n     * Whether auto bind remaining args after option parsed\\n     *\\n     * @var bool\\n     */\\n    protected $autoBindArgs = true;\\n\\n    /**\\n     * Strict match args number.\\n     * if exist unbind args, will throw FlagException\\n     *\\n     * @var bool\\n     */\\n    protected $strictMatchArgs = false;\\n\\n```\\n\\n### \u6e32\u67d3\u5e2e\u52a9\u8bbe\u7f6e\\n\\nsupport some settings for render help\\n\\n```php\\n\\n    // -------------------- settings for built-in render help --------------------\\n\\n    /**\\n     * \u81ea\u52a8\u6e32\u67d3\u5e2e\u52a9\u4fe1\u606f\u5f53\u8f93\u5165 \'-h\', \'--help\' \u9009\u9879\u65f6\\n     *\\n     * @var bool\\n     */\\n    protected $autoRenderHelp = true;\\n\\n    /**\\n     * \u5728\u6e32\u67d3\u7684\u5e2e\u52a9\u4fe1\u606f\u4e0a\u663e\u793a\u6570\u636e\u7c7b\u578b\\n     *\\n     * if False:\\n     *\\n     * -o, --opt    Option desc\\n     *\\n     * if True:\\n     *\\n     * -o, --opt STRING   Option desc\\n     *\\n     * @var bool\\n     */\\n    protected $showTypeOnHelp = true;\\n\\n    /**\\n     * \u5c06\u5728\u6253\u5370\u5e2e\u52a9\u6d88\u606f\u4e4b\u524d\u8c03\u7528\u5b83\\n     *\\n     * @var callable\\n     */\\n    private $beforePrintHelp;\\n\\n```\\n\\n\u81ea\u5b9a\u4e49\u5e2e\u52a9\u6d88\u606f\u6e32\u67d3:\\n\\n```php\\n$fs->setHelpRenderer(function (\\\\Toolkit\\\\PFlag\\\\FlagsParser $fs) {\\n    // render help messages\\n});\\n```\\n\\n-----------\\n\\n## \u5355\u5143\u6d4b\u8bd5\\n\\n```bash\\nphpunit --debug\\n```\\n\\ntest with coverage:\\n\\n```bash\\nphpdbg -qrr $(which phpunit) --coverage-text\\n```\\n\\n## \u4f7f\u7528pflag\u7684\u9879\u76ee\\n\\n\u8fd9\u4e9b\u9879\u76ee\u4f7f\u7528\u4e86 https://github.com/php-toolkit/pflag :\\n\\n- [inhere/console](https://github.com/inhere/console) Full-featured php command line application library.\\n- [kite](https://github.com/inhere/kite) Kite is a tool for help development.\\n- \u66f4\u591a\u7684\u8bf7\u770b [Packagist](https://packagist.org/packages/toolkit/pflag)\\n\\n> Github \u4ed3\u5e93: [php-toolkit/pflag](https://github.com/php-toolkit/pflag)"},{"id":"/2021/08/09/learn-bash-completion","metadata":{"permalink":"/blog/2021/08/09/learn-bash-completion","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2021/08-09-learn-bash-completion.md","source":"@site/blog/2021/08-09-learn-bash-completion.md","title":"\u5b66\u4e60\u7f16\u5199bash\u547d\u4ee4\u81ea\u52a8\u8865\u5168","description":"\u7b80\u5355\u5b66\u4e60\u7f16\u5199bash\u547d\u4ee4\u81ea\u52a8\u8865\u5168","date":"2021-08-09T11:24:00.000Z","formattedDate":"2021\u5e748\u67089\u65e5","tags":[{"label":"shell","permalink":"/blog/tags/shell"},{"label":"bash","permalink":"/blog/tags/bash"},{"label":"linux","permalink":"/blog/tags/linux"},{"label":"completion","permalink":"/blog/tags/completion"}],"readingTime":8.145,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u5b66\u4e60\u7f16\u5199bash\u547d\u4ee4\u81ea\u52a8\u8865\u5168","authors":"inhere","tags":["shell","bash","linux","completion"],"date":"2021-08-09T11:24"},"prevItem":{"title":"pflag - \u66f4\u597d\u7684PHP\u547d\u4ee4\u884c\u9009\u9879\u89e3\u6790\u5e93","permalink":"/blog/pflag-better-php-command-line-parse-library"},"nextItem":{"title":"\u7b80\u5355\u5feb\u901f\u7684\u914d\u7f6e\u81ea\u5df1\u7684bash\u73af\u5883","permalink":"/blog/2021/08/08/quick-config-bashrc"}},"content":"\u7b80\u5355\u5b66\u4e60\u7f16\u5199bash\u547d\u4ee4\u81ea\u52a8\u8865\u5168\\n\\n\x3c!--truncate--\x3e\\n\\n> \u4e0b\u9762\u7684\u793a\u4f8b\u4f7f\u7528 `__my_completion` \u4f5c\u4e3a\u547d\u4ee4\u884c\u5e94\u7528 `myapp`(eg: git) \u7684\u8865\u5168\u51fd\u6570\\n\\n## \u76f8\u5173\u51fd\u6570\u8bf4\u660e\\n\\n### complete \u51fd\u6570\\n\\n`complete` \u6307\u5b9a\u547d\u4ee4\u7684\u8865\u5168\u51fd\u6570\\n\\n\u81ea\u5b9a\u4e49\u8865\u5168\u65f6\u8c03\u7528complete\u547d\u4ee4\u6765\u5b8c\u6210\uff0ccomplete\u901a\u8fc7\u9009\u9879\u63d0\u4f9b\u4e86\u591a\u79cd\u8865\u5168\u7684\u9014\u5f84\u548c\u65b9\u5f0f\uff0c\u8fd9\u4e9b\u9009\u9879\u662f\u6309\u7167\u5148\u540e\u6b21\u5e8f\u8d77\u4f5c\u7528\u7684\uff1a`-A -G -W -F -C -X -P -S -o`\\n\\n\u4e00\u4e9b\u9009\u9879\u8bf4\u660e:\\n\\n- `-o STRING` \u989d\u5916\u8bbe\u7f6e\u8865\u5168\u9009\u9879\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u591a\u6b21\uff1b\u9009\u9879\u503c\u53ef\u4ee5\u4e3a\uff1a\\n  - `bashdefault` \u5982\u679c\u6ca1\u6709\u751f\u6210\u8865\u5168\u6761\u76ee\uff0c\u5c31\u4f7f\u7528bash\u9ed8\u8ba4\u7684\u5176\u5b83\u8865\u5168\\n  - `default`\\t\u5982\u679c\u6ca1\u6709\u751f\u6210\u8865\u5168\u6761\u76ee\uff0c\u5c31\u4f7f\u7528\u201creadline\u201d\u9ed8\u8ba4\u7684\u6587\u4ef6\u540d\u8865\u5168\u3002\\n  - `dirnames`\\t\u5982\u679c\u6ca1\u6709\u751f\u6210\u8865\u5168\u6761\u76ee\uff0c\u5c31\u8fdb\u884c\u76ee\u5f55\u540d\u8865\u5168\u3002\\n  - `filenames`\\t\u544a\u8bc9\u201creadline\u201d\u751f\u6210\u6587\u4ef6\u540d\uff0c\u4ee5\u4fbf\u8fdb\u884c\u4e0e\u6587\u4ef6\u540d\u76f8\u5173\u7684\u5904\u7406\uff0c\u4f8b\u5982\u5728\u76ee\u5f55\u540d\u540e\u9762\u52a0\u4e0a\u659c\u6760\uff0c\u5f15\u7528\u7279\u6b8a\u5b57\u7b26\uff0c\u53bb\u6389\u884c\u5c3e\u7684\u7a7a\u683c\uff0c\u76ee\u7684\u662f\u7528\u4e8eshell\u51fd\u6570\u3002\\n  - `noquote`\\t\u544a\u8bc9\u201creadline\u201d\u4e0d\u5f15\u7528\u6587\u4ef6\u540d\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u5f15\u7528\u3002\\n  - `nospace`\\t\u544a\u8bc9\u201creadline\u201d\u5728\u8865\u5168\u7684\u540d\u79f0\u540e\u4e0d\u6dfb\u52a0\u7a7a\u683c\uff0c\u9ed8\u8ba4\u6dfb\u52a0\u7a7a\u683c\u3002\\n  - `plusdirs`\\t\u751f\u6210\u8865\u5168\u6761\u76ee\u4e4b\u540e\uff0c\u8fd8\u4f1a\u8fdb\u884c\u76ee\u5f55\u540d\u8865\u5168\u5e76\u628a\u7ed3\u679c\u6dfb\u52a0\u5230\u5176\u5b83\u52a8\u4f5c\u5f97\u5230\u7684\u7ed3\u679c\u4e2d\u3002\\n- `-A STRING` action\uff0c\u6307\u5b9a\u52a8\u4f5c\uff0c\u8fd9\u4e2a\u6709\u56fa\u5b9a\u7684\u51e0\u4e2a\u53ef\u9009\u3002\u9009\u9879\u503c\u53ef\u4ee5\u4e3a\uff1a\\n  - `alias`\\t\u522b\u540d\uff0c\u540c\u9009\u9879  `-a`\u3002\\n  - `arrayvar`\\t\u6570\u7ec4\u53d8\u91cf\u540d\u3002\\n  - `binding`\\t\u201creadline\u201d\u952e\u7ed1\u5b9a\u540d\u3002\\n  - `builtin`\\tshell\u5185\u5efa\u547d\u4ee4\u540d\uff0c\u540c\u9009\u9879 `-b`\u3002\\n  - `command`\\t\u547d\u4ee4\u540d\uff0c\u540c\u9009\u9879 `-c`\u3002\\n  - `directory`\\t\u76ee\u5f55\u540d\uff0c\u540c\u9009\u9879 `-d`\u3002\\n  - `disabled`\\t\u4e0d\u53ef\u7528\u7684shell\u5185\u5efa\u547d\u4ee4\u540d\u3002\\n  - `enabled`\\t\u53ef\u7528\u7684shell\u5185\u5efa\u547d\u4ee4\u540d\u3002\\n  - `export`\\t\u5bfc\u51fa\u7684shell\u53d8\u91cf\u540d\uff0c\u540c\u9009\u9879`-e`\u3002\\n  - `file`\\t\u6587\u4ef6\u540d\uff0c\u540c\u9009\u9879 `-f`\u3002\\n  - `function`\\tshell\u51fd\u6570\u540d\u3002\\n  - `group`\\t\u7ec4\u540d\uff0c\u540c\u9009\u9879 `-g`\u3002\\n  - `helptopic`\\t\u5185\u5efa\u547d\u4ee4help\u652f\u6301\u7684\u5e2e\u52a9\u4e3b\u9898\u3002\\n  - `hostname`\\t\u4e3b\u673a\u540d\uff0c\u4eceshell\u73af\u5883\u53d8\u91cfHOSTFILE\u4e2d\u83b7\u53d6\u3002\\n  - `job`\\t\u4f5c\u4e1a\u540d\uff0c\u540c\u9009\u9879 `-j`\u3002\\n  - `keyword`\\tshell\u4fdd\u7559\u5b57\uff0c\u540c\u9009\u9879 `-k`\u3002\\n  - `running`\\t\u6b63\u5728\u8fd0\u884c\u7684\u4f5c\u4e1a\u540d\u3002\\n  - `service`\\t\u670d\u52a1\u540d\uff0c\u540c\u9009\u9879 `-s`\u3002\\n  - `setopt`\\t\u5185\u5efa\u547d\u4ee4set\u7684\u9009\u9879 `-o` \u53ef\u7528\u7684\u53c2\u6570\u3002\\n  - `shopt`\\t\u5185\u5efa\u547d\u4ee4shopt\u53ef\u63a5\u53d7\u7684\u9009\u9879\u540d\u3002\\n  - `signal`\\t\u4fe1\u53f7\u540d\u3002\\n  - `stopped`\\t\u6682\u505c\u7684\u4f5c\u4e1a\u540d\u3002\\n  - `user`\\t\u7528\u6237\u540d\uff0c\u540c\u9009\u9879 `-u`\u3002\\n  - `variable`\\t\u6240\u6709\u7684shell\u53d8\u91cf\u540d\uff0c\u540c\u9009\u9879 `-v`\u3002\\n- `-C command`\\t\u5728\u5b50shell\u4e2d\u6267\u884c\u547d\u4ee4\uff0c\u5e76\u628a\u5176\u7ed3\u679c\u4f5c\u4e3a\u8865\u5168\u6761\u76ee\u3002\\n- `-F function` \u6307\u5b9afunction\u751f\u6210\u53ef\u9009\u5355\u8bcd\u3002\\n  - \u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\uff0c\u4e00\u4e9bshell\u53d8\u91cf\u53ef\u4ee5\u4f7f\u7528\uff1a`COMP_LINE`, `COMP_POINT`, `COMP_KEY`, `COMP_TYPE`\u3002\\n  - \u51fd\u6570\u53c2\u6570\u5b9a\u4e49\u662f\uff1a`$1` \u4e3a\u5f53\u524d\u8981\u8865\u5168\u53c2\u6570\u7684\u547d\u4ee4\uff0c`$2` \u4e3a\u5f53\u524d\u8981\u8865\u5168\u7684\u5355\u8bcd\uff0c`$3` \u4e3a\u5f53\u524d\u8981\u8865\u5168\u5355\u8bcd\u7684\u524d\u9762\u4e00\u4e2a\u5355\u8bcd\u3002\\n  - \u8fd9\u4e9b\u90fd\u53ef\u4ee5\u5728\u81ea\u5b9a\u4e49\u51fd\u6570\u4e2d\u4f7f\u7528\u3002\u6700\u7ec8\u5355\u8bcd\u5217\u8868\u8981\u653e\u5230 `COMPREPLY` \u8fd9\u4e2a\u6570\u7ec4\u4e2d\uff0cshell\u8865\u5168\u673a\u5236\u662f\u4ece\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u53d6\u5355\u8bcd\u7684\u3002\\n- `-G globpat`\\t\u4f7f\u7528\u6587\u4ef6\u540d\u6269\u5c55\u6a21\u5f0fglobpat\u8fdb\u884c\u6269\u5c55\u4ee5\u751f\u6210\u53ef\u80fd\u7684\u8865\u5168\u6761\u76ee\u3002\\n- `-P prefix`\\t\u5728\u6240\u6709\u7684\u9009\u9879\u5e94\u7528\u5230\u8865\u5168\u7ed3\u679c\u540e\uff0c\u5728\u7ed3\u679c\u524d\u6dfb\u52a0\u524d\u7f00prefix\u3002\\n- `-S suffix`\\t\u5728\u6240\u6709\u7684\u9009\u9879\u5e94\u7528\u5230\u8865\u5168\u7ed3\u679c\u540e\uff0c\u5728\u7ed3\u679c\u540e\u6dfb\u52a0\u540e\u7f00suffix\u3002\\n- `-W wordlist`\\t\u4f7f\u7528\u7279\u6b8a\u53d8\u91cf `IFS` \u4e2d\u7684\u5b57\u7b26\u62c6\u5206\u5355\u8bcd\u5217\u8868wordlist\uff0c\u5e76\u6269\u5c55\u62c6\u5206\u540e\u7684\u6bcf\u4e2a\u5355\u8bcd\uff0c\u7ed3\u679c\u4e2d\u4e0e\u5f85\u8865\u5168\u5355\u8bcd\u5339\u914d\u7684\u6761\u76ee\u5c31\u662f\u8865\u5168\u6761\u76ee\u3002\\n- `-X filterpat`\\tfilterpat\u662f\u8fdb\u884c\u6587\u4ef6\u540d\u6269\u5c55\u65f6\u4f7f\u7528\u7684\u6a21\u5f0f\uff0c\u5b83\u4f5c\u7528\u4e8e\u901a\u8fc7\u524d\u9762\u7684\u9009\u9879\u548c\u53c2\u6570\u751f\u6210\u7684\u8865\u5168\u5217\u8868\uff0c\u5e76\u628a\u6bcf\u4e2a\u4e0e\u8fc7\u6ee4\u6a21\u5f0f\u5339\u914d\u7684\u6761\u76ee\u5220\u9664\uff0c\u6a21\u5f0f\u4e2d\u524d\u5bfc\u7684\u53f9\u53f7\u8868\u793a\u5426\u5b9a\uff0c\u8fd9\u65f6\u4f1a\u5220\u9664\u4e0e\u8fc7\u6ee4\u6a21\u5f0f\u4e0d\u5339\u914d\u7684\u6761\u76ee\u3002\\n\\n> TIP: `IFS` \u5185\u90e8\u5b57\u6bb5\u5206\u9694\u7b26\u3002\\n> \u7528\u4e8e\u8fed\u4ee3\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982\uff1a`data=\\"a,b,c\\"` \u8bbe\u7f6e `local IFS=\\",\\"` , \u4f7f\u7528 `for item in $data` \u8fed\u4ee3\u5b57\u7b26\u4e32\uff0c\u5185\u90e8item \u5373\u662f\u5355\u4e2a\u7684 `a` `b` `c`\\n\\n** -F \u8865\u5145\u8bf4\u660e\uff1a**\\n\\n- `COMPREPLY` \u53d8\u91cf\u7684\u5185\u5bb9\u603b\u662f\u4f1a\u663e\u793a\uff0c\u8865\u5168\u51fd\u6570\u9700\u8981\u81ea\u5df1\u5904\u7406\u5176\u4e2d\u7684\u5185\u5bb9\u3002\\n- \u5982\u679c `COMPREPLY` \u53d8\u91cf\u4e2d\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8bcd\u4f1a\u81ea\u52a8\u8865\u5168\u5230\u547d\u4ee4\u4e4b\u540e\u3002\u8fd4\u56de\u591a\u4e2a\u5019\u9009\u5219\u4e0d\u4f1a\u89e6\u53d1\u8fd9\u4e2a\u529f\u80fd\u3002\\n\\n- `COMP_WORDS`\uff1a\u5f53\u524d\u547d\u4ee4\u884c\u4e2d\u5df2\u7ecf\u8f93\u5165\u7684\u8bcd\u6570\u7ec4\u3002\\n- `COMP_CWORD`\uff1a\u5f53\u524d\u5149\u6807\u6240\u5904\u8bcd\u4f4d\u4e8e `COMP_WORDS` \u6570\u7ec4\u4e2d\u7684\u7d22\u5f15\u503c\u3002\u65e2\u5f53\u6309\u4e0b tab \u952e\u65f6\u5149\u6807\u6240\u5904\u8bcd\u7684\u7d22\u5f15\u3002\\n- `COMP_LINE`\uff1a\u5f53\u524d\u547d\u4ee4\u884c\u3002\\n\\n\u83b7\u53d6\u547d\u4ee4\u540e\u9762\u7684\u8bcd\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `COMP_WORDS[1]` \u7684\u503c\\n\\n### compgen \u51fd\u6570\\n\\n`compgen` \u662f\u4e00\u4e2a\u7528\u4e8e\u751f\u6210\u8865\u5168\u5217\u8868\u7684\u5185\u7f6e\u547d\u4ee4\uff0c\u652f\u6301complete\u547d\u4ee4\u7684\u5927\u90e8\u5206\u53c2\u6570\uff08\u4f8b\u5982-W\u53c2\u6570\u6307\u5b9a\u8865\u5168\u8bcd\u5217\u8868\uff0c-d\u53c2\u6570\u8865\u5168\u76ee\u5f55\uff09\uff0c\u5e76\u80fd\u591f **\u57fa\u4e8e\u7528\u6237\u5df2\u7ecf\u8f93\u5165\u7684\u5185\u5bb9\u8fdb\u884c\u8fc7\u6ee4**\\n\\n```bash\\n$ compgen --help\\ncompgen: compgen [-abcdefgjksuv] [-o option] [-A action] [-G globpat] [-W wordlist]  [-F function] [-C command] [-X filterpat] [-P prefix] [-S suffix] [word]\\n```\\n\\n\u9009\u9879 | \u9009\u9879\u503c   | \u8bf4\u660e\\n----|-----------|-----------------------\\n`-F` |   function | \u6267\u884cshell \u51fd\u6570\uff0c\u51fd\u6570\u4e2d\u751f\u6210COMPREPLY\u4f5c\u4e3a\u5019\u9009\u7684\u8865\u5168\u7ed3\u679c\\n`-C` |    command | \u5c06 command \u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u4f5c\u4e3a\u5019\u9009\u7684\u8865\u5168 \u7ed3\u679c\\n`-G` |    pattern | \u5c06\u5339\u914d pattern\u7684\u6587\u4ef6\u540d\u4f5c\u4e3a\u5019\u9009\u7684\u8865\u5168\u7ed3\u679c\\n`-W` |    wordlist |  \u5206\u5272 wordlist \u4e2d\u7684\u5355\u8bcd\uff0c\u4f5c\u4e3a\u5019\u9009\u7684\u8865\u5168\u7ed3\u679c\\n`-p` |    `[name]` | \u5217\u51fa\u5f53\u524d\u6240\u6709\u7684\u8865\u5168\u547d\u4ee4\\n`-r` |   `[name]` | \u5220\u9664\u67d0\u4e2a\u8865\u5168\u547d\u4ee4\\n\\n\u6d4b\u8bd5\u4f7f\u7528\uff1a\\n\\n```bash\\n$ compgen -W \\"one two three\\"\\none\\ntwo\\nthree\\n\\ninhere@Inhere-win10 MINGW64 /f/work (main)\\n$ compgen -W \\"one two three\\" o\\none\\n\\ninhere@Inhere-win10 MINGW64 /f/work (main)\\n$ compgen -W \\"one two three\\" t\\ntwo\\nthree\\n```\\n\\n### \u5e2e\u52a9\u8c03\u8bd5\\n\\n```bash\\n# \u6253\u5370\u5168\u90e8\u5df2\u5b9a\u4e49\u7684\u51fd\u6570\u540d\u79f0\\ndeclare -F\\n# \u67e5\u770b\u6307\u5b9a\u51fd\u6570\u7684\u5b9a\u4e49\\ndeclare -f __my_completion\\n```\\n\\n## \u5206\u5272\u5355\u8bcd\u5217\u8868\u4f5c\u4e3a\u8865\u5168\u6570\u636e\\n\\n```bash\\n#!/usr/bin/env bash\\n\\n__my_completion () {\\n    cur_name=\\"${COMP_WORDS[COMP_CWORD]}\\"\\n    # \u5019\u9009\u547d\u4ee4\\n    commands=\\"one two three\\"\\n    COMPREPLY=($(compgen -W \\"$commands\\" -- \\"$cur_name\\"))\\n}\\n\\ncomplete -F __my_completion myapp\\n```\\n\\n## \u4f7f\u7528echo\u8fd4\u56de\u4f5c\u4e3a\u8865\u5168\u6570\u636e\\n\\n\u7b80\u5355\u7684\u4f7f\u7528echo\u8fd4\u56de\u4f5c\u4e3a\u8865\u5168\u6570\u636e\\n\\n```bash\\n__my_completion () {\\n    # \u5019\u9009\u547d\u4ee4\\n    commands=\\"one two three\\"\\n    echo $commands\\n}\\n\\n# for use echo\\ncomplete -o dirnames -C \'__my_completion\' myapp\\n```\\n\\n## \u4f7f\u7528\u5916\u90e8\u51fd\u6570\u7684\u7ed3\u679c\u8865\u5168\\n\\n```bash\\n__my_completion () {\\n    # \u8f93\u5165\u7684\u5173\u952e\u8bcd\\n    local term=\\"${COMP_WORDS[COMP_CWORD]}\\"\\n    # \u4f7f\u7528\u5916\u90e8\u547d\u4ee4\u6765\u5339\u914d\u5173\u952e\u8bcd\u5e76\u8fd4\u56de\u7ed3\u679c\\n    local commands=$(kite jump hint \\"$term\\" --no-name)\\n\\n    #    echo commands:\\n    #    echo $commands --- ${commands[@]}\\n    COMPREPLY=($commands)\\n}\\n\\n# for use echo\\ncomplete -o dirnames -F \'__my_completion\' myapp\\n```\\n\\n\\n> TIP: \u7f16\u5199\u597d\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528 `source ./my_complete.sh` \u4e34\u65f6\u52a0\u8f7d\u5230bash; \u8981\u4fdd\u6301\u4e00\u76f4\u751f\u6548\u9700\u8981\u914d\u7f6e\u5230 `.bashrc`\\n\\n\\n> \u53c2\u8003\u6587\u7ae0\u94fe\u63a5\uff1a\\n> - https://blog.csdn.net/qq_38883889/article/details/106543271\\n> - https://blog.csdn.net/junyidcf/article/details/54178196\\n> - https://www.infoq.cn/article/bash-programmable-completion-tutorial"},{"id":"/2021/08/08/quick-config-bashrc","metadata":{"permalink":"/blog/2021/08/08/quick-config-bashrc","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2021/08-08-quick-config-bashrc.md","source":"@site/blog/2021/08-08-quick-config-bashrc.md","title":"\u7b80\u5355\u5feb\u901f\u7684\u914d\u7f6e\u81ea\u5df1\u7684bash\u73af\u5883","description":"\u7b80\u5355\u5feb\u901f\u7684\u914d\u7f6e\u81ea\u5df1\u7684bash\u73af\u5883","date":"2021-08-08T11:26:00.000Z","formattedDate":"2021\u5e748\u67088\u65e5","tags":[{"label":"shell","permalink":"/blog/tags/shell"},{"label":"bash","permalink":"/blog/tags/bash"},{"label":"linux","permalink":"/blog/tags/linux"}],"readingTime":1.05,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u7b80\u5355\u5feb\u901f\u7684\u914d\u7f6e\u81ea\u5df1\u7684bash\u73af\u5883","authors":"inhere","tags":["shell","bash","linux"],"date":"2021-08-08T11:26"},"prevItem":{"title":"\u5b66\u4e60\u7f16\u5199bash\u547d\u4ee4\u81ea\u52a8\u8865\u5168","permalink":"/blog/2021/08/09/learn-bash-completion"},"nextItem":{"title":"MDX Blog Post","permalink":"/blog/mdx-blog-post"}},"content":"\u7b80\u5355\u5feb\u901f\u7684\u914d\u7f6e\u81ea\u5df1\u7684bash\u73af\u5883\\n\\n\x3c!--truncate--\x3e\\n\\n## \u81ea\u52a8\u52a0\u8f7d\u6307\u5b9a\u76ee\u5f55\u7684\u811a\u672c\\n\\n\u5feb\u901f\u7684\u914d\u7f6ebashrc\u652f\u6301\u81ea\u52a8\u52a0\u8f7d\u6307\u5b9a\u76ee\u5f55\u7684bash\u811a\u672c\\n\\n\u60f3\u8981\u5c06bash\u811a\u672c\u653e\u7f6e\u5230 `~/.bash-scripts`\\n\\n```bash\\nmkdir ~/.bash-scripts\\n```\\n\\n\u4f7f\u7528vim\u6253\u5f00 `~/.bashrc`:\\n\\n```bash\\nvim ~/.bashrc\\n```\\n\\n\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9:\\n\\n```bash\\n#\\n#\\n# use for custom config an .bashrc, support auto load *.bash files\\n#\\n\\n## auto load bash files\\nfor file in .bash-scripts/*.bash\\ndo\\n    # shellcheck disable=SC1090\\n    test -f $file && . $file\\ndone\\n\\n## load custom aliases file.\\nlocal customAliasFile=~/.my-aliases.sh\\n# shellcheck disable=SC1090\\ntest -f $customAliasFile && . $customAliasFile\\n\\n```\\n\\n## \u914d\u7f6e\u5e38\u7528\u522b\u540d\u548c\u51fd\u6570\\n\\n\u6211\u5c06\u81ea\u5df1\u7684\u5e38\u7528\u522b\u540d\u548c\u51fd\u6570 \u653e\u7f6e\u5230 `~/.my-aliases.sh`\\n\\n```bash\\n##\\n## aliases\\n##\\nalias ls=\\"ls --color=auto\\"\\nalias ll=\\"ls -al\\"\\nalias gst=\\"git status\\"\\n\\n##\\n## reload bash\\n##\\nfunction reload_bash(){\\n    source ~/.bashrc\\n}\\n\\n##\\n## proxy setting\\n##\\nfunction proxy_off(){\\n    unset http_proxy\\n    unset https_proxy\\n    echo -e \\"proxy closed\\"\\n}\\n\\nfunction proxy_on() {\\n    export no_proxy=\\"localhost,127.0.0.1,localaddress,.localdomain.com\\"\\n    export http_proxy=\\"http://127.0.0.1:10801\\"\\n    export https_proxy=$http_proxy\\n    echo -e \\"proxy opened\\"\\n}\\n\\n```"},{"id":"mdx-blog-post","metadata":{"permalink":"/blog/mdx-blog-post","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2021-08-01-mdx-blog-post.mdx","source":"@site/blog/2021-08-01-mdx-blog-post.mdx","title":"MDX Blog Post","description":"Blog posts support Docusaurus Markdown features, such as MDX.","date":"2021-08-01T00:00:00.000Z","formattedDate":"2021\u5e748\u67081\u65e5","tags":[{"label":"docusaurus","permalink":"/blog/tags/docusaurus"}],"readingTime":0.175,"hasTruncateMarker":false,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"slug":"mdx-blog-post","title":"MDX Blog Post","authors":["inhere"],"tags":["docusaurus"]},"prevItem":{"title":"\u7b80\u5355\u5feb\u901f\u7684\u914d\u7f6e\u81ea\u5df1\u7684bash\u73af\u5883","permalink":"/blog/2021/08/08/quick-config-bashrc"},"nextItem":{"title":"ZSH\u81ea\u52a8\u8865\u5168\u811a\u672c\u7f16\u5199","permalink":"/blog/2021/07/28/zsh-completions-howto"}},"content":"Blog posts support [Docusaurus Markdown features](https://docusaurus.io/docs/markdown-features), such as [MDX](https://mdxjs.com/).\\n\\n:::tip\\n\\nUse the power of React to create interactive blog posts.\\n\\n```js\\n<button onClick={() => alert(\'button clicked!\')}>Click me!</button>\\n```\\n\\n<button onClick={() => alert(\'button clicked!\')}>Click me!</button>\\n\\n:::"},{"id":"/2021/07/28/zsh-completions-howto","metadata":{"permalink":"/blog/2021/07/28/zsh-completions-howto","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2021/07-28-zsh-completions-howto.md","source":"@site/blog/2021/07-28-zsh-completions-howto.md","title":"ZSH\u81ea\u52a8\u8865\u5168\u811a\u672c\u7f16\u5199","description":"\u544a\u8bc9 zsh \u4f7f\u7528\u54ea\u4e2a\u51fd\u6570\u6765\u5b8c\u6210\u547d\u4ee4","date":"2021-07-28T22:04:00.000Z","formattedDate":"2021\u5e747\u670828\u65e5","tags":[{"label":"shell","permalink":"/blog/tags/shell"},{"label":"zsh","permalink":"/blog/tags/zsh"},{"label":"linux","permalink":"/blog/tags/linux"}],"readingTime":16.375,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"ZSH\u81ea\u52a8\u8865\u5168\u811a\u672c\u7f16\u5199","authors":"inhere","tags":["shell","zsh","linux"],"date":"2021-07-28T22:04"},"prevItem":{"title":"MDX Blog Post","permalink":"/blog/mdx-blog-post"},"nextItem":{"title":"\u5728shell\u811a\u672c\u91cc\u7b80\u5355\u5feb\u901f\u7684\u4f7f\u7528\u989c\u8272","permalink":"/blog/simple-use-color-in-shell"}},"content":"\u544a\u8bc9 zsh \u4f7f\u7528\u54ea\u4e2a\u51fd\u6570\u6765\u5b8c\u6210\u547d\u4ee4\\n\\n\u547d\u4ee4\u7684\u5b8c\u6210\u51fd\u6570\u5b58\u50a8\u5728\u540d\u79f0\u4ee5\u4e0b\u5212\u7ebf `_` \u5f00\u5934\u7684\u6587\u4ef6\u4e2d\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5e94\u653e\u7f6e\u5728 `$fpath` \u53d8\u91cf\u4e2d\u5217\u51fa\u7684\u76ee\u5f55\u4e2d\u3002\\n\u53ef\u4ee5\u901a\u8fc7\u5728 `~/.zshrc` \u6587\u4ef6\u4e2d\u6dfb\u52a0\u8fd9\u6837\u7684\u884c\u6765\u5411 `$fpath` \u6dfb\u52a0\u76ee\u5f55\uff1a\\n\\n```bash\\nfpath=(~/newdir $fpath )\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n\u5b8c\u6210\u51fd\u6570\u6587\u4ef6\u7684\u7b2c\u4e00\u884c\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\\n\\n```bash\\n# compdef foobar\\n```\\n\\n\u8fd9\u544a\u8bc9 zsh \u8be5\u6587\u4ef6\u5305\u542b\u7528\u4e8e\u5b8c\u6210 foobar \u547d\u4ee4\u7684\u4ee3\u7801\u3002\u8fd9\u662f\u7b2c\u4e00\u884c\u6700\u5e38\u4f7f\u7528\u7684\u683c\u5f0f\uff0c\u4f46\u5982\u679c\u9700\u8981\uff0c\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6587\u4ef6\u6765\u5b8c\u6210\u591a\u4e2a\u4e0d\u540c\u7684\u529f\u80fd\u3002\\n\u8bf7\u53c2\u9605[\u6b64\u5904](http://zsh.sourceforge.net/Doc/Release/Completion-System.html#Autoloaded-files)\u4e86\u89e3\u66f4\u591a\u8be6\u60c5\u3002\\n\\n\u4f60\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 `compdef` \u547d\u4ee4\uff08\u4f8b\u5982\u5728\u4f60\u7684 `~/.zshrc` \u6587\u4ef6\u4e2d\uff09\u544a\u8bc9 zsh \u4f7f\u7528\u54ea\u4e2a\u51fd\u6570\u6765\u5b8c\u6210\u8fd9\u6837\u7684\u547d\u4ee4\uff1a\\n\\n\\n```bash\\n> compdef _function foobar\\n```\\n\\n\u6216\u8005\u5bf9\u51e0\u4e2a\u547d\u4ee4\u4f7f\u7528\u76f8\u540c\u7684\u5b8c\u6210\uff1a\\n\\n```bash\\n> compdef _function foobar goocar hoodar\\n```\\n\\n\u6216\u8005\u5982\u679c\u4f60\u60f3\u63d0\u4f9b\u53c2\u6570\uff1a\\n\\n```bash\\n> compdef \' _function arg1 arg2 \' foobar\\n```\\n\\n\u8bf7\u53c2[\u9605\u6b64](http://zsh.sourceforge.net/Doc/Release/Completion-System.html#Functions-4)\u5904\u4e86\u89e3\u66f4\u591a\u8be6\u60c5\u3002\\n\\n## \u7f16\u5199\u81ea\u5df1\u7684\u5b8c\u6210\u51fd\u6570\\n\\n\u4e00\u4e2a\u5f88\u597d\u7684\u5165\u95e8\u65b9\u6cd5\u662f\u67e5\u770b\u4e00\u4e9b\u5df2\u7ecf\u5b9a\u4e49\u7684\u5b8c\u6210\u51fd\u6570\u3002\u5728\u6211\u7684 linux \u5b89\u88c5\u4e2d\uff0c\u8fd9\u4e9b\u53ef\u4ee5\u5728 `/usr/share/zsh/functions/Completion/Unix` \u548c `/usr/share/zsh/functions/Completion/Linux` \u548c\u5176\u4ed6\u4e00\u4e9b\u5b50\u76ee\u5f55\u4e2d\u627e\u5230\u3002\\n\\n\u60a8\u4f1a\u6ce8\u610f\u5230 `_arguments` \u51fd\u6570\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u88ab\u5927\u91cf\u4f7f\u7528\u3002\u8fd9\u662f\u4e00\u4e2a\u5b9e\u7528\u51fd\u6570\uff0c\u53ef\u4ee5\u8f7b\u677e\u7f16\u5199\u7b80\u5355\u7684\u5b8c\u6210\u51fd\u6570\u3002`_arguments` \u51fd\u6570\u662f `compadd` \u5185\u7f6e\u51fd\u6570\u7684\u5305\u88c5\u5668\u3002`compadd` \u5185\u7f6e\u51fd\u6570\u662f\u7528\u4e8e\u5411\u547d\u4ee4\u884c\u6dfb\u52a0\u5b8c\u6210\u8bcd\u5e76\u63a7\u5236\u5176\u884c\u4e3a\u7684\u6838\u5fc3\u51fd\u6570\u3002\\n\u4f46\u662f\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u60a8\u4e0d\u9700\u8981\u4f7f\u7528 `compadd`\uff0c\u56e0\u4e3a\u6709\u8bb8\u591a\u5b9e\u7528\u51fd\u6570\uff0c\u4f8b\u5982 `_arguments` \u548c `_describe`\uff0c\u5b83\u4eec\u66f4\u6613\u4e8e\u4f7f\u7528\u3002\\n\\n\u5bf9\u4e8e\u975e\u5e38\u57fa\u672c\u7684\u5b8c\u6210\uff0c`_describe` \u51fd\u6570\u5e94\u8be5\u8db3\u591f\u4e86\\n\\n### \u5b9e\u7528\u529f\u80fd\\n\\n\u4ee5\u4e0b\u662f\u4e00\u4e9b\u53ef\u80fd\u6709\u7528\u7684\u5b9e\u7528\u51fd\u6570\u7684\u5217\u8868\u3002\u5b9e\u7528\u529f\u80fd\u7684\u5b8c\u6574\u5217\u8868\u4ee5\u53ca\u5b8c\u6574\u7684\u89e3\u91ca\u53ef\u5728\u6b64\u5904\u83b7\u5f97\u3002\u4e0b\u4e00\u8282\u5c06\u7ed9\u51fa\u5982\u4f55\u4f7f\u7528\u8fd9\u4e9b\u51fd\u6570\u7684\u793a\u4f8b\u3002\\n\\n**\u6574\u4f53\u5b8c\u6210\u7684\u4e3b\u8981\u5b9e\u7528\u529f\u80fd**\\n\\n\u51fd\u6570 | \u8bf4\u660e\\n-----|-------\\n`_alternative`\\t| \u53ef\u7528\u4e8e\u4ece\u5176\u4ed6\u5b9e\u7528\u7a0b\u5e8f\u51fd\u6570\u6216 shell \u4ee3\u7801\u751f\u6210\u5b8c\u6210\u5019\u9009\u3002\\n`_arguments`\\t| \u7528\u4e8e\u6307\u5b9a\u5982\u4f55\u5b8c\u6210\u5e26\u6709 unix \u6837\u5f0f\u9009\u9879\u7684\u547d\u4ee4\u7684\u5355\u4e2a\u9009\u9879\u548c\u53c2\u6570\u3002\\n`_describe`\\t| \u7528\u4e8e\u521b\u5efa\u7531\u5e26\u6709\u63cf\u8ff0\uff08\u4f46\u6ca1\u6709\u52a8\u4f5c `ACTION`\uff09\u7684\u5355\u8bcd\u7ec4\u6210\u7684\u7b80\u5355\u5b8c\u6210\u3002\u6bd4 `_arguments` \u66f4\u5bb9\u6613\u4f7f\u7528\\n`_gnu_generic` |\\t\u53ef\u7528\u4e8e\u5b8c\u6210\u7406\u89e3 `--help` \u9009\u9879\u7684\u547d\u4ee4\u7684\u9009\u9879\u3002\\n`_regex_arguments` |\\t\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\uff0c\u7528\u4e8e\u5c06\u547d\u4ee4\u884c\u53c2\u6570\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u7136\u540e\u6267\u884c\u64cd\u4f5c/\u5b8c\u6210\u3002\\n\\n**\u7528\u4e8e\u6267\u884c\u5355\u4e2a\u5355\u8bcd\u7684\u590d\u6742\u5b8c\u6210\u7684\u51fd\u6570**\\n\\n\u51fd\u6570 | \u8bf4\u660e\\n-----|-------\\n`_values` |\u7528\u4e8e\u5b8c\u6210\u4efb\u610f\u5173\u952e\u5b57\uff08\u503c\uff09\u53ca\u5176\u53c2\u6570\uff0c\u6216\u6b64\u7c7b\u7ec4\u5408\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\\n`_combination`   |  \u7528\u4e8e\u5b8c\u6210\u503c\u7684\u7ec4\u5408\uff0c\u4f8b\u5982\u4e3b\u673a\u540d\u548c\u7528\u6237\u540d\u5bf9\u3002\\n`_multi_parts` |   \u7528\u4e8e\u5206\u522b\u5b8c\u6210\u5355\u8bcd\u7684\u591a\u4e2a\u90e8\u5206\uff0c\u5176\u4e2d\u6bcf\u4e2a\u90e8\u5206\u7531\u4e00\u4e9b\u5b57\u7b26\u5206\u9694\uff0c\u4f8b\u5982\u7528\u4e8e\u5b8c\u6210\u90e8\u5206\u6587\u4ef6\u8def\u5f84\uff1a`/u/i/sy -> /usr/include/sys`\\n`_sep_parts`  |    \u4e0e _multi_parts \u7c7b\u4f3c\uff0c\u4f46\u5141\u8bb8\u5728\u5b8c\u6210\u7684\u4e0d\u540c\u90e8\u5206\u4f7f\u7528\u4e0d\u540c\u7684\u5206\u9694\u7b26\u3002\\n`_sequence`   |  \u7528\u4f5c\u53e6\u4e00\u4e2a\u5b8c\u6210\u51fd\u6570\u7684\u5305\u88c5\u5668\uff0c\u4ee5\u5b8c\u6210\u7531\u8be5\u5176\u4ed6\u51fd\u6570\u751f\u6210\u7684\u5206\u9694\u5339\u914d\u5217\u8868\u3002\\n\\n**\u7528\u4e8e\u5b8c\u6210\u7279\u5b9a\u7c7b\u578b\u5bf9\u8c61\u7684\u51fd\u6570**\\n\\n\u51fd\u6570 | \u8bf4\u660e\\n-----|-------\\n`_path_files`  |    \u7528\u4e8e\u5b8c\u6210\u6587\u4ef6\u8def\u5f84\u3002\u91c7\u53d6\u591a\u79cd\u9009\u62e9\u6765\u63a7\u5236\u884c\u4e3a\u3002\\n`_files`    |  \u4f7f\u7528\u9664 `-g` \u548c `-/` \u4e4b\u5916\u7684\u6240\u6709\u9009\u9879\u8c03\u7528 `_path_files`\u3002\u8fd9\u4e9b\u9009\u9879\u53d6\u51b3\u4e8e\u6587\u4ef6\u6a21\u5f0f\u6837\u5f0f\u8bbe\u7f6e\u3002\\n`_net_interfaces` | \u7528\u4e8e\u8865\u5168\u7f51\u7edc\u63a5\u53e3\u540d\u79f0\\n`_users`   |   \u7528\u4e8e\u586b\u5199\u7528\u6237\u540d\\n`_groups` | \u7528\u4e8e\u5b8c\u6210\u7ec4\u540d\\n`_options`    |  \u7528\u4e8e\u8865\u5168 shell \u9009\u9879\u7684\u540d\u79f0\u3002\\n`_parameters`    |  \u7528\u4e8e\u5b8c\u6210 shell \u53c2\u6570/\u53d8\u91cf\u7684\u540d\u79f0\uff08\u53ef\u4ee5\u9650\u5236\u4e3a\u5339\u914d\u6a21\u5f0f\u7684\u90a3\u4e9b\uff09\\n\\n**\u5904\u7406\u7f13\u5b58\u5b8c\u6210\u7684\u51fd\u6570**\\n\\n\u5982\u679c\u60a8\u6709\u5927\u91cf\u5b8c\u6210\uff0c\u60a8\u53ef\u4ee5\u5c06\u5b83\u4eec\u4fdd\u5b58\u5728\u7f13\u5b58\u6587\u4ef6\u4e2d\uff0c\u4ee5\u4fbf\u5feb\u901f\u52a0\u8f7d\u5b8c\u6210\u3002\\n\\n\u51fd\u6570 | \u8bf4\u660e\\n-----|-------\\n`_cache_invalid` |  \u6307\u793a\u4e0e\u7ed9\u5b9a\u7f13\u5b58\u6807\u8bc6\u7b26\u5bf9\u5e94\u7684\u5b8c\u6210\u7f13\u5b58\u662f\u5426\u9700\u8981\u91cd\u5efa\\n`_retrieve_cache` | \u4ece\u7f13\u5b58\u6587\u4ef6\u4e2d\u68c0\u7d22\u5b8c\u6210\u4fe1\u606f\\n`_store_cache` |    \u5728\u7f13\u5b58\u6587\u4ef6\u4e2d\u5b58\u50a8\u4e0e\u7ed9\u5b9a\u7f13\u5b58\u6807\u8bc6\u7b26\u76f8\u5bf9\u5e94\u7684\u5b8c\u6210\\n\\n**\u5176\u4ed6\u529f\u80fd**\\n\\n\u51fd\u6570 | \u8bf4\u660e\\n-----|-------\\n`_message` |     \u7528\u4e8e\u5728\u65e0\u6cd5\u751f\u6210\u5b8c\u6210\u7684\u5730\u65b9\u663e\u793a\u5e2e\u52a9\u6d88\u606f\u3002\\n`_regex_words` |    \u53ef\u7528\u4e8e\u4e3a `_regex_arguments` \u547d\u4ee4\u751f\u6210\u53c2\u6570\u3002\u8fd9\u6bd4\u624b\u52a8\u7f16\u5199\u53c2\u6570\u66f4\u5bb9\u6613\u3002\\n`_guard` |     \u53ef\u7528\u4e8e `_arguments` \u7684\u89c4\u8303\u7684 `ACTION` \u548c\u7c7b\u4f3c\u51fd\u6570\u6765\u68c0\u67e5\u6b63\u5728\u5b8c\u6210\u7684\u5355\u8bcd\u3002\\n\\n**\u52a8\u4f5c Action**\\n\\n\u8bb8\u591a\u5b9e\u7528\u51fd\u6570\uff0c\u4f8b\u5982 `_arguments` `_regex_arguments` `_alternative` \u548c `_values` \u53ef\u80fd\u5728\u9009\u9879/\u53c2\u6570\u89c4\u8303\u7684\u672b\u5c3e\u5305\u542b\u4e00\u4e2a\u52a8\u4f5c\u3002\u6b64\u52a8\u4f5c\u6307\u793a\u5982\u4f55\u5b8c\u6210\u76f8\u5e94\u7684\u53c2\u6570\u3002\u52a8\u4f5c `Action` \u53ef\u4ee5\u91c7\u7528\u4ee5\u4e0b\u5f62\u5f0f\u4e4b\u4e00\uff1a\\n\\n\u51fd\u6570 | \u8bf4\u660e\\n-----|-------\\n`()` | \u9700\u8981\u53c2\u6570\uff0c\u4f46\u4e0d\u4f1a\u751f\u6210\u5339\u914d\u9879\u3002\\n`(ITEM1 ITEM2)` |\\t\u53ef\u80fd\u5339\u914d\u9879\u5217\u8868\\n`((ITEM1\\\\:\'DESC1\' ITEM2\\\\:\'DESC2\'))`\\t| \u53ef\u80fd\u7684\u5339\u914d\u5217\u8868\uff0c\u9644\u5e26\u63cf\u8ff0\u4fe1\u606f\u3002\u6ce8\u610f\uff1aAction \u4e2d\u7684\u5f15\u53f7\u4e0d\u80fd\u548c\u5176\u6240\u5728\u7684\u53c2\u6570\u683c\u5f0f\u5b57\u7b26\u4e32\u7684\u5f15\u53f7\u76f8\u540c\\n`->STRING` |  \u5c06`$state`\u8bbe\u7f6e\u4e3a\u5b57\u7b26\u4e32\u5e76\u7ee7\u7eed\uff08`$state`\u53ef\u5728\u5b9e\u7528\u529f\u80fd\u8c03\u7528\u540e\u5728\u6848\u4f8b\u9648\u8ff0\u4e2d\u68c0\u67e5\uff09\\n`FUNCTION` |  \u7528\u4e8e\u751f\u6210\u5339\u914d\u6216\u6267\u884c\u67d0\u4e9b\u5176\u4ed6\u64cd\u4f5c\u7684\u51fd\u6570\u540d\u79f0. \u4f8b\u5982 `_files` \u6216 `_message`\\n`{EVAL-STRING}` |\\t\u5c06\u5b57\u7b26\u4e32\u8bc4\u4f30\u4e3a shell \u4ee3\u7801\u4ee5\u751f\u6210\u5339\u914d\u9879\u3002\u8fd9\u53ef\u7528\u4e8e\u8c03\u7528\u5e26\u6709\u53c2\u6570\u7684\u5b9e\u7528\u7a0b\u5e8f\u51fd\u6570\uff0c\u4f8b\u5982 `_values` \u6216 `_describe`\\n`=ACTION` |\\t\u5728\u5b8c\u6210\u547d\u4ee4\u884c\u4e2d\u63d2\u5165\u4e00\u4e2a\u865a\u62df\u8bcd\u800c\u4e14\u4e0d\u4f1a\u6539\u53d8\u8865\u5168\u4f4d\u7f6e\u8282\u70b9\\n\\n\u5e76\u975e\u6240\u6709\u64cd\u4f5c\u7c7b\u578b\u90fd\u53ef\u7528\u4e8e\u4f7f\u7528\u5b83\u4eec\u7684\u6240\u6709\u5b9e\u7528\u529f\u80fd\u3002\u4f8b\u5982\uff0c->string \u7c7b\u578b\u5728_regex_arguments\u6216_alternative\u529f\u80fd\u4e2d\u4e0d\u53ef\u7528\u3002\\n\\n### \u4f7f\u7528 _describe \u7f16\u5199\u7b80\u5355\u7684\u5b8c\u6210\u51fd\u6570\\n\\n`_describe` \u51fd\u6570\u53ef\u7528\u4e8e\u7b80\u5355\u7684\u8865\u5168\uff0c\u5176\u4e2d\u9009\u9879/\u53c2\u6570\u7684\u987a\u5e8f\u548c\u4f4d\u7f6e\u5e76\u4e0d\u91cd\u8981\u3002\u60a8\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u6570\u7ec4\u53c2\u6570\u6765\u4fdd\u5b58\u9009\u9879\u53ca\u5176\u63cf\u8ff0\uff0c\u7136\u540e\u5c06\u53c2\u6570\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9 `_describe`\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u521b\u5efa\u5b8c\u6210\u5019\u9009 c \u548c d\uff0c\u4ee5\u53ca\u63cf\u8ff0\uff08\u6ce8\u610f\u8fd9\u5e94\u8be5\u653e\u5728 `$fpath` \u4e2d\u5217\u51fa\u7684\u67d0\u4e2a\u76ee\u5f55\u4e2d\u540d\u4e3a `_cmd` \u7684\u6587\u4ef6\u4e2d\uff09\u3002\\n\\n```bash\\n#compdef cmd\\nlocal -a subcmds\\nsubcmds=(\'c:description for c command\' \'d:description for d command\')\\n_describe \'command\' subcmds\\n```\\n\\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u7531\u53cc\u8fde\u5b57\u7b26\u5206\u9694\u7684\u591a\u4e2a\u4e0d\u540c\u5217\u8868\uff0c\u4f46\u8bf7\u6ce8\u610f\uff0c\u8fd9\u6df7\u5408\u4e86\u5355\u4e2a\u6807\u9898\u4e0b\u7684\u5339\u914d\u9879\uff0c\u5e76\u4e14\u4e0d\u6253\u7b97\u4e0e\u4e0d\u540c\u7c7b\u578b\u7684\u5b8c\u6210\u5019\u9009\u8005\u4e00\u8d77\u4f7f\u7528\uff1a\\n\\n```bash\\nlocal -a subcmds topics\\nsubcmds=(\'c:description for c command\' \'d:description for d command\')\\ntopics=(\'e:description for e help topic\' \'f:description for f help topic\')\\n_describe \'command\' subcmds -- topics\\n\\n```\\n\\n\u5982\u679c\u4e24\u4e2a\u5019\u9009\u4eba\u6709\u76f8\u540c\u7684\u63cf\u8ff0\uff0c`_describe` \u5c06\u5b83\u4eec\u6536\u96c6\u5728\u540c\u4e00\u884c\u4e2d\uff0c\u5e76\u786e\u4fdd\u63cf\u8ff0\u5728\u5217\u4e2d\u6574\u9f50\u5bf9\u9f50\u3002`_describe` \u51fd\u6570\u53ef\u4ee5\u5728 `ACTION` \u4e2d\u7528\u4f5c `_alternative`\u3001`_arguments` \u6216 `_regex_arguments` \u89c4\u8303\u7684\u4e00\u90e8\u5206\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u5fc5\u987b\u5c06\u5b83\u7684\u53c2\u6570\u653e\u5728\u5927\u62ec\u53f7\u4e2d\uff0c\u4f8b\u5982 `\'TAG:DESCRIPTION:{_describe \'values\' options}\'`\\n\\n### \u4f7f\u7528 _alternative \u7f16\u5199\u5b8c\u6210\u51fd\u6570\\n\\n\u4e0e `_describe` \u4e00\u6837\uff0c\u6b64\u51fd\u6570\u6267\u884c\u7b80\u5355\u7684\u8865\u5168\uff0c\u5176\u4e2d\u9009\u9879/\u53c2\u6570\u7684\u987a\u5e8f\u548c\u4f4d\u7f6e\u5e76\u4e0d\u91cd\u8981\u3002\u7136\u800c\uff0c\u4e0e _describe \u4e0d\u540c\u7684\u662f\uff0c\u53ef\u4ee5\u8c03\u7528\u5176\u4ed6\u51fd\u6570\u800c\u4e0d\u662f\u56fa\u5b9a\u5339\u914d\u6765\u751f\u6210\u5b8c\u6210\u5019\u9009\u3002\u6b64\u5916\uff0c_alternative \u5141\u8bb8\u6df7\u5408\u4e0d\u540c\u7c7b\u578b\u7684\u5b8c\u6210\u5019\u9009\u3002\\n\\n\u4f5c\u4e3a\u53c2\u6570\uff0c\u5b83\u91c7\u7528 `\'TAG:DESCRIPTION:ACTION\'` \u5f62\u5f0f\u7684\u89c4\u8303\u5217\u8868\uff0c\u5176\u4e2d TAG \u662f\u6807\u8bc6\u5b8c\u6210\u5339\u914d\u7c7b\u578b\u7684\u7279\u6b8a\u6807\u7b7e\uff0cDESCRIPTION \u7528\u4f5c\u6807\u9898\u6765\u5171\u540c\u63cf\u8ff0\u5b8c\u6210\u5019\u9009\u7ec4\uff0c\u800c ACTION\u662f\u524d\u9762\u5217\u51fa\u7684\u52a8\u4f5c\u7c7b\u578b\u4e4b\u4e00\uff08\u9664\u4e86 `->STRING` \u548c `=ACTION` \u5f62\u5f0f\uff09\u3002\u4f8b\u5982\uff1a\\n\\n```bash\\n_alternative \'arguments:custom arg:(a b c)\' \'files:filename:_files\'\\n```\\n\\n\u7b2c\u4e00\u4e2a\u89c4\u8303\u6dfb\u52a0\u5b8c\u6210\u5019\u9009 a\u3001b \u548c c\uff0c\u7b2c\u4e8c\u4e2a\u89c4\u8303\u8c03\u7528 `_files` \u51fd\u6570\u6765\u5b8c\u6210\u6587\u4ef6\u8def\u5f84\u3002\\n\\n\u6211\u4eec\u53ef\u4ee5\u7528 `\\\\` \u5c06\u89c4\u8303\u5206\u6210\u51e0\u884c\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u81ea\u5b9a\u4e49\u53c2\u6570\u6dfb\u52a0\u63cf\u8ff0\uff0c\u5982\u4e0b\u6240\u793a\uff1a\\n\\n\\n```bash\\n_alternative \\\\\\n  \'args:custom arg:((a\\\\:\\"description a\\" b\\\\:\\"description b\\" c\\\\:\\"description c\\"))\' \\\\\\n  \'files:filename:_files\'\\n```\\n\\n\u5982\u679c\u6211\u4eec\u60f3\u5c06\u53c2\u6570\u4f20\u9012\u7ed9 `_files`\uff0c\u5b83\u4eec\u53ef\u4ee5\u7b80\u5355\u5730\u5305\u542b\u5728\u5185\uff0c\u5982\u4e0b\u6240\u793a\uff1a\\n\\n\\n```bash\\n_alternative \\\\\\n  \'args:custom arg:((a\\\\:\\"description a\\" b\\\\:\\"description b\\" c\\\\:\\"description c\\"))\'\\\\\\n  \'files:filename:_files -/\'\\n```\\n\\n\u8981\u4f7f\u7528\u53c2\u6570\u6269\u5c55\u6765\u521b\u5efa\u6211\u4eec\u7684\u5b8c\u6210\u5217\u8868\uff0c\u6211\u4eec\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7\u6765\u5f15\u7528\u89c4\u8303\uff0c\u4f8b\u5982\uff1a\\n\\n```bash\\n_alternative \\\\\\n  \\"dirs:user directory:($userdirs)\\" \\\\\\n  \\"pids:process ID:($(ps -A o pid=))\\"\\n```\\n\\n\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7b2c\u4e00\u4e2a\u89c4\u8303\u6dfb\u52a0\u5b58\u50a8\u5728 `$userdirs` \u53d8\u91cf\u4e2d\u7684\u5355\u8bcd\uff0c\u7b2c\u4e8c\u4e2a\u89c4\u8303\u8bc4\u4f30 `\'ps -A o pid=\'` \u4ee5\u83b7\u53d6\u7528\u4f5c\u5b8c\u6210\u5019\u9009\u7684 pid \u5217\u8868\u3002\u5728\u5b9e\u8df5\u4e2d\uff0c\u6211\u4eec\u4f1a\u4e3a\u6b64\u4f7f\u7528\u73b0\u6709\u7684 `_pids` \u51fd\u6570\u3002\\n\\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5b9e\u7528\u51fd\u6570\uff0c\u4f8b\u5982 ACTION \u4e2d\u7684 `_values` \u6765\u6267\u884c\u66f4\u590d\u6742\u7684\u5b8c\u6210\uff0c\u4f8b\u5982\uff1a\\n\\n```bash\\n_alternative \\\\\\n  \\"directories:user directory:($userdirs)\\" \\\\\\n  \'options:comma-separated opt: _values -s , letter a b c\'\\n\\n```\\n\\n\u8fd9\u5c06\u5b8c\u6210 `$userdirs` \u4e2d\u7684\u9879\u76ee\uff0c\u4ee5\u53ca\u5305\u542b `a, b &/or c` \u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u6ce8\u610f `_values` \u4e4b\u524d\u7684\u521d\u59cb\u7a7a\u683c\u7684\u4f7f\u7528\u3002\u8fd9\u662f\u5fc5\u9700\u7684\uff0c\u56e0\u4e3a `_values` \u4e0d\u7406\u89e3\u7528\u4e8e\u63cf\u8ff0\u7684\u6807\u51c6 compadd \u9009\u9879\u3002\\n\\n\u4e0e `_describe` \u4e00\u6837\uff0c`_alternative` \u51fd\u6570\u672c\u8eab\u53ef\u4ee5\u4f5c\u4e3a `_arguments` \u6216 `_regex_arguments` \u89c4\u8303\u7684\u4e00\u90e8\u5206\u5728 `ACTION` \u4e2d\u4f7f\u7528\u3002\\n\\n### \u4f7f\u7528 _arguments \u7f16\u5199\u5b8c\u6210\u51fd\u6570\\n\\n\u901a\u8fc7\u5bf9 _arguments \u51fd\u6570\u7684\u4e00\u6b21\u8c03\u7528\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u76f8\u5f53\u590d\u6742\u7684\u5b8c\u6210\u51fd\u6570\u3002\u5b83\u65e8\u5728\u5904\u7406\u5e26\u6709\u5404\u79cd\u9009\u9879\u548c\u4e00\u4e9b\u666e\u901a\u53c2\u6570\u7684\u5178\u578b\u547d\u4ee4\u3002\u4e0e _alternative \u51fd\u6570\u4e00\u6837\uff0c_arguments \u5c06\u89c4\u8303\u5b57\u7b26\u4e32\u5217\u8868\u4f5c\u4e3a\u53c2\u6570\u3002\u8fd9\u4e9b\u89c4\u8303\u5b57\u7b26\u4e32\u6307\u5b9a\u9009\u9879\u548c\u4efb\u4f55\u76f8\u5e94\u7684\u9009\u9879\u53c2\u6570\uff08\u4f8b\u5982 -f \u6587\u4ef6\u540d\uff09\u6216\u547d\u4ee4\u53c2\u6570\u3002\\n\\n\u57fa\u672c\u9009\u9879\u89c4\u8303\u91c7\u7528 `\'-OPT[DESCRIPTION]\'` \u7684\u5f62\u5f0f\uff0c\u4f8b\u5982\uff1a\\n\\n```bash\\n# sort output: \u6392\u5e8f\u8f93\u51fa\\n# long output: \u957f\u8f93\u51fa\\n_arguments \'-s[sort output]\' \'--l[long output]\' \'-l[long output]\'\\n```\\n\\n\u53ef\u4ee5\u5728 `\'-OPT[DESCRIPTION]:MESSAGE:ACTION\'` \u5f62\u5f0f\u7684\u9009\u9879\u63cf\u8ff0\u4e4b\u540e\u6307\u5b9a\u9009\u9879\u7684\u53c2\u6570\uff0c\u5176\u4e2d MESSAGE \u662f\u8981\u663e\u793a\u7684\u6d88\u606f\uff0c\u800c ACTION \u53ef\u4ee5\u662f\u4e0a\u9762 ACTIONS \u90e8\u5206\u4e2d\u63d0\u5230\u7684\u4efb\u4f55\u5f62\u5f0f\u3002\u4f8b\u5982\uff1a\\n\\n```bash\\n_arguments \'-f[input file]:filename:_files\'\\n```\\n\\n\u547d\u4ee4\u53c2\u6570\u89c4\u8303\u91c7\u7528 `\'N:MESSAGE:ACTION\'` \u5f62\u5f0f\uff0c\u5176\u4e2d `N` \u8868\u793a\u5b83\u662f\u7b2c `N` \u4e2a\u547d\u4ee4\u53c2\u6570\uff0c\u800c `MESSAGE & ACTION` \u548c\u4ee5\u524d\u4e00\u6837\u3002\u5982\u679c\u7701\u7565 N\uff0c\u5219\u5b83\u4ec5\u8868\u793a\u4e0b\u4e00\u4e2a\u547d\u4ee4\u53c2\u6570\uff08\u5728\u4efb\u4f55\u5df2\u6307\u5b9a\u7684\u53c2\u6570\u4e4b\u540e\uff09\u3002\u5982\u679c\u5728\u5f00\u5934\uff08\u5728 `N` \u4e4b\u540e\uff09\u4f7f\u7528 _\u53cc\u5192\u53f7_\uff0c\u5219\u8be5\u53c2\u6570\u662f\u53ef\u9009\u7684\u3002\u4f8b\u5982\uff1a\\n\\n```bash\\n_arguments \'-s[sort output]\' \'1:first arg:_net_interfaces\' \'::optional arg:_files\' \':next arg:(a b c)\'\\n```\\n\\n\u8fd9\u91cc\u7b2c\u4e00\u4e2a arg \u662f\u7f51\u7edc\u63a5\u53e3\uff0c\u4e0b\u4e00\u4e2a\u53ef\u9009 `arg` \u662f\u6587\u4ef6\u540d\uff0c\u6700\u540e\u4e00\u4e2a `arg` \u53ef\u4ee5\u662f a\u3001b \u6216 c\uff0c\u5e76\u4e14 `-s` \u9009\u9879\u53ef\u4ee5\u5728\u4efb\u4f55\u4f4d\u7f6e\u5b8c\u6210\u3002\\n\\n`_arguments` \u51fd\u6570\u5141\u8bb8\u4f7f\u7528\u4e0a\u9762 `ACTION` \u90e8\u5206\u4e2d\u5217\u51fa\u7684\u5168\u5957 ACTION \u8868\u5355\u3002\u8fd9\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u6765\u9009\u62e9 `case` \u8bed\u53e5\u5206\u652f\uff0c\u5982\u4e0b\u6240\u793a\uff1a\\n\\n```bash\\n_arguments \'-m[music file]:filename:->files\' \'-f[flags]:flag:->flags\'\\ncase \\"$state\\" in\\n    files)\\n        local -a music_files\\n        music_files=( Music/**/*.{mp3,wav,flac,ogg} )\\n        _multi_parts / music_files\\n        ;;\\n    flags)\\n        _values -s , \'flags\' a b c d e\\n        ;;\\nesac\\n```\\n\\n\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u97f3\u4e50\u6587\u4ef6(music_files)\u7684\u8def\u5f84\u4f7f\u7528 `_multi_parts` \u51fd\u6570\u9010\u6b65\u964d\u5e8f\u5b8c\u6210\uff0c\u6807\u5fd7\u4f7f\u7528 `_values` \u51fd\u6570\u4f5c\u4e3a\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\u5b8c\u6210\u3002\\n\\n\u6211\u8fd9\u91cc\u521a\u521a\u7ed9\u4f60\u4ecb\u7ecd\u4e86 `_arguments` \u89c4\u8303\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u4f60\u8fd8\u53ef\u4ee5\u6307\u5b9a\u4e92\u65a5\u9009\u9879\u3001\u91cd\u590d\u9009\u9879&\u53c2\u6570\u3001\u4ee5+\u5f00\u5934\u7684\u9009\u9879\u800c\u4e0d\u662f-\u7b49\uff0c\u66f4\u591a\u7ec6\u8282\u53c2\u89c1[\u5b98\u65b9\u6587\u6863](http://zsh.sourceforge.net/Doc/Release/Completion-System.html#Completion-System)\u3002\\n\u53e6\u8bf7\u67e5\u770b\u672c\u6587\u6863\u672b\u5c3e\u63d0\u5230\u7684\u6559\u7a0b\uff0c\u4ee5\u53ca[src \u76ee\u5f55](https://github.com/vapniks/zsh-completions/tree/master/src)\u4e2d\u7684\u5b8c\u6210\u529f\u80fd\u3002\\n\\n## \u6d4b\u8bd5\u4e0e\u8c03\u8bd5\\n\\n\u8981\u91cd\u65b0\u52a0\u8f7d\u5b8c\u6210\u529f\u80fd\uff1a\\n\\n```bash\\n> unfunction _func\\n> autoload -U _func\\n```\\n\\n\u53ef\u4ee5\u8c03\u7528\u4ee5\u4e0b\u51fd\u6570\u6765\u83b7\u53d6\u6709\u7528\u7684\u4fe1\u606f\u3002\u5982\u679c\u9ed8\u8ba4\u952e\u7ed1\u5b9a\u4e0d\u8d77\u4f5c\u7528\uff0c\u60a8\u53ef\u4ee5\u5c1d\u8bd5\u6309 `Alt+x`\uff0c\u7136\u540e\u8f93\u5165\u547d\u4ee4\u540d\u79f0\u3002\\n\\n\u529f\u80fd |\\t\u9ed8\u8ba4\u952e\u7ed1\u5b9a |\\t\u63cf\u8ff0\\n-----|------------|-----------\\n`_complete_help`\\t| `Ctrl+xh` |\\t\u663e\u793a\u6709\u5173\u5728\u5f53\u524d\u5149\u6807\u4f4d\u7f6e\u5b8c\u6210\u65f6\u4f7f\u7528\u7684\u4e0a\u4e0b\u6587\u540d\u79f0\u3001\u6807\u7b7e\u548c\u5b8c\u6210\u51fd\u6570\u7684\u4fe1\u606f\\n`_complete_help` |\\t`Alt+2 Ctrl+xh` |\\t\u5982\u4e0a\u6240\u8ff0\uff0c\u4f46\u663e\u793a\u66f4\u591a\u4fe1\u606f\\n`_complete_debug` |\\t`Ctrl+x ?`\\t| \u6267\u884c\u666e\u901a\u5b8c\u6210\uff0c\u4f46\u5728\u4e34\u65f6\u6587\u4ef6\u4e2d\u6355\u83b7\u5b8c\u6210\u7cfb\u7edf\u6267\u884c\u7684 shell \u547d\u4ee4\u7684\u8ddf\u8e2a\\n\\n## \u9677\u9631\uff08\u6ce8\u610f\u4e8b\u9879\uff09\\n\\n\u8bf7\u8bb0\u4f4f\u5728\u5305\u542b\u5b8c\u6210\u51fd\u6570\u7684\u6587\u4ef6\u7684\u5f00\u5934\u5305\u542b `#compdef` \u884c\u3002\\n\\n\u6ce8\u610f\u5bf9 `_arguments` \u6216 `_regex_arguments` \u7684\u89c4\u8303\u4f7f\u7528\u6b63\u786e\u7684\u5f15\u7528\u7c7b\u578b\uff1a\u5982\u679c\u89c4\u8303\u4e2d\u5b58\u5728\u9700\u8981\u6269\u5c55\u7684\u53c2\u6570\uff0c\u8bf7\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u5426\u5219\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u5e76\u786e\u4fdd\u5728\u9879\u76ee\u63cf\u8ff0\u5468\u56f4\u4f7f\u7528\u4e0d\u540c\u7684\u5f15\u53f7\u3002\\n\\n\u68c0\u67e5\u60a8\u5728 `_arguments` \u3001`_alternative` \u3001 `_regex_arguments` \u7b49\u89c4\u8303\u7684\u6b63\u786e\u4f4d\u7f6e\u662f\u5426\u6709\u6b63\u786e\u6570\u91cf\u7684 `:`\u3002\\n\\n\u8bb0\u4f4f\u5728\u4f7f\u7528 `_regex_arguments` \u65f6\u5305\u542b\u4e00\u4e2a\u521d\u59cb\u6a21\u5f0f\u6765\u5339\u914d\u547d\u4ee4\u8bcd\uff08\u5b83\u4e0d\u9700\u8981\u5339\u914d\u64cd\u4f5c\uff09\u3002\\n\\n\u8bf7\u8bb0\u4f4f\u5728 `_regex_arguments` \u7684\u4efb\u4f55 `PATTERN` \u53c2\u6570\u7684\u672b\u5c3e\u653e\u7f6e\u4e00\u4e2a\u7a7a\u5b57\u7b26 `$\'\\\\0\'`\\n\\n## \u63d0\u793a\\n\\n\u6709\u65f6\u4f60\u4f1a\u9047\u5230\u8fd9\u6837\u7684\u60c5\u51b5\uff0c\u5728\u5b50\u547d\u4ee4\u4e4b\u540e\u53ea\u6709\u4e00\u4e2a\u9009\u9879\uff0c\u5f53\u5728\u5b50\u547d\u4ee4\u4e4b\u540e\u6309\u4e0b tab \u65f6\uff0czsh \u4f1a\u81ea\u52a8\u5b8c\u6210\u8fd9\u4e2a\u3002\u76f8\u53cd\uff0c\u5982\u679c\u60a8\u5e0c\u671b\u5728\u5b8c\u6210\u4e4b\u524d\u5c06\u5176\u4e0e\u5176\u63cf\u8ff0\u4e00\u8d77\u5217\u51fa\uff0c\u60a8\u53ef\u4ee5\u5411 `ACTION` \u6dfb\u52a0\u53e6\u4e00\u4e2a\u7a7a\u9009\u9879\uff08\u5373 `\\\\:`\uff09\uff0c\u5982\u4e0b\u6240\u793a `\':TAG:DESCRIPTION:((opt1\\\\:\u201ddescription for opt1\u201d \\\\:))\'` \u8bf7\u6ce8\u610f\u8fd9\u4e00\u70b9\u4ec5\u9002\u7528\u4e8e\u5728\u5176\u89c4\u8303\u53c2\u6570\uff08`_arguments`\u3001`_regex_arguments` \u7b49\uff09\u4e2d\u4f7f\u7528 `ACTION` \u7684\u5b9e\u7528\u7a0b\u5e8f\u51fd\u6570\\n\\n\\n> \u672c\u6587\u7ffb\u8bd1\u81ea [zsh-users/zsh-completions](https://github.com/zsh-users/zsh-completions/blob/master/zsh-completions-howto.org)\\n\\n> TIP: \u66f4\u5b8c\u6574\u7684\u7ffb\u8bd1\u6587\u7ae0\u53c2\u770b http://chuquan.me/2020/10/02/zsh-completion-tutorial/"},{"id":"simple-use-color-in-shell","metadata":{"permalink":"/blog/simple-use-color-in-shell","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2019/11-08-simple-use-color-shell.md","source":"@site/blog/2019/11-08-simple-use-color-shell.md","title":"\u5728shell\u811a\u672c\u91cc\u7b80\u5355\u5feb\u901f\u7684\u4f7f\u7528\u989c\u8272","description":"\u5728shell\u811a\u672c\u91cc\u7b80\u5355\u5feb\u901f\u7684\u4f7f\u7528\u989c\u8272\u7684\u4ee3\u7801\u5b9e\u73b0","date":"2019-11-08T22:04:00.000Z","formattedDate":"2019\u5e7411\u67088\u65e5","tags":[{"label":"shell","permalink":"/blog/tags/shell"},{"label":"bash","permalink":"/blog/tags/bash"},{"label":"linux","permalink":"/blog/tags/linux"},{"label":"cli-color","permalink":"/blog/tags/cli-color"}],"readingTime":1.2,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u5728shell\u811a\u672c\u91cc\u7b80\u5355\u5feb\u901f\u7684\u4f7f\u7528\u989c\u8272","authors":"inhere","tags":["shell","bash","linux","cli-color"],"date":"2019-11-08T22:04","slug":"simple-use-color-in-shell"},"prevItem":{"title":"ZSH\u81ea\u52a8\u8865\u5168\u811a\u672c\u7f16\u5199","permalink":"/blog/2021/07/28/zsh-completions-howto"},"nextItem":{"title":"Long Blog Post","permalink":"/blog/long-blog-post"}},"content":"\u5728shell\u811a\u672c\u91cc\u7b80\u5355\u5feb\u901f\u7684\u4f7f\u7528\u989c\u8272\u7684\u4ee3\u7801\u5b9e\u73b0\\n\\n\x3c!--truncate--\x3e\\n\\n## \u811a\u672c\u4ee3\u7801\\n\\n```bash\\n#!/usr/bin/env bash\\n#\\n# some common functions\\n# file: scripts/common-func.sh\\n\\n# Usage:\\n# user_confirm\\n# user_confirm \\"custom question\\"\\nfunction user_confirm() {\\n    local yes=0\\n    local msg=\\"Confirm continue\\"\\n\\n    # override default message\\n    [[ \\"$1\\" != \\"\\" ]] && msg=$1\\n\\n    # read user input\\n    read -p \\"$msg? [y/n]\\" yn\\n\\n    if [[ ${yn} == [Yy]* ]]; then\\n        return 0\\n    fi\\n\\n    return 1\\n}\\n\\n# Usage:\\n# colored_text \\"message text\\"\\n# colored_text \\"message text\\" \\"red\\"\\n# colored_text \\"message text\\" \\"blue\\"\\nfunction colored_text() {\\n    NOC=\'\\\\033[0m\' # No Color\\n    RED=\'\\\\033[0;31m\'\\n    BLUE=\'\\\\033[0;34m\'\\n    CYAN=\'\\\\033[0;36m\'\\n    GREEN=\'\\\\033[0;32m\'\\n    YELLOW=\'\\\\033[0;33m\'\\n\\n#    [[ \\"$2\\" = \\"\\" ]] && $2=\\"green\\"\\n\\n    if [[ \\"$2\\" = \\"red\\" ]]; then\\n        echo -e \\"${RED}$1${NOC}\\"\\n    elif [[ \\"$2\\" = \\"blue\\" ]]; then\\n        echo -e \\"${BLUE}$1${NOC}\\"\\n    elif [[ \\"$2\\" = \\"cyan\\" ]]; then\\n        echo -e \\"${CYAN}$1${NOC}\\"\\n    elif [[ \\"$2\\" = \\"yellow\\" ]]; then\\n        echo -e \\"${YELLOW}$1${NOC}\\"\\n    else # default green\\n        echo -e \\"${GREEN}$1${NOC}\\"\\n    fi\\n}\\n\\n# quick use color print text\\nfunction red_text() {\\n    colored_text \\"$1\\" red\\n}\\n\\nfunction blue_text() {\\n    colored_text \\"$1\\" blue\\n}\\n\\nfunction cyan_text() {\\n    colored_text \\"$1\\" cyan\\n}\\n\\nfunction green_text() {\\n    colored_text \\"$1\\" green\\n}\\n\\nfunction yellow_text() {\\n    colored_text \\"$1\\" yellow\\n}\\n```\\n\\n## \u5728\u5176\u4ed6\u811a\u672c\u5f15\u5165\\n\\n```bash\\n# import common functions\\nsource \\"$(dirname $0)/scripts/common-func.sh\\"\\n\\ncolored_text \\"Will test components:\\"\\n\\n# do something ...\\n\\ncyan_text \\"\\\\nTest Completed!\\"\\n```"},{"id":"long-blog-post","metadata":{"permalink":"/blog/long-blog-post","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2019-05-29-long-blog-post.md","source":"@site/blog/2019-05-29-long-blog-post.md","title":"Long Blog Post","description":"This is the summary of a very long blog post,","date":"2019-05-29T00:00:00.000Z","formattedDate":"2019\u5e745\u670829\u65e5","tags":[{"label":"hello","permalink":"/blog/tags/hello"},{"label":"docusaurus","permalink":"/blog/tags/docusaurus"}],"readingTime":2.05,"hasTruncateMarker":true,"authors":[{"name":"Endilie Yacop Sucipto","title":"Maintainer of Docusaurus","url":"https://github.com/endiliey","imageURL":"https://github.com/endiliey.png","key":"endi"}],"frontMatter":{"slug":"long-blog-post","title":"Long Blog Post","authors":"endi","tags":["hello","docusaurus"]},"prevItem":{"title":"\u5728shell\u811a\u672c\u91cc\u7b80\u5355\u5feb\u901f\u7684\u4f7f\u7528\u989c\u8272","permalink":"/blog/simple-use-color-in-shell"},"nextItem":{"title":"First Blog Post","permalink":"/blog/first-blog-post"}},"content":"This is the summary of a very long blog post,\\n\\nUse a `\x3c!--` `truncate` `--\x3e` comment to limit blog post size in the list view.\\n\\n\x3c!--truncate--\x3e\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet"},{"id":"first-blog-post","metadata":{"permalink":"/blog/first-blog-post","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2019-05-28-first-blog-post.md","source":"@site/blog/2019-05-28-first-blog-post.md","title":"First Blog Post","description":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet","date":"2019-05-28T00:00:00.000Z","formattedDate":"2019\u5e745\u670828\u65e5","tags":[{"label":"hola","permalink":"/blog/tags/hola"},{"label":"docusaurus","permalink":"/blog/tags/docusaurus"}],"readingTime":0.12,"hasTruncateMarker":false,"authors":[{"name":"Gao Wei","title":"Docusaurus Core Team","url":"https://github.com/wgao19","image_url":"https://github.com/wgao19.png","imageURL":"https://github.com/wgao19.png"}],"frontMatter":{"slug":"first-blog-post","title":"First Blog Post","authors":{"name":"Gao Wei","title":"Docusaurus Core Team","url":"https://github.com/wgao19","image_url":"https://github.com/wgao19.png","imageURL":"https://github.com/wgao19.png"},"tags":["hola","docusaurus"]},"prevItem":{"title":"Long Blog Post","permalink":"/blog/long-blog-post"},"nextItem":{"title":"\u7ed9http.Handler\u5305\u88c5\u4e2d\u95f4\u4ef6","permalink":"/blog/wrap-middleware-for-http-handler-in-golang"}},"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet"},{"id":"wrap-middleware-for-http-handler-in-golang","metadata":{"permalink":"/blog/wrap-middleware-for-http-handler-in-golang","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2018/08-10-wrap-middleware-for-http-handler.md","source":"@site/blog/2018/08-10-wrap-middleware-for-http-handler.md","title":"\u7ed9http.Handler\u5305\u88c5\u4e2d\u95f4\u4ef6","description":"Golang \u4e0b\u7ed9 http.Handler \u5305\u88c5\u4e2d\u95f4\u4ef6","date":"2018-08-10T22:00:00.000Z","formattedDate":"2018\u5e748\u670810\u65e5","tags":[{"label":"golang","permalink":"/blog/tags/golang"},{"label":"http","permalink":"/blog/tags/http"}],"readingTime":0.69,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u7ed9http.Handler\u5305\u88c5\u4e2d\u95f4\u4ef6","authors":"inhere","tags":["golang","http"],"date":"2018-08-10T22:00","slug":"wrap-middleware-for-http-handler-in-golang"},"prevItem":{"title":"First Blog Post","permalink":"/blog/first-blog-post"},"nextItem":{"title":"Go \u6355\u83b7 os.Stdout \u7684\u8f93\u51fa","permalink":"/blog/rewrite-os-stdout-in-golang"}},"content":"Golang \u4e0b\u7ed9 http.Handler \u5305\u88c5\u4e2d\u95f4\u4ef6\\n\\n\\n\x3c!--truncate--\x3e\\n\\n```go\\npackage main\\n\\nimport \\"net/http\\"\\n\\nfunc main() {\\n    handler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\\n        w.Write([]byte(\\"-O-\\"))\\n    })\\n\\n    mdl1 := func(h http.Handler) http.Handler {\\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\\n            w.Write([]byte(\\"a\\"))\\n            h.ServeHTTP(w, r)\\n            w.Write([]byte(\\"A\\"))\\n        })\\n    }\\n    mdl2 := func(h http.Handler) http.Handler {\\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\\n            w.Write([]byte(\\"b\\"))\\n            h.ServeHTTP(w, r)\\n            w.Write([]byte(\\"B\\"))\\n        })\\n    }\\n\\n    wrapped := WrapHttpHandlers(handler, mdl1, mdl2)\\n\\n    http.ListenAndServe(\\":8080\\", wrapped)\\n    // Output:\\n    // ab-O-BA\\n}\\n\\n// WrapHttpHandlers apply some pre http handlers for the main handler.\\nfunc WrapHttpHandlers(mainHandler http.Handler, middleware ...func(h http.Handler) http.Handler) http.Handler {\\n    var wrapped http.Handler\\n    max := len(middleware)\\n    lst := make([]int, max)\\n\\n    for i := range lst {\\n        current := max - i - 1\\n        if i == 0 {\\n            wrapped = middleware[current](mainHandler)\\n        } else {\\n            wrapped = middleware[current](wrapped)\\n        }\\n    }\\n\\n    return wrapped\\n}\\n```"},{"id":"rewrite-os-stdout-in-golang","metadata":{"permalink":"/blog/rewrite-os-stdout-in-golang","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2018/08-08-rewrite-os-stdout-in-golang.md","source":"@site/blog/2018/08-08-rewrite-os-stdout-in-golang.md","title":"Go \u6355\u83b7 os.Stdout \u7684\u8f93\u51fa","description":"Go \u91cc\u9762\u6709\u65f6\u5019\u6211\u4eec\u60f3\u6355\u83b7\uff0c\u6216\u8005\u4e22\u5f03\u901a\u8fc7fmt.Print\u7cfb\u5217\u65b9\u6cd5\u6253\u5370\u5230Stdout\u7684\u6570\u636e","date":"2018-08-08T21:00:00.000Z","formattedDate":"2018\u5e748\u67088\u65e5","tags":[{"label":"golang","permalink":"/blog/tags/golang"}],"readingTime":1.705,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"Go \u6355\u83b7 os.Stdout \u7684\u8f93\u51fa","tags":["golang"],"date":"2018-08-08T21:00","slug":"rewrite-os-stdout-in-golang","authors":"inhere"},"prevItem":{"title":"\u7ed9http.Handler\u5305\u88c5\u4e2d\u95f4\u4ef6","permalink":"/blog/wrap-middleware-for-http-handler-in-golang"},"nextItem":{"title":"php\u4e2d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6a21\u5f0f\u4fee\u9970\u7b26","permalink":"/blog/regex-pattern-mode-in-php"}},"content":"Go \u91cc\u9762\u6709\u65f6\u5019\u6211\u4eec\u60f3\u6355\u83b7\uff0c\u6216\u8005\u4e22\u5f03\u901a\u8fc7`fmt.Print`\u7cfb\u5217\u65b9\u6cd5\u6253\u5370\u5230Stdout\u7684\u6570\u636e\\n\\n\\n\x3c!--truncate--\x3e\\n\\n\\n## \u4e22\u5f03\u8f93\u51fa\\n\\n```go\\npackage main\\n\\nimport (\\n    \\"os\\"\\n    \\"fmt\\"\\n)\\n\\nvar oldStdout *os.File\\n\\nfunc main()  {\\n    discardStdout()\\n    fmt.Println(\\"Hello, playground\\")\\n    restoreStdout()\\n    fmt.Println(\\"Hello, playground 2\\")\\n    // Output:\\n    // Hello, playground 2\\n}\\n\\n// usage:\\n// discardStdout()\\n// fmt.Println(\\"Hello, playground\\")\\n// restoreStdout()\\nfunc discardStdout() error {\\n    // save old os.Stdout\\n    oldStdout = os.Stdout\\n\\n    stdout, err := os.OpenFile(os.DevNull, os.O_WRONLY, 0)\\n    if err == nil {\\n        os.Stdout = stdout\\n    }\\n\\n    return err\\n}\\n\\nfunc restoreStdout()  {\\n    if oldStdout != nil {\\n        // close now\\n        os.Stdout.Close()\\n        // restore\\n        os.Stdout = oldStdout\\n        oldStdout = nil\\n    }\\n}\\n```\\n\\n\u8fd0\u884c\u793a\u4f8b\uff0c\u5c06\u53ea\u4f1a\u8f93\u51fa\uff1a `Hello, playground 2`\\n\\n## \u6355\u83b7\u8f93\u51fa\\n\\n- \u6765\u81ea stackoverflow \u7684\u56de\u7b54\\n\\n> from: [stackoverflow](https://stackoverflow.com/questions/10473800/in-go-how-do-i-capture-stdout-of-a-function-into-a-string)\\n\\n```go\\npackage main\\n\\nimport (\\n    \\"os\\"\\n    \\"fmt\\"\\n    \\"io/ioutil\\"\\n)\\n\\nfunc main() {\\n    rescueStdout := os.Stdout\\n    r, w, _ := os.Pipe()\\n    os.Stdout = w\\n\\n    fmt.Println(\\"Hello, playground\\") // this gets captured\\n\\n    w.Close() // Notice: must close before read\\n    out, _ := ioutil.ReadAll(r)\\n    os.Stdout = rescueStdout\\n\\n    fmt.Printf(\\"Captured: %s\\", out) // prints: Captured: Hello, playground\\n}\\n```\\n\\n\u7a0d\u52a0\u8c03\u6574\u4ee5\u65b9\u4fbf\u91cd\u590d\u4f7f\u7528\uff1a\\n\\n```go\\npackage main\\n\\nimport (\\n    \\"os\\"\\n    \\"io/ioutil\\"\\n    \\"fmt\\"\\n)\\n\\nvar oldStdout, newReader *os.File\\n\\nfunc main()  {\\n    rewriteStdout()\\n    fmt.Println(\\"Hello, playground\\")\\n    msg := restoreStdout()\\n\\n    fmt.Print(msg)\\n}\\n\\n// usage:\\n// rewriteStdout()\\n// fmt.Println(\\"Hello, playground\\")\\n// msg := restoreStdout()\\nfunc rewriteStdout()  {\\n    oldStdout = os.Stdout\\n    r, w, _ := os.Pipe()\\n    newReader = r\\n    os.Stdout = w\\n}\\n\\nfunc restoreStdout() string {\\n    if newReader == nil {\\n        return \\"\\"\\n    }\\n\\n    // Notice: must close writer before read data\\n    // close now writer\\n    os.Stdout.Close()\\n    // restore\\n    os.Stdout = oldStdout\\n    oldStdout = nil\\n\\n    // read data\\n    out, _ := ioutil.ReadAll(newReader)\\n\\n    // close reader\\n    newReader.Close()\\n    newReader = nil\\n\\n    return string(out)\\n}\\n```\\n\\n> \u6ce8\u610f\uff1a \u8981\u8bfb\u53d6 `newReader` \u91cc\u7684\u6570\u636e\uff0c\u5fc5\u987b\u5148\u5173\u95ed writer. \u4e0d\u7136\u4f1a\u4e00\u76f4\u963b\u585e\u3002"},{"id":"regex-pattern-mode-in-php","metadata":{"permalink":"/blog/regex-pattern-mode-in-php","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2018/01-03-regex-pattern-mode-in-php.md","source":"@site/blog/2018/01-03-regex-pattern-mode-in-php.md","title":"php\u4e2d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6a21\u5f0f\u4fee\u9970\u7b26","description":"PHP\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u4e2d\u53ef\u7528\u7684\u6a21\u5f0f\u4fee\u9970\u7b26 \u2014 \u6a21\u5f0f\u4fee\u9970\u7b26","date":"2018-01-03T21:04:00.000Z","formattedDate":"2018\u5e741\u67083\u65e5","tags":[{"label":"php","permalink":"/blog/tags/php"},{"label":"regex","permalink":"/blog/tags/regex"}],"readingTime":7.455,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"php\u4e2d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6a21\u5f0f\u4fee\u9970\u7b26","tags":["php","regex"],"date":"2018-01-03T21:04","slug":"regex-pattern-mode-in-php","authors":"inhere"},"prevItem":{"title":"Go \u6355\u83b7 os.Stdout \u7684\u8f93\u51fa","permalink":"/blog/rewrite-os-stdout-in-golang"},"nextItem":{"title":"php \u5b9e\u73b0\u4e00\u4e2a Telnet \u5de5\u5177\u7c7b","permalink":"/blog/implement-a-telnet-tool-in-php"}},"content":"PHP\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u4e2d\u53ef\u7528\u7684\u6a21\u5f0f\u4fee\u9970\u7b26 \u2014 \u6a21\u5f0f\u4fee\u9970\u7b26\\n\\n\x3c!--truncate--\x3e\\n\\n```php\\n$pattern = \'/\\\\{\\\\*.*?\\\\*\\\\}/sm\'\\n                          |\\n                      \u6a21\u5f0f\u4fee\u9970\u7b26\\n```\\n\\n\u4e0b\u9762\u5217\u51fa\u4e86\u5f53\u524d\u53ef\u7528\u7684 PCRE \u4fee\u9970\u7b26\u3002\u62ec\u53f7\u4e2d\u63d0\u5230\u7684\u540d\u5b57\u662f PCRE \u5185\u90e8\u8fd9\u4e9b\u4fee\u9970\u7b26\u7684\u540d\u79f0\u3002 \u6a21\u5f0f\u4fee\u9970\u7b26\u4e2d\u7684\u7a7a\u683c\uff0c\u6362\u884c\u7b26\u4f1a\u88ab\u5ffd\u7565\uff0c\u5176\u4ed6\u5b57\u7b26\u4f1a\u5bfc\u81f4\u9519\u8bef\u3002\\n\\n## i (PCRE_CASELESS)\\n\\n\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u4fee\u9970\u7b26\uff0c\u6a21\u5f0f\u4e2d\u7684\u5b57\u6bcd\u4f1a\u8fdb\u884c**\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u5339\u914d**\u3002\\n\\n## m (PCRE_MULTILINE)\\n\\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cPCRE \u8ba4\u4e3a\u76ee\u6807\u5b57\u7b26\u4e32\u662f\u7531\u5355\u884c\u5b57\u7b26\u7ec4\u6210\u7684(\u7136\u800c\u5b9e\u9645\u4e0a\u5b83\u53ef\u80fd\u4f1a\u5305\u542b\u591a\u884c)\uff0c\\n\\"\u884c\u9996\\"\u5143\u5b57\u7b26 (`^`) \u4ec5\u5339\u914d\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u4f4d\u7f6e\uff0c \u800c\\"\u884c\u672b\\"\u5143\u5b57\u7b26 (`$`) \u4ec5\u5339\u914d\u5b57\u7b26\u4e32\u672b\u5c3e\uff0c \u6216\u8005\u6700\u540e\u7684\u6362\u884c\u7b26(\u9664\u975e\u8bbe\u7f6e\u4e86 `D` \u4fee\u9970\u7b26)\u3002\u8fd9\u4e2a\u884c\u4e3a\u548c perl \u76f8\u540c\u3002\\n\\n\u5f53\u8fd9\u4e2a\u4fee\u9970\u7b26\u8bbe\u7f6e\u4e4b\u540e\uff0c\u201c\u884c\u9996\u201d\u548c\u201c\u884c\u672b\u201d\u5c31\u4f1a\u5339\u914d\u76ee\u6807\u5b57\u7b26\u4e32\u4e2d **\u4efb\u610f\u6362\u884c\u7b26\u4e4b\u524d\u6216\u4e4b\u540e**\uff0c\u53e6\u5916\uff0c \u8fd8\u5206\u522b\u5339\u914d\u76ee\u6807\u5b57\u7b26\u4e32\u7684 **\u6700\u5f00\u59cb\u548c\u6700\u672b\u5c3e**\u4f4d\u7f6e\u3002\\n\\n> \u8fd9\u7b49\u540c\u4e8e perl \u7684 `/m` \u4fee\u9970\u7b26\u3002\u5982\u679c\u76ee\u6807\u5b57\u7b26\u4e32 \u4e2d\u6ca1\u6709 `\\\\n` \u5b57\u7b26\uff0c\u6216\u8005\u6a21\u5f0f\u4e2d\u6ca1\u6709\u51fa\u73b0 `^` \u6216 `$`\uff0c\u8bbe\u7f6e\u8fd9\u4e2a\u4fee\u9970\u7b26\u4e0d\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\u3002\\n\\n## s (PCRE_DOTALL)\\n\\n\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u4fee\u9970\u7b26\uff0c\u6a21\u5f0f\u4e2d\u7684\u70b9\u53f7(`.`)\u5143\u5b57\u7b26\u5339\u914d\u6240\u6709\u5b57\u7b26\uff0c**\u5305\u542b\u6362\u884c\u7b26**\u3002\\n\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u4fee\u9970\u7b26\uff0c\u70b9\u53f7(`.`)\u4e0d\u5339\u914d\u6362\u884c\u7b26\u3002\\n\\n> \u8fd9\u4e2a\u4fee\u9970\u7b26\u7b49\u540c\u4e8e perl \u4e2d\u7684 `/s` \u4fee\u9970\u7b26\u3002 \u4e00\u4e2a\u53d6\u53cd\u5b57\u7b26\u7c7b\u6bd4\u5982 `[^a]` \u603b\u662f\u5339\u914d\u6362\u884c\u7b26\uff0c\u800c\u4e0d\u4f9d\u8d56\u4e8e\u8fd9\u4e2a\u4fee\u9970\u7b26\u7684\u8bbe\u7f6e\u3002\\n\\n## x (PCRE_EXTENDED)\\n\\n\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u4fee\u9970\u7b26\uff0c\u6a21\u5f0f\u4e2d\u7684\u6ca1\u6709\u7ecf\u8fc7\u8f6c\u4e49\u7684\u6216\u4e0d\u5728\u5b57\u7b26\u7c7b\u4e2d\u7684\u7a7a\u767d\u6570\u636e\u5b57\u7b26\u603b\u4f1a\u88ab\u5ffd\u7565\uff0c \\n\u5e76\u4e14\u4f4d\u4e8e\u4e00\u4e2a\u672a\u8f6c\u4e49\u7684\u5b57\u7b26\u7c7b\u5916\u90e8\u7684 `#` \u5b57\u7b26\u548c\u4e0b\u4e00\u4e2a\u6362\u884c\u7b26\u4e4b\u95f4\u7684\u5b57\u7b26\u4e5f\u88ab\u5ffd\u7565\u3002 \\n\\n> \u8fd9\u4e2a\u4fee\u9970\u7b26 \u7b49\u540c\u4e8e perl \u4e2d\u7684 `/x` \u4fee\u9970\u7b26\uff0c\u4f7f\u88ab\u7f16\u8bd1\u6a21\u5f0f\u4e2d\u53ef\u4ee5\u5305\u542b\u6ce8\u91ca\u3002 \\n\\n**\u6ce8\u610f\uff1a**\\n\\n> \u8fd9\u4ec5\u7528\u4e8e\u6570\u636e\u5b57\u7b26\u3002 \u7a7a\u767d\u5b57\u7b26 \u8fd8\u662f\u4e0d\u80fd\u5728\u6a21\u5f0f\u7684\u7279\u6b8a\u5b57\u7b26\u5e8f\u5217\u4e2d\u51fa\u73b0\uff0c\u6bd4\u5982\u5e8f\u5217 `(?(` \u5f15\u5165\u4e86\u4e00\u4e2a\u6761\u4ef6\u5b50\u7ec4 (\u8bd1\u6ce8: \u8fd9\u79cd\u8bed\u6cd5\u5b9a\u4e49\u7684 \u7279\u6b8a\u5b57\u7b26\u5e8f\u5217\u4e2d\u5982\u679c\u51fa\u73b0\u7a7a\u767d\u5b57\u7b26\u4f1a\u5bfc\u81f4\u7f16\u8bd1\u9519\u8bef\u3002 \u6bd4\u5982`(?(`\u5c31\u4f1a\u5bfc\u81f4\u9519\u8bef)\u3002\\n\\n## e (PREG_REPLACE_EVAL)\\n\\n> Warning: This feature was DEPRECATED in PHP 5.5.0, and REMOVED as of PHP 7.0.0.\\n\\n\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u88ab\u5f03\u7528\u7684\u4fee\u9970\u7b26\uff0c `preg_replace()` \u5728\u8fdb\u884c\u4e86\u5bf9\u66ff\u6362\u5b57\u7b26\u4e32\u7684 \u540e\u5411\u5f15\u7528\u66ff\u6362\u4e4b\u540e, \u5c06\u66ff\u6362\u540e\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3aphp \u4ee3\u7801\u8bc4\u4f30\u6267\u884c(eval \u51fd\u6570\u65b9\u5f0f)\uff0c\u5e76\u4f7f\u7528\u6267\u884c\u7ed3\u679c \u4f5c\u4e3a\u5b9e\u9645\u53c2\u4e0e\u66ff\u6362\u7684\u5b57\u7b26\u4e32\u3002\u5355\u5f15\u53f7\u3001\u53cc\u5f15\u53f7\u3001\u53cd\u659c\u7ebf(\\\\)\u548c NULL \u5b57\u7b26\u5728 \u540e\u5411\u5f15\u7528\u66ff\u6362\u65f6\u4f1a\u88ab\u7528\u53cd\u659c\u7ebf\u8f6c\u4e49.\\n\\n\u8bf7\u786e\u4fdd replacement \u53c2\u6570\u7531\u5408\u6cd5 php \u4ee3\u7801\u5b57\u7b26\u4e32\u7ec4\u6210\uff0c\u5426\u5219 php \u5c06\u4f1a \u5728`preg_replace()` \u8c03\u7528\u7684\u884c\u4e0a\u4ea7\u751f\u4e00\u4e2a\u89e3\u91ca\u9519\u8bef\u3002\\n\\n\u4e0d\u5efa\u8bae\u4f7f\u7528\u6b64\u4fee\u9970\u7b26\uff0c\u5b83\u5f88\u5bb9\u6613\u4ea7\u751f\u5b89\u5168\u6f0f\u6d1e\uff1a\\n\\n> Notice: \u4ec5 `preg_replace()` \u4f7f\u7528\u6b64\u4fee\u9970\u7b26\uff0c\u5176\u4ed6 PCRE \u51fd\u6570\u5ffd\u7565\u6b64\u4fee\u9970\u7b26\u3002\\n\\n## A (PCRE_ANCHORED)\\n\\n\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u4fee\u9970\u7b26\uff0c\u6a21\u5f0f\u88ab\u5f3a\u5236\u4e3a\\"\u951a\u5b9a\\"\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u7ea6\u675f\u5339\u914d\u4f7f\u5176\u4ec5\u4ece \u76ee\u6807\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u4f4d\u7f6e\u641c\u7d22\u3002\\n\u8fd9\u4e2a\u6548\u679c\u540c\u6837\u53ef\u4ee5\u4f7f\u7528\u9002\u5f53\u7684\u6a21\u5f0f\u6784\u9020\u51fa\u6765\uff0c\u5e76\u4e14 \u8fd9\u4e5f\u662f perl \u79cd\u5b9e\u73b0\u8fd9\u79cd\u6a21\u5f0f\u7684\u552f\u4e00\u9014\u5f84\u3002\\n\\n## D (PCRE_DOLLAR_ENDONLY)\\n\\n\u5982\u679c\u8fd9\u4e2a\u4fee\u9970\u7b26\u88ab\u8bbe\u7f6e\uff0c\u6a21\u5f0f\u4e2d\u7684\u5143\u5b57\u7b26\u7f8e\u5143\u7b26\u53f7(`$`)\u4ec5\u4ec5\u5339\u914d\u76ee\u6807\u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u3002\\n\u5982\u679c\u8fd9\u4e2a\u4fee\u9970\u7b26 \u6ca1\u6709\u8bbe\u7f6e\uff0c\u5f53\u5b57\u7b26\u4e32\u4ee5\u4e00\u4e2a\u6362\u884c\u7b26\u7ed3\u5c3e\u65f6\uff0c \u7f8e\u5143\u7b26\u53f7\u8fd8\u4f1a\u5339\u914d\u8be5\u6362\u884c\u7b26(\u4f46\u4e0d\u4f1a\u5339\u914d\u4e4b\u524d\u7684\u4efb\u4f55\u6362\u884c\u7b26)\u3002 \\n\u5982\u679c\u8bbe\u7f6e\u4e86\u4fee\u9970\u7b26 `m`\uff0c\u8fd9\u4e2a\u4fee\u9970\u7b26\u88ab\u5ffd\u7565. \\n\\n> \u5728 perl \u4e2d\u6ca1\u6709\u4e0e\u6b64\u4fee\u9970\u7b26\u7b49\u540c\u7684\u4fee\u9970\u7b26\u3002\\n\\n## S\\n\\n\u5f53\u4e00\u4e2a\u6a21\u5f0f\u9700\u8981\u591a\u6b21\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u4e3a\u4e86\u5f97\u5230\u5339\u914d\u901f\u5ea6\u7684\u63d0\u5347\uff0c\u503c\u5f97\u82b1\u8d39\u4e00\u4e9b\u65f6\u95f4 \u5bf9\u5176\u8fdb\u884c\u4e00\u4e9b\u989d\u5916\u7684\u5206\u6790\u3002\\n\u5982\u679c\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u4fee\u9970\u7b26\uff0c\u8fd9\u4e2a\u989d\u5916\u7684\u5206\u6790\u5c31\u4f1a\u6267\u884c\u3002\\n\u5f53\u524d\uff0c \u8fd9\u79cd\u5bf9\u4e00\u4e2a\u6a21\u5f0f\u7684\u5206\u6790\u4ec5\u4ec5\u9002\u7528\u4e8e\u975e\u951a\u5b9a\u6a21\u5f0f\u7684\u5339\u914d(\u5373\u6ca1\u6709\u5355\u72ec\u7684\u56fa\u5b9a\u5f00\u59cb\u5b57\u7b26)\u3002\\n\\n## U (PCRE_UNGREEDY)\\n\\n\u8fd9\u4e2a\u4fee\u9970\u7b26\u9006\u8f6c\u4e86\u91cf\u8bcd\u7684\\"\u8d2a\u5a6a\\"\u6a21\u5f0f\u3002 \u4f7f\u91cf\u8bcd\u9ed8\u8ba4\u4e3a\u975e\u8d2a\u5a6a\u7684\uff0c\u901a\u8fc7\u91cf\u8bcd\u540e\u7d27\u8ddf `?` \u7684\u65b9\u5f0f\u53ef\u4ee5\u4f7f\u5176\u6210\u4e3a\u8d2a\u5a6a\u7684\u3002\\n\u8fd9\u548c perl \u662f\u4e0d\u517c\u5bb9\u7684\u3002 \u5b83\u540c\u6837\u53ef\u4ee5\u4f7f\u7528 [\u6a21\u5f0f\u5185\u4fee\u9970\u7b26\u8bbe\u7f6e](http://php.net/manual/zh/regexp.reference.internal-options.php) `(?U)` \u8fdb\u884c\u8bbe\u7f6e\uff0c \u6216\u8005\u5728\u91cf\u8bcd\u540e\u4ee5\u95ee\u53f7\u6807\u8bb0\u5176\u975e\u8d2a\u5a6a(\u6bd4\u5982`.*?`)\u3002\\n\\n> Note: \u5728\u975e\u8d2a\u5a6a\u6a21\u5f0f\uff0c\u901a\u5e38\u4e0d\u80fd\u5339\u914d\u8d85\u8fc7 `pcre.backtrack_limit` \u7684\u5b57\u7b26\u3002\\n\\n## X (PCRE_EXTRA)\\n\\n\u8fd9\u4e2a\u4fee\u9970\u7b26\u6253\u5f00\u4e86 PCRE \u4e0e perl \u4e0d\u517c\u5bb9\u7684\u9644\u4ef6\u529f\u80fd\u3002\u6a21\u5f0f\u4e2d\u7684\u4efb\u610f\u53cd\u659c\u7ebf\u540e\u5c31 ingen \u4e00\u4e2a \u6ca1\u6709\u7279\u6b8a\u542b\u4e49\u7684\u5b57\u7b26\u90fd\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u9519\u8bef\uff0c\u4ee5\u6b64\u4fdd\u7559\u8fd9\u4e9b\u5b57\u7b26\u4ee5\u4fdd\u8bc1\u5411\u540e\u517c\u5bb9\u6027\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728 perl \u4e2d\uff0c\u53cd\u659c\u7ebf\u7d27\u8ddf\u4e00\u4e2a\u6ca1\u6709\u7279\u6b8a\u542b\u4e49\u7684\u5b57\u7b26\u88ab\u8ba4\u4e3a\u662f\u8be5\u5b57\u7b26\u7684\u539f\u6587\u3002 \u5f53\u524d\u6ca1\u6709\u5176\u4ed6\u7279\u6027\u7531\u8fd9\u4e2a\u4fee\u9970\u7b26\u63a7\u5236\u3002\\n\\n## J (PCRE_INFO_JCHANGED)\\n\\n\u5185\u90e8\u9009\u9879\u8bbe\u7f6e(`?J`)\u4fee\u6539\u672c\u5730\u7684 PCRE_DUPNAMES \u9009\u9879\u3002\u5141\u8bb8\u5b50\u7ec4\u91cd\u540d\uff0c (\u8bd1\u6ce8\uff1a\u53ea\u80fd\u901a\u8fc7\u5185\u90e8\u9009\u9879\u8bbe\u7f6e\uff0c\u5916\u90e8\u7684 `/J` \u8bbe\u7f6e\u4f1a\u4ea7\u751f\u9519\u8bef\u3002)\\n\\n## u (PCRE_UTF8)\\n\\n\u6b64\u4fee\u6b63\u7b26\u6253\u5f00\u4e00\u4e2a\u4e0e perl \u4e0d\u517c\u5bb9\u7684\u9644\u52a0\u529f\u80fd\u3002 \u6a21\u5f0f\u548c\u76ee\u6807\u5b57\u7b26\u4e32\u90fd\u88ab\u8ba4\u4e3a\u662f `utf-8` \u7684\u3002 \\n\u65e0\u6548\u7684\u76ee\u6807\u5b57\u7b26\u4e32\u4f1a\u5bfc\u81f4 `preg_*` \u51fd\u6570\u4ec0\u4e48\u90fd\u5339\u914d\u4e0d\u5230\uff1b \u65e0\u6548\u7684\u6a21\u5f0f\u5b57\u7b26\u4e32\u4f1a\u5bfc\u81f4 E_WARNING \u7ea7\u522b\u7684\u9519\u8bef\u3002 \\n\\nPHP 5.3.4 \u540e\uff0c5\u5b57\u8282\u548c6\u5b57\u8282\u7684 UTF-8 \u5b57\u7b26\u5e8f\u5217\u88ab\u8003\u8651\u4e3a\u65e0\u6548\uff08resp. PCRE 7.3 2007-08-28\uff09\u3002 \u4ee5\u524d\u5c31\u88ab\u8ba4\u4e3a\u662f\u65e0\u6548\u7684 UTF-8\u3002\\n\\n> From: http://php.net/manual/zh/reference.pcre.pattern.modifiers.php"},{"id":"implement-a-telnet-tool-in-php","metadata":{"permalink":"/blog/implement-a-telnet-tool-in-php","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2017/05-12-implement-a-telnet-tool-in-php.md","source":"@site/blog/2017/05-12-implement-a-telnet-tool-in-php.md","title":"php \u5b9e\u73b0\u4e00\u4e2a Telnet \u5de5\u5177\u7c7b","description":"\u4f7f\u7528php \u91cc\u7684 socket \u76f8\u5173\u51fd\u6570\uff0c\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684 Telnet \u5de5\u5177\u7c7b\u3002","date":"2017-05-12T09:47:00.000Z","formattedDate":"2017\u5e745\u670812\u65e5","tags":[{"label":"php","permalink":"/blog/tags/php"},{"label":"socket","permalink":"/blog/tags/socket"},{"label":"telnet","permalink":"/blog/tags/telnet"}],"readingTime":4.79,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"php \u5b9e\u73b0\u4e00\u4e2a Telnet \u5de5\u5177\u7c7b","tags":["php","socket","telnet"],"date":"2017-05-12T09:47","slug":"implement-a-telnet-tool-in-php","authors":"inhere"},"prevItem":{"title":"php\u4e2d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6a21\u5f0f\u4fee\u9970\u7b26","permalink":"/blog/regex-pattern-mode-in-php"},"nextItem":{"title":"PHP\u8c03\u8bd5\u7684\u5f3a\u608d\u5229\u5668\u4e4bPHPDBG","permalink":"/blog/debug-tool-phpdbg-usage-in-php"}},"content":"\u4f7f\u7528php \u91cc\u7684 socket \u76f8\u5173\u51fd\u6570\uff0c\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684 Telnet \u5de5\u5177\u7c7b\u3002\\n\\n- \u652f\u6301\u53d1\u9001\u547d\u4ee4\uff0c\u83b7\u53d6\u7ed3\u679c\\n- \u8fdb\u5165\u4ea4\u4e92\u73af\u5883\uff0c\u7c7b\u4f3c\u4e8e\u547d\u4ee4\u884c\u5de5\u5177telnet\\n- \u6301\u7eed\u7684\u76d1\u63a7\u4e00\u4e2a\u547d\u4ee4 \uff0c\u7c7b\u4f3c\u4e8e\u547d\u4ee4\u884c\u7684 watch\\n\\n\x3c!--truncate--\x3e\\n\\n\u53ef\u9009\u62e9\u4f7f\u7528\u4e09\u79cd\u8fde\u63a5\u65b9\u5f0f\\n\\n- fsockopen - php \u5185\u7f6e\u51fd\u6570\\n- socket - \u9700\u8981 `sockets` \u6269\u5c55\\n- stream - \u4f7f\u7528 `stream_*` \u76f8\u5173\u51fd\u6570\\n\\n\u5b8c\u6574\u4ee3\u7801[\u6e90\u6587\u4ef6](https://gist.github.com/inhere/f39d2d1641b2282e54ecefa84a5af8b4#file-telnet-php)\uff1a\\n\\n```php\\n<?php\\n\\n/**\\n * Class Telnet\\n */\\nclass Telnet\\n{\\n    const DRIVER_SOCKET = \'socket\';\\n    const DRIVER_STREAM = \'stream\';\\n    const DRIVER_FSOCK = \'fsock\';\\n\\n    /**\\n     * @var array\\n     */\\n    private static $availableDrivers = [\\n        \'socket\' => \'socket_create\',\\n        \'stream\' => \'stream_socket_client\',\\n        \'fsock\' => \'fsockopen\',\\n    ];\\n\\n    /**\\n     * @var resource\\n     */\\n    private $sock;\\n\\n    /**\\n     * @var string\\n     */\\n    private $driver;\\n\\n    /**\\n     * @var string\\n     */\\n    private $host;\\n\\n    /**\\n     * @var int\\n     */\\n    private $port;\\n\\n    /**\\n     * @var array\\n     */\\n    private $config = [\\n        \'driver\' => \'\', // \'fsock\' \'stream\' \'socket\'. if is empry, will auto select.\\n\\n        // \u8bbe\u7f6e\u963b\u585e\u6216\u8005\u975e\u963b\u585e\u6a21\u5f0f\\n        \'blocking\' => true,\\n\\n        // 10s\\n        \'timeout\' => 10,\\n\\n        // max watch time 180s, when use watch\\n        \'max_watch_time\' => 180,\\n    ];\\n\\n    /**\\n     * Telnet constructor.\\n     * @param string $host\\n     * @param int $port\\n     * @param array $config\\n     */\\n    public function __construct($host = \'127.0.0.1\', $port = 80, array $config = [])\\n    {\\n        $this->host = $host ?: \'127.0.0.1\';\\n        $this->port = $port ?: 80;\\n\\n        $this->setConfig($config);\\n\\n        $this->init();\\n\\n        $this->connect($this->host, $this->port);\\n    }\\n\\n    protected function init()\\n    {\\n        $driver = $this->config[\'driver\'];\\n\\n        if (!$driver || !isset(self::$availableDrivers[$driver])) {\\n            foreach (self::$availableDrivers as $name => $funcName) {\\n                if (function_exists($funcName)) {\\n                    $driver = $name;\\n                    break;\\n                }\\n            }\\n        }\\n\\n        $this->driver = $driver;\\n    }\\n\\n    /**\\n     * @param string $host\\n     * @param string $port\\n     */\\n    protected function connect($host, $port)\\n    {\\n        try {\\n            $this->doConnect($host, $port, $this->driver);\\n        } catch (\\\\Exception $e) {\\n            throw new \\\\RuntimeException(\\"Use {$this->driver} connect to the server {$host}:{$port} failed, ERROR({$e->getCode()}): {$e->getMessage()}\\", -500);\\n        }\\n    }\\n\\n    /**\\n     * @param string $host\\n     * @param string $port\\n     * @param string $driver\\n     */\\n    protected function doConnect($host, $port, $driver)\\n    {\\n        $errNo = $errStr = null;\\n\\n        switch ($driver) {\\n            case self::DRIVER_SOCKET:\\n                $this->sock = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\\n                if ($this->sock === false) {\\n                    throw new \\\\RuntimeException(\'socket_create() failed. Reason: \' . socket_strerror(socket_last_error()), -400);\\n                }\\n\\n                if (socket_connect($this->sock, $host, $port) === false) {\\n                    throw new \\\\RuntimeException(\'socket_connect() failed. Reason: \' . socket_strerror(socket_last_error()), -450);\\n                }\\n\\n                if ($this->config[\'blocking\']) {\\n                    socket_set_block($this->sock);\\n                } else {\\n                    socket_set_nonblock($this->sock);\\n                }\\n\\n                socket_set_option($this->sock, SOL_SOCKET, SO_RCVTIMEO, [\\n                    \'sec\' => $this->config[\'timeout\'],\\n                    \'usec\' => null\\n                ]);\\n                break;\\n\\n            case self::DRIVER_STREAM:\\n                $this->sock = stream_socket_client(\\n                    \\"tcp://{$host}:{$port}\\",\\n                    $errNo,\\n                    $errStr,\\n                    $this->config[\'timeout\'],\\n                    STREAM_CLIENT_CONNECT | STREAM_CLIENT_PERSISTENT\\n                );\\n                break;\\n\\n            case self::DRIVER_FSOCK:\\n            default:\\n                $this->sock = fsockopen($host, $port, $errNo, $errStr, $this->config[\'timeout\']);\\n                break;\\n        }\\n\\n        if (!$this->sock) {\\n            throw new \\\\RuntimeException(\\"Connect to the {$host}:{$port} failed, ERROR: $errNo - $errStr\\", -500);\\n        }\\n\\n        if ($driver !== self::DRIVER_SOCKET) {\\n            stream_set_blocking($this->sock, $this->config[\'blocking\'] ? 1 : 0);\\n            stream_set_timeout($this->sock, $this->config[\'timeout\'], 0);\\n        }\\n    }\\n\\n    /**\\n     * watch a command\\n     * @param  string  $command\\n     * @param  integer $interval (ms)\\n     */\\n    public function watch($command, $interval = 500)\\n    {\\n        $count = 0;\\n        $activeTime = time();\\n        $maxTime = (int)$this->config[\'max_watch_time\'];\\n        $intervalUs = $interval * 1000;\\n\\n        echo \\"watch command: $command, refresh interval: {$interval}ms\\\\n\\";\\n\\n        while (true) {\\n            $count++;\\n            $result = $this->command($command);\\n\\n            if (0 === strpos($result, \'ERR\')) {\\n                echo \\"$result\\\\n\\";\\n                echo \\"error command: $command. \\";\\n                break;\\n            }\\n\\n            // clear screen before output\\n            echo \\"\\\\033[2JThe {$count} times watch {$command} result(refresh interval: {$interval}ms):\\\\n{$result}\\\\n\\";\\n\\n            if ($maxTime > 0 && time() - $activeTime >= $maxTime) {\\n                echo \\"watch time end. \\";\\n                break;\\n            }\\n\\n            usleep($intervalUs);\\n        }\\n\\n        echo \\"Quit\\\\n\\";\\n    }\\n\\n    /**\\n     * into interactive environment\\n     */\\n    public function interactive()\\n    {\\n        echo \\"welcome! please input command(\'quit\' or \'exit\' to Quit).\\\\n \\";\\n\\n        while (true) {\\n            echo \\"> \\";\\n            if ($cmd = trim(fgets(\\\\STDIN))) {\\n                // echo \\"input command: $cmd\\\\n\\";\\n                if ($cmd === \'quit\' || $cmd === \'exit\') {\\n                    echo \\"Quit. Bye\\\\n\\";\\n                    break;\\n                }\\n\\n                echo $this->command($cmd) . PHP_EOL;\\n            }\\n\\n            usleep(50000);\\n        }\\n\\n        $this->close();\\n    }\\n\\n    /**\\n     * send command\\n     * @param  string $command\\n     * @param bool $readResult\\n     * @param int $readSize\\n     * @return false|int|string\\n     */\\n    public function command($command, $readResult = true, $readSize = 1024)\\n    {\\n        $len = $this->write(trim($command) . \\"\\\\r\\\\n\\");\\n\\n        if ($readResult) {\\n            return $this->read($readSize);\\n        }\\n\\n        return $len;\\n    }\\n\\n    /**\\n     * write\\n     * @param  string $buffer\\n     * @return int|false\\n     */\\n    public function write($buffer)\\n    {\\n        if ($this->driver === self::DRIVER_SOCKET) {\\n            return socket_write($this->sock, $buffer, strlen($buffer));\\n        } else {\\n            // $buffer = str_replace(chr(255), chr(255) . chr(255), $buffer);\\n            return fwrite($this->sock, $buffer);\\n        }\\n    }\\n\\n    /**\\n     * read\\n     * @param  integer $size\\n     * @return string|false\\n     */\\n    public function read($size = 1024)\\n    {\\n        if ($this->driver === self::DRIVER_SOCKET) {\\n            return socket_read($this->sock, $size);\\n        } else {\\n            return fread($this->sock, $size);\\n        }\\n    }\\n\\n    public function close()\\n    {\\n        if ($this->sock) {\\n            if ($this->driver === self::DRIVER_SOCKET) {\\n                socket_close($this->sock);\\n            } else {\\n                fclose($this->sock);\\n            }\\n\\n            $this->sock = null;\\n        }\\n    }\\n\\n    /**\\n     * @return resource\\n     */\\n    public function getSock()\\n    {\\n        return $this->sock;\\n    }\\n\\n    /**\\n     * @return array\\n     */\\n    public function getConfig()\\n    {\\n        return $this->config;\\n    }\\n\\n    /**\\n     * @param array $config\\n     */\\n    public function setConfig(array $config)\\n    {\\n        if ($config) {\\n            $this->config = array_merge($this->config, $config);\\n        }\\n    }\\n\\n    public function __destruct()\\n    {\\n        $this->close();\\n    }\\n}\\n```\\n\\n## \u7b80\u5355\u4f7f\u7528\\n\\n\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u5165\u53e3\u6587\u4ef6`telnet.php`\uff1a\\n\\n```php\\nglobal $argv;\\n$opts = getopt(\'h\', [\'help\']);\\n\\nif (isset($opts[\'h\']) || isset($opts[\'help\'])) {\\n    $script = array_shift($argv);\\n    $help = <<<EOF\\nStart a telnet client.\\n\\nUsage:\\n  php $script HOST [PORT]\\n\\nOptions:\\n  -h,--help  Show this help information\\n\\\\n\\nEOF;\\n    exit($help);\\n}\\n\\n$host = isset($argv[1]) ? $argv[1] : \'127.0.0.1\';\\n$port = isset($argv[2]) ? $argv[2] : 4730;\\n\\necho \\"Connect to the server {$host}:{$port}\\\\n\\";\\n\\n$tt = new Telnet($host, $port);\\n\\n// echo $tt->command(\'status\');\\n// $tt->watch(\'status\');\\n$tt->interactive(); // \u8fdb\u5165\u4ea4\u4e92\u73af\u5883\uff0c\u7c7b\u4f3c\u4e8e\u547d\u4ee4\u884c\u5de5\u5177telnet\\n```\\n\\n\u8c03\u7528\uff1a\\n\\n```bash\\nphp telnet.php 127.0.0.1 11211\\n```"},{"id":"debug-tool-phpdbg-usage-in-php","metadata":{"permalink":"/blog/debug-tool-phpdbg-usage-in-php","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2017/04-12-debug-tool-phpdbg-usage-in-php.md","source":"@site/blog/2017/04-12-debug-tool-phpdbg-usage-in-php.md","title":"PHP\u8c03\u8bd5\u7684\u5f3a\u608d\u5229\u5668\u4e4bPHPDBG","description":"PHPDBG\u662f\u4e00\u4e2aPHP\u7684SAPI\u6a21\u5757\uff0c\u53ef\u4ee5\u5728\u4e0d\u7528\u4fee\u6539\u4ee3\u7801\u548c\u4e0d\u5f71\u54cd\u6027\u80fd\u7684\u60c5\u51b5\u4e0b\u63a7\u5236PHP\u7684\u8fd0\u884c\u73af\u5883\u3002","date":"2017-04-12T08:56:00.000Z","formattedDate":"2017\u5e744\u670812\u65e5","tags":[{"label":"php","permalink":"/blog/tags/php"},{"label":"phpdbg","permalink":"/blog/tags/phpdbg"}],"readingTime":8.275,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"PHP\u8c03\u8bd5\u7684\u5f3a\u608d\u5229\u5668\u4e4bPHPDBG","tags":["php","phpdbg"],"date":"2017-04-12T08:56","slug":"debug-tool-phpdbg-usage-in-php","authors":"inhere"},"prevItem":{"title":"php \u5b9e\u73b0\u4e00\u4e2a Telnet \u5de5\u5177\u7c7b","permalink":"/blog/implement-a-telnet-tool-in-php"},"nextItem":{"title":"Linux\u7684chattr\u4e0elsattr\u547d\u4ee4\u4f7f\u7528","permalink":"/blog/chattr-lsattr-command-in-linux"}},"content":"PHPDBG\u662f\u4e00\u4e2aPHP\u7684SAPI\u6a21\u5757\uff0c\u53ef\u4ee5\u5728\u4e0d\u7528\u4fee\u6539\u4ee3\u7801\u548c\u4e0d\u5f71\u54cd\u6027\u80fd\u7684\u60c5\u51b5\u4e0b\u63a7\u5236PHP\u7684\u8fd0\u884c\u73af\u5883\u3002\\n\\nPHPDBG\u7684\u76ee\u6807\u662f\u6210\u4e3a\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u3001\u5f3a\u5927\u3001\u6613\u7528\u7684PHP\u8c03\u8bd5\u5e73\u53f0\u3002\u5728php5.6\u548c\u4e4b\u4e0a\u7248\u672c\u5c06 **\u5185\u90e8\u96c6\u6210**\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n## \u4e3b\u8981\u529f\u80fd\\n\\n- \u5355\u6b65\u8c03\u8bd5\\n- \u7075\u6d3b\u7684\u4e0b\u65ad\u70b9\u65b9\u5f0f\uff08\u7c7b\u65b9\u6cd5\u3001\u51fd\u6570\u3001\u6587\u4ef6:\u884c\u3001\u5185\u5b58\u5730\u5740\u3001opcode\uff09\\n- \u53ef\u76f4\u63a5\u8c03\u7528php\u7684eval\\n- \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u6267\u884c\u7684\u4ee3\u7801\\n- \u7528\u6237\u7a7a\u95f4API\uff08userland/user space\uff09\\n- \u65b9\u4fbf\u96c6\u6210\\n- \u652f\u6301\u6307\u5b9aphp\u914d\u7f6e\u6587\u4ef6\\n- JIT\u5168\u5c40\u53d8\u91cf\\n- readline\u652f\u6301\uff08\u53ef\u9009\uff09\uff0c\u7ec8\u7aef\u64cd\u4f5c\u66f4\u65b9\u4fbf\\n- \u8fdc\u7a0bdebug\uff0c\u4f7f\u7528java GUI\\n- \u64cd\u4f5c\u7b80\u4fbf\uff08\u5177\u4f53\u770bhelp\uff09\\n\\n## \u5b89\u88c5\\n\\n\u4e3a\u4e86\u4f7f\u7528phpdgb\uff0c\u4f60\u9996\u5148\u9700\u8981\u4e0b\u8f7d\u4e00\u4e2aphp\u7684\u6e90\u7801\u5305\u3002\u7136\u540e\u4e0b\u8f7dphpdgb\u7684\u6e90\u7801\u5305\uff0c\u5e76\u653e\u5728php\u6e90\u7801\u5305\u7684sapi\u76ee\u5f55\u4e0b\u3002\u6700\u540e\uff0c\u4f60\u5c31\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u5b89\u88c5\u4e86\u3002\u7f16\u8bd1\u5b89\u88c5\u793a\u4f8b\u5982\u4e0b\uff1a\\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u4e0b\u8f7dphp\u7684\u6e90\u7801\u5305\uff0c\u5e76\u653e\u5728\u4e86/home/php\u76ee\u5f55\u4e0b\u3002\\n\\n```shell\\n#cd /home/php/sapi\\n#git clone https://github.com/krakjoe/phpdbg\\n#cd ../\\n#./buildconf --force\\n#./config.nice\\n#make -j8\\n#make install-phpdbg\\n```\\n\\n\u6ce8\u610f\uff1a\\n\\n1. \u5982\u679c\u4f60\u7684php\u7248\u672c\u662fphp5.6\u6216\u8005\u66f4\u9ad8\u7684\u7248\u672c\uff0cphpdbg\u5df2\u7ecf\u96c6\u6210\u5728php\u7684\u4ee3\u7801\u5305\u4e2d\uff0c\u65e0\u9700\u5355\u72ec\u4e0b\u8f7d\u4e86\u3002\\n2. \u7f16\u8bd1\u53c2\u6570\u4e2d\u8bb0\u5f97\u8981\u52a0 ?enable-phpdbg\u3002\\n3. \u7f16\u8bd1\u65f6\u53c2\u6570\uff0c?with-readline \u53ef\u4ee5\u9009\u62e9\u6027\u6dfb\u52a0\u3002\u5982\u679c\u4e0d\u6dfb\u52a0\uff0cphpdbg\u7684history\u7b49\u529f\u80fd\u65e0\u6cd5\u4f7f\u7528\u3002\\n\\n## \u57fa\u672c\u4f7f\u7528\\n\\n### 1\u3001\u53c2\u6570\u4ecb\u7ecd\\n\\nphpdbg\u662fphp\u7684\u4e00\u4e2asapi\uff0c\u5b83\u53ef\u4ee5\u4ee5\u547d\u4ee4\u884c\u7684\u65b9\u5f0f\u8c03\u8bd5php\u3002\u5e38\u7528\u53c2\u6570\u5982\u4e0b\uff1a\\n\\n```\\nThe following switches are implemented (just like cli SAPI):\\n-n ignore php ini\\n-c search for php ini in path\\n-z load zend extension\\n-d define php ini entry\\nThe following switches change the default behaviour of phpdbg:\\n-v disables quietness\\n-s enabled stepping\\n-e sets execution context\\n-b boring ? disables use of colour on the console\\n-I ignore .phpdbginit (default init file)\\n-i override .phpgdbinit location (implies -I)\\n-O set oplog output file\\n-q do not print banner on startup\\n-r jump straight to run\\n-E enable step through eval()\\nNote: passing -rr will cause phpdbg to quit after execution, rather than returning to the console\\n```\\n\\n### 2\u3001\u5e38\u7528\u529f\u80fd\\n\\n\u4e4b\u524d\u6211\u4eec\u4ecb\u7ecd\u8fc7gdb\u5de5\u5177\u3002\u5176\u5b9ephpdbg\u548cgdb\u529f\u80fd\u6709\u4e9b\u5730\u65b9\u975e\u5e38\u76f8\u4f3c\u3002\u5982\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u65ad\u70b9\uff0c\u53ef\u4ee5\u5355\u6b65\u6267\u884c\uff0c\u7b49\u3002\u53ea\u662f\u4ed6\u4eec\u8c03\u8bd5\u7684\u8bed\u8a00\u4e0d\u4e00\u6837\uff0cgdb\u4fa7\u91cd\u4e8e\u8c03\u8bd5c\u6216\u8005c++\u8bed\u8a00\uff0c\u800cphpdbg\u4fa7\u91cd\u4e8e\u8c03\u8bd5php\u8bed\u8a00\u3002\u4e0b\u9762\u6211\u4eec\u5c06\u5bf9phpdbg\u7684\u4e00\u4e9b\u5e38\u7528\u8c03\u8bd5\u529f\u80fd\u505a\u4e0b\u4ecb\u7ecd\u3002\u8981\u8c03\u8bd5\u7684\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n\u6587\u4ef6test_phpdbg_inc.php\u6e90\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```php\\n<?php \\nfunction phpdbg_inc_func()\\n{   \\n  echo \\"phpdbg_inc_func \\\\n\\"; \\n} \\n?>\\n```\\n\\n\u6587\u4ef6test_phpdgb.php\u7684\u6e90\u4ee3\u7801\u5982\u4e0b\uff1a\\n\\n```php\\n<?php \\n  include(dirname(__FILE__).\\"/test_phpdbg_inc.php\\"); \\n  class demo{   \\n    public function __construct(){\\n       echo __METHOD__.\\":\\".__LINE__.\\"\\\\n\\";   \\n    }\\n    public function func($param){\\n       $param++;\\n       echo \\"method func $param\\\\n\\";\\n    }\\n    public function __destruct(){\\n       echo __METHOD__.\\":\\".__LINE__.\\"\\\\n\\";\\n    }\\n  } \\n\\n function func(){   \\n   $param = \\"ali\\";\\n   $param = $param + \\"baba\\";\\n   echo \\"function func $param\\\\n\\";\\n }\\n\\n $demo = new demo();\\n $demo->func(1);\\n func();\\n phpdbg_inc_func();\\n?>\\n```\\n\\n### 3\u3001\u542f\u52a8phpdbg\\n\\nphpdbg\u5b89\u88c5\u6210\u529f\u540e\uff0c\u4f1a\u5728\u5b89\u88c5\u76ee\u5f55\u7684bin\u76ee\u5f55\u4e0b\u3002\u8fdb\u5165bin\u76ee\u5f55\uff0c\u76f4\u63a5\u8f93\u5165phpdbg\u5373\u53ef\u3002\u5982\u4e0b\uff1a\\n\\n```sh\\n#phpdbg\\n[Welcome to phpdbg, the interactive PHP debugger, v0.4.0]\\nTo get help using phpdbg type \\"help\\" and press enter\\n[Please report bugs to <http://github.com/krakjoe/phpdbg/issues>]\\nprompt>\\n```\\n\\n\u8981\u60f3\u52a0\u8f7d\u8981\u8c03\u8bd5\u7684php\u811a\u672c\uff0c\u53ea\u9700\u8981\u6267\u884cexec\u547d\u4ee4\u5373\u53ef\u3002\u5982\u4e0b\uff1a\\n\\n```sh\\n#phpdbg\\n......\\nprompt> exec ./test_phpdbg.php\\n```\\n\\n\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u542f\u52a8phpdbg\u7684\u65f6\u5019\uff0c\u6307\u5b9ae\u53c2\u6570\u3002\u5982\u4e0b\uff1a\\n\\n```sh\\n#phpdbg -e ./test_phpdbg.php\\n```\\n\\n### 4\u3001\u67e5\u770b\u5e2e\u52a9\u4fe1\u606f\\n\\n\u5982\u679c\u4f60\u4e4b\u524d\u4f7f\u7528\u8fc7\u5176\u4ed6\u7684\u8c03\u8bd5\u5de5\u5177\uff0c\u4f60\u4f1a\u53d1\u73b0phpdbg\u548c\u4ed6\u4eec\u6bd4\u8f83\u76f8\u4f3c\u3002\u4f46\u662f\uff0c\u4f60\u4f7f\u7528\u521d\u671f\uff0c\u8fd8\u662f\u4f1a\u7ecf\u5e38\u9700\u8981\u83b7\u53d6\u5e2e\u52a9\u4fe1\u606f\u3002\u901a\u8fc7help\u547d\u4ee4\u6211\u4eec\u53ef\u4ee5\u83b7\u53d6\u5e2e\u52a9\u4fe1\u606f\u3002\\n\\n```sh\\n......\\nprompt> help\\n\\nphpdbg is a lightweight, powerful and easy to use debugging platform for PHP5.4+\\nIt supports the following commands:\\n\\nInformation\\n list   list PHP source\\n......\\n```\\n\\n### 5\u3001\u8bbe\u7f6e\u65ad\u70b9\\n\\n\u8bbe\u7f6e\u65ad\u70b9\u7684\u547d\u4ee4\u548cgdb\u4e00\u6837\u3002\u90fd\u662f`break`\uff0c\u7b80\u5199\u5f62\u5f0f\u4e3a`b`\u3002\u4e0d\u8fc7\u5177\u4f53\u7684\u547d\u4ee4\u53c2\u6570\u8fd8\u662f\u6709\u6240\u5dee\u5f02\u7684\u3002\u548cgdb\u7684\u65ad\u70b9\u547d\u4ee4\u76f8\u540c\u4e4b\u5904\uff0c\u5b83\u4eec\u90fd\u53ef\u4ee5\u201c\u6309\u6587\u4ef6\u540d:\u884c\u53f7\u201d \u6216\u8005 \u884c\u53f7\u7684\u65b9\u5f0f\u8bbe\u7f6e\u65ad\u70b9\u3002\u9664\u6b64\u4e4b\u5916\uff0cphpdbg\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9488\u5bf9php\u7279\u6709\u7684\u8bbe\u7f6e\u65ad\u70b9\u7684\u65b9\u5f0f\u3002\u5982\uff0c\u6839\u636eopline\u8bbe\u7f6e\u65ad\u70b9\uff0c\u6839\u636eopcode\u8bbe\u7f6e\u65ad\u70b9\u7b49\u3002\\n\u4f17\u6240\u5468\u77e5\uff0cphp\u4ee3\u7801\u6700\u7ec8\u662f\u89e3\u6790\u6210opcode\uff0c\u7136\u540e\u7531php\u5185\u6838\u4e00\u6761\u6761\u6267\u884c\u3002\u4e00\u6761php\u8bed\u53e5\uff0c\u53ef\u80fd\u4f1a\u89e3\u6790\u6210\u591a\u6761opcode\u3002\u5982\u679c\u53ef\u4ee5\u6309opcode\u8bbe\u7f6e\u65ad\u70b9\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u66f4\u7cbe\u786e\u7684\u8ddf\u8e2a\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u3002\u4e0b\u9762\u6211\u4eec\u6765\u770b\u770bphapdbg\u8bbe\u7f6e\u65ad\u70b9\u7684\u5177\u4f53\u793a\u4f8b\u3002\\n\u6309opline\u8bbe\u7f6e\u65ad\u70b9\uff1a\\n\u8fd9\u91cc\u6240\u8bf4\u7684opline\uff0c\u5c31\u662f\u4ee5\u65b9\u6cd5\u5165\u53e3\u4f5c\u4e3a\u8d77\u70b9\uff0c\u5f53\u524d\u4ee3\u7801\u7684\u884c\u53f7\u3002\u5982 `test_phpdgb.php` \u6587\u4ef6\u4e2d\uff0c\u7b2c18\u884c\u7684\u4ee3\u7801 `$param = $param + \u201cbaba\u201d;` \u7684opline\u5c31\u662f 2\u3002\\n\\n```sh\\n......\\nprompt> b func#2\\nprompt> r\\ndemo::__construct:5\\nmethod func 2\\n[Breakpoint #0 resolved at func#2 (opline 0x7f5b230a2e38)]\\n[Breakpoint #0 resolved at func#2 (opline 0x7f5b230a2e38)]\\n[Breakpoint #0 resolved at func#2 (opline 0x7f5b230a2e38)]\\n[Breakpoint #0 in func()#2 at ./test_phpdbg.php:18, hits: 1]\\n>00018:   $param = $param + \\"baba\\";\\n 00019:   echo \\"function func $param\\\\n\\";;\\n 00020: }\\n......\\n```\\n\\n### 6\u3001\u67e5\u770b\u65ad\u70b9\\n\u548cgdb\u4e00\u6837\uff0cphpdbg\u4e5f\u662f\u4f7f\u7528info break\u547d\u4ee4\u67e5\u770b\u65ad\u70b9\u3002\u793a\u4f8b\u5982\u4e0b\uff1a\\n\\n```sh\\n....\\nprompt> info break\\n------------------------------------------------\\nFile Breakpoints:\\n#1   /home/hailong.xhl/test_phpdbg.php:10\\n------------------------------------------------\\nOpline Breakpoints:\\n#0   7ff3219e1df0    (function breakpoint)\\n------------------------------------------------\\nFunction opline Breakpoints:\\n#0   func opline 2\\n....\\n```\\n\\n\u901a\u8fc7\u4e0a\u9762\u7684\u663e\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u3002info break\u7684\u663e\u793a\u7ed3\u679c\u4e2d\u4f1a\u628a\u65ad\u70b9\u7684\u7c7b\u578b\u4e5f\u7ed9\u663e\u793a\u51fa\u6765\u3002`#` \u540e\u9762\u7684\u6570\u5b57\u662f\u65ad\u70b9\u53f7\u3002\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u65ad\u70b9\u53f7\u5220\u9664\u65ad\u70b9\u3002\\n\\n### 7\u3001\u5220\u9664\u65ad\u70b9\\n\\n\u548cgdb\u547d\u4ee4\u4e0d\u4e00\u6837\u3002phpdbg\u7684\u5220\u9664\u65ad\u70b9\u4e0d\u662fdelete\u547d\u4ee4\uff0c\u800c\u662f`break del` \u547d\u4ee4\u3002\u793a\u4f8b\u5982\u4e0b\uff1a\\n\\n```sh\\n......\\nprompt> break del 1\\n[Deleted breakpoint #1]\\nprompt>\\n......\\n```\\n\\nbreak del \u540e\u9762\u7684\u6570\u5b571\u5c31\u662f\u65ad\u70b9\u53f7\u3002\\n\\n### 8\u3001\u67e5\u770b\u4ee3\u7801\\n\\nphpdbg\u67e5\u770b\u4ee3\u7801\u7684\u547d\u4ee4\u4e5f\u662f`list`\u3002\u4f46\u662f\u548cgdb\u76f8\u6bd4\uff0c\u4f7f\u7528\u7684\u65b9\u5f0f\u66f4\u591a\u6837\u4e00\u4e9b\u3002\\n\u663e\u793a\u6307\u5b9a\u51fd\u6570\u7684\u4ee3\u7801\uff1a\\n\\n```sh\\n......\\nprompt> l f func\\n 00017:   $param = \\"ali\\";\\n 00018:   $param = $param + \\"baba\\";\\n 00019:   echo \\"function func $param\\\\n\\";;\\n 00020: }\\n 00021:\\nprompt>\\n......\\n```\\n\\n\u5355\u6b65\u6267\u884c:\\n\\nphpdbg\u7684\u5355\u6b65\u6267\u884c\u53ea\u6709\u4e00\u4e2a\u547d\u4ee4 `step`\u3002\u548cgdb\u7684step\u547d\u4ee4\u5dee\u4e0d\u591a\u3002\u90fd\u662f\u4e00\u884c\u4e00\u884c\u7684\u6267\u884c\u4ee3\u7801\u3002\\n\\n> \u6ce8\u610f\uff0cphpdbg\u662f\u6ca1\u6709next\u547d\u4ee4\u7684\u3002\\n\\n```sh\\n....\\nprompt> s\\n[Breakpoint #0 resolved at func#2 (opline 0x152ba40)]\\n[L19      0x152ba70 ZEND_ADD_STRING     C2   @0  ./test_phpdbg.php]\\n>00019:   echo \\"function func $param\\\\n\\";;\\n 00020: }\\n 00021:\\n....\\n```\\n\\n\u7ee7\u7eed\u6267\u884c:\\n\\n\u548cgdb\u4e00\u6837\uff0cphpdbg\u7684\u7ee7\u7eed\u6267\u884c\u547d\u4ee4\u4e5f\u662f`continue`\uff0c\u7b80\u5199\u5f62\u5f0f\u4e3a`c`\u3002\\n\\n\u6267\u884cphp\u4ee3\u7801\\n\\n\u8fd9\u4e2a\u662fphpdbg\u7684\u4e00\u4e2a\u7279\u8272\u3002\u53ef\u4ee5\u5728\u8c03\u8bd5\u7684\u8fc7\u7a0b\u4e2d\u4f7f\u7528ev\u547d\u4ee4\u6267\u884c\u4efb\u610f\u7684php\u4ee3\u7801\u3002\u5982\uff1a\\n\\n```sh\\n......\\nprompt> ev $var = \\"val\\";\\nval\\nprompt> ev var_dump($var);\\nstring(3) \\"val\\"\\n......\\n```\\n\\n\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5728\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\u52a8\u6001\u7684\u4fee\u6539\u53d8\u91cf\u503c\uff0c\u67e5\u770b\u6267\u884c\u6548\u679c\u3002\\n\u4ee5\u4e0a\u5c31\u662f\u672c\u6587\u7684\u5168\u90e8\u5185\u5bb9\uff0c\u8f7b\u677e\u73a9\u8f6c\u8c03\u8bd5\u5229\u5668PHPDBG\uff0c\u5e0c\u671b\u5927\u5bb6\u559c\u6b22\u3002\\n\\n> \u8f6c\u81ea [linux\u89c6\u91ce](http://www.linuxsight.com/blog/59466)"},{"id":"chattr-lsattr-command-in-linux","metadata":{"permalink":"/blog/chattr-lsattr-command-in-linux","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/11-08-chattr-lsattr-command-in-linux.md","source":"@site/blog/2016/11-08-chattr-lsattr-command-in-linux.md","title":"Linux\u7684chattr\u4e0elsattr\u547d\u4ee4\u4f7f\u7528","description":"\u6709\u65f6\u5019\u4f60\u53d1\u73b0 \u7528root\u6743\u9650\u90fd\u4e0d\u80fd\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6\uff0c\u5927\u90e8\u5206\u539f\u56e0\u662f\u66fe\u7ecf\u7528chattr\u547d\u4ee4\u9501\u5b9a\u8be5\u6587\u4ef6\u4e86\u3002","date":"2016-11-08T15:13:00.000Z","formattedDate":"2016\u5e7411\u67088\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"chattr","permalink":"/blog/tags/chattr"},{"label":"lsattr","permalink":"/blog/tags/lsattr"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":4.05,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"Linux\u7684chattr\u4e0elsattr\u547d\u4ee4\u4f7f\u7528","tags":["linux","chattr","lsattr","tools"],"date":"2016-11-08T15:13","slug":"chattr-lsattr-command-in-linux","authors":["inhere","network"]},"prevItem":{"title":"PHP\u8c03\u8bd5\u7684\u5f3a\u608d\u5229\u5668\u4e4bPHPDBG","permalink":"/blog/debug-tool-phpdbg-usage-in-php"},"nextItem":{"title":"Shell\u811a\u672c\u4f7f\u7528","permalink":"/blog/shell-script-learn-usage"}},"content":"\u6709\u65f6\u5019\u4f60\u53d1\u73b0 **\u7528root\u6743\u9650\u90fd\u4e0d\u80fd\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6**\uff0c\u5927\u90e8\u5206\u539f\u56e0\u662f\u66fe\u7ecf\u7528chattr\u547d\u4ee4\u9501\u5b9a\u8be5\u6587\u4ef6\u4e86\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n`chattr`\u547d\u4ee4\u7684\u4f5c\u7528\u5f88\u5927\uff0c\u5176\u4e2d\u4e00\u4e9b\u529f\u80fd\u662f\u7531Linux\u5185\u6838\u7248\u672c\u6765\u652f\u6301\u7684\uff0c\u4e0d\u8fc7\u73b0\u5728\u751f\u4ea7\u7edd\u5927\u90e8\u5206\u8dd1\u7684linux\u7cfb\u7edf\u90fd\u662f2.6\u4ee5\u4e0a\u5185\u6838\u4e86\u3002\\n\\n\u901a\u8fc7`chattr`\u547d\u4ee4\u4fee\u6539\u5c5e\u6027\u80fd\u591f\u63d0\u9ad8\u7cfb\u7edf\u7684\u5b89\u5168\u6027\uff0c\u4f46\u662f\u5b83\u5e76\u4e0d\u9002\u5408\u6240\u6709\u7684\u76ee\u5f55\u3002\\n\\n> `chattr`\u547d\u4ee4\u4e0d\u80fd\u4fdd\u62a4`/`\u3001`/dev`\u3001`/tmp`\u3001`/var`\u76ee\u5f55\u3002`lsattr`\u547d\u4ee4\u662f\u663e\u793a`chattr`\u547d\u4ee4\u8bbe\u7f6e\u7684\u6587\u4ef6\u5c5e\u6027\u3002\\n \\n\u8fd9\u4e24\u4e2a\u547d\u4ee4\u662f\u7528\u6765\u67e5\u770b\u548c\u6539\u53d8\u6587\u4ef6\u3001\u76ee\u5f55\u5c5e\u6027\u7684\uff0c\u4e0e `chmod` \u8fd9\u4e2a\u547d\u4ee4\u76f8\u6bd4\uff0c`chmod`\u53ea\u662f\u6539\u53d8\u6587\u4ef6\u7684\u8bfb\u5199\u3001\u6267\u884c\u6743\u9650\uff0c\u66f4\u5e95\u5c42\u7684\u5c5e\u6027\u63a7\u5236\u662f\u7531 `chattr` \u6765\u6539\u53d8\u7684\u3002\\n\\n## chattr\u547d\u4ee4\u7684\u7528\u6cd5\\n\\n```bash\\nchattr [ -RVf ] [ -v version ] [ mode ] files\u2026\\n```\\n\\n\u6700\u5173\u952e\u7684\u662f\u5728[mode]\u90e8\u5206\uff0c[mode]\u90e8\u5206\u662f\u7531`+-=\u548c[ASacDdIijsTtu]`\u8fd9\u4e9b\u5b57\u7b26\u7ec4\u5408\u7684\uff0c\u8fd9\u90e8\u5206\u662f\u7528\u6765\u63a7\u5236\u6587\u4ef6\u7684\\n\u5c5e\u6027\u3002\\n\\n* `+` \u5728\u539f\u6709\u53c2\u6570\u8bbe\u5b9a\u57fa\u7840\u4e0a\uff0c\u8ffd\u52a0\u53c2\u6570\u3002\\n* `-` \u5728\u539f\u6709\u53c2\u6570\u8bbe\u5b9a\u57fa\u7840\u4e0a\uff0c\u79fb\u9664\u53c2\u6570\u3002\\n* `=` \u66f4\u65b0\u4e3a\u6307\u5b9a\u53c2\u6570\u8bbe\u5b9a\u3002\\n* `A` \u6587\u4ef6\u6216\u76ee\u5f55\u7684 atime (access time)\u4e0d\u53ef\u88ab\u4fee\u6539(modified), \u53ef\u4ee5\u6709\u6548\u9884\u9632\u4f8b\u5982\u624b\u63d0\u7535\u8111\u78c1\u76d8I/O\u9519\u8bef\u7684\u53d1\u751f\u3002\\n* `S` \u786c\u76d8I/O\u540c\u6b65\u9009\u9879\uff0c\u529f\u80fd\u7c7b\u4f3csync\u3002\\n* `a` \u5373 `append`\uff0c\u8bbe\u5b9a\u8be5\u53c2\u6570\u540e\uff0c\u53ea\u80fd\u5411\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6570\u636e\uff0c\u800c\u4e0d\u80fd\u5220\u9664\uff0c\u591a\u7528\u4e8e\u670d\u52a1\u5668\u65e5\u5fd7\u6587\u4ef6\u5b89\u5168\uff0c\u53ea\u6709root\u624d\u80fd\u8bbe\u5b9a\u8fd9\u4e2a\u5c5e\u6027\u3002\\n* `c` \u5373 `compresse`\uff0c\u8bbe\u5b9a\u6587\u4ef6\u662f\u5426\u7ecf\u538b\u7f29\u540e\u518d\u5b58\u50a8\u3002\u8bfb\u53d6\u65f6\u9700\u8981\u7ecf\u8fc7\u81ea\u52a8\u89e3\u538b\u64cd\u4f5c\u3002\\n* `d` \u5373 `no dump`\uff0c\u8bbe\u5b9a\u6587\u4ef6\u4e0d\u80fd\u6210\u4e3adump\u7a0b\u5e8f\u7684\u5907\u4efd\u76ee\u6807\u3002\\n* `i` \u8bbe\u5b9a\u6587\u4ef6\u4e0d\u80fd\u88ab\u5220\u9664\u3001\u6539\u540d\u3001\u8bbe\u5b9a\u94fe\u63a5\u5173\u7cfb\uff0c\u540c\u65f6\u4e0d\u80fd\u5199\u5165\u6216\u65b0\u589e\u5185\u5bb9\u3002`i `\u53c2\u6570\u5bf9\u4e8e\u6587\u4ef6 \u7cfb\u7edf\u7684\u5b89\u5168\u8bbe\u7f6e\u6709\u5f88\u5927\u5e2e\u52a9\u3002\\n* `j` \u5373 `journal`\uff0c\u8bbe\u5b9a\u6b64\u53c2\u6570\u4f7f\u5f97\u5f53\u901a\u8fc7mount\u53c2\u6570\uff1a`data=ordered` \u6216\u8005 `data=writeback` \u6302 \u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u6587\u4ef6\u5728\u5199\u5165\u65f6\u4f1a\u5148\u88ab\u8bb0\u5f55(\u5728journal\u4e2d)\u3002\u5982\u679cfilesystem\u88ab\u8bbe\u5b9a\u53c2\u6570\u4e3a data=journal\uff0c\u5219\u8be5\u53c2\u6570\u81ea\u52a8\u5931\u6548\u3002\\n* `s` \u4fdd\u5bc6\u6027\u5730\u5220\u9664\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u5373\u786c\u76d8\u7a7a\u95f4\u88ab\u5168\u90e8\u6536\u56de\u3002\\n* `u` \u4e0e `s` \u76f8\u53cd\uff0c\u5f53\u8bbe\u5b9a\u4e3a`u`\u65f6\uff0c\u6570\u636e\u5185\u5bb9\u5176\u5b9e\u8fd8\u5b58\u5728\u78c1\u76d8\u4e2d\uff0c\u53ef\u4ee5\u7528\u4e8e`undeletion`\u3002\\n\\n\u5404\u53c2\u6570\u9009\u9879\u4e2d\u5e38\u7528\u5230\u7684\u662f`a`\u548c`i`\u3002a\u9009\u9879\u5f3a\u5236\u53ea\u53ef\u6dfb\u52a0\u4e0d\u53ef\u5220\u9664\uff0c\u591a\u7528\u4e8e\u65e5\u5fd7\u7cfb\u7edf\u7684\u5b89\u5168\u8bbe\u5b9a\u3002\u800ci\u662f\u66f4\u4e3a\u4e25\u683c\u7684\u5b89\u5168\u8bbe\u5b9a\uff0c\u53ea\u6709`superuser (root)` \u6216\u5177\u6709`CAP_LINUX_IMMUTABLE`\u5904\u7406\u80fd\u529b\uff08\u6807\u8bc6\uff09\u7684\u8fdb\u7a0b\u80fd\u591f\u65bd\u52a0\u8be5\u9009\u9879\u3002\\n\\n## \u5e94\u7528\u4e3e\u4f8b\\n\\n1\u3001\u7528chattr\u547d\u4ee4\u9632\u6b62\u7cfb\u7edf\u4e2d\u67d0\u4e2a\u5173\u952e\u6587\u4ef6\u88ab\u4fee\u6539\uff1a\\n\\n```\\nchattr +i /etc/resolv.conf\\n```\\n\\n\u7136\u540e\u7528`mv /etc/resolv.conf`\u7b49\u547d\u4ee4\u64cd\u4f5c\u4e8e\u8be5\u6587\u4ef6\uff0c\u90fd\u662f\u5f97\u5230`Operation not permitted` \u7684\u7ed3\u679c\u3002vim\u7f16\u8f91\u8be5\u6587\u4ef6\u65f6\u4f1a\u63d0\u793a`W10: Warning: Changing a readonly file`\u9519\u8bef\u3002\\n\\n\u8981\u60f3\u4fee\u6539\u6b64\u6587\u4ef6\u5c31\u8981\u628ai\u5c5e\u6027\u53bb\u6389\uff1a \\n\\n```\\nchattr -i /etc/resolv.conf\\n```\\n\\n```\\nlsattr /etc/resolv.conf\\n```\\n\\n\u4f1a\u663e\u793a\u5982\u4e0b\u5c5e\u6027\\n\\n```\\n----i-------- /etc/resolv.conf\\n```\\n\\n2\u3001\u8ba9\u67d0\u4e2a\u6587\u4ef6\u53ea\u80fd\u5f80\u91cc\u9762\u8ffd\u52a0\u6570\u636e\uff0c\u4f46\u4e0d\u80fd\u5220\u9664\uff0c\u9002\u7528\u4e8e\u5404\u79cd\u65e5\u5fd7\u6587\u4ef6\uff1a\\n\\n```\\nchattr +a /var/log/messages\\n```\\n\\n> \u8f6c\u81ea\uff1a [ha97.com](http://www.ha97.com/5172.html)"},{"id":"shell-script-learn-usage","metadata":{"permalink":"/blog/shell-script-learn-usage","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/09-24-shell-script-learn-usage.md","source":"@site/blog/2016/09-24-shell-script-learn-usage.md","title":"Shell\u811a\u672c\u4f7f\u7528","description":"Shell\u811a\u672c\u7684\u4e00\u4e9b\u4f7f\u7528\u8bb0\u5f55","date":"2016-09-24T11:28:00.000Z","formattedDate":"2016\u5e749\u670824\u65e5","tags":[{"label":"shell","permalink":"/blog/tags/shell"},{"label":"script","permalink":"/blog/tags/script"}],"readingTime":2.55,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"Shell\u811a\u672c\u4f7f\u7528","tags":["shell","script"],"date":"2016-09-24T11:28","slug":"shell-script-learn-usage","authors":["inhere","network"]},"prevItem":{"title":"Linux\u7684chattr\u4e0elsattr\u547d\u4ee4\u4f7f\u7528","permalink":"/blog/chattr-lsattr-command-in-linux"},"nextItem":{"title":"linux \u547d\u4ee4 sed \u8be6\u89e3","permalink":"/blog/sec-command-usage-in-linux"}},"content":"Shell\u811a\u672c\u7684\u4e00\u4e9b\u4f7f\u7528\u8bb0\u5f55\\n\\n\x3c!--truncate--\x3e\\n\\n## echo\u663e\u793a\u5e26\u989c\u8272\\n\\necho\u663e\u793a\u5e26\u989c\u8272\uff0c\u9700\u8981\u4f7f\u7528\u53c2\u6570-e\\n\u683c\u5f0f\u5982\u4e0b:\\n\\n```bash\\necho -e \\"\\\\033[\u5b57\u80cc\u666f\u989c\u8272;\u6587\u5b57\u989c\u8272m\u5b57\u7b26\u4e32\\\\033[0m\\"\\n```\\n\\n\u4f8b\u5982: \\n\\n```bash\\necho -e \\"\\\\033[41;37m TonyZhang \\\\033[0m\\"\\n```\\n\\n\u5176\u4e2d41\u7684\u4f4d\u7f6e\u4ee3\u8868\u5e95\u8272, 37\u7684\u4f4d\u7f6e\u662f\u4ee3\u8868\u5b57\u7684\u989c\u8272\\n \\n\u6ce8\uff1a\\n \\n1. \u5b57\u80cc\u666f\u989c\u8272\u548c\u6587\u5b57\u989c\u8272\u4e4b\u95f4\u662f\u82f1\u6587\u7684 `;`\\n2. \u6587\u5b57\u989c\u8272\u540e\u9762\u6709\u4e2am\\n3. \u5b57\u7b26\u4e32\u524d\u540e\u53ef\u4ee5\u6ca1\u6709\u7a7a\u683c\uff0c\u5982\u679c\u6709\u7684\u8bdd\uff0c\u8f93\u51fa\u4e5f\u662f\u540c\u6837\u6709\u7a7a\u683c\\n\\n\u4e0b\u9762\u770b\u51e0\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\n\\necho -e \\"\\\\033[30m \u9ed1\u8272\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[31m \u7ea2\u8272\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[32m \u7eff\u8272\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[33m \u9ec4\u8272\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[34m \u84dd\u8272\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[35m \u7d2b\u8272\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[36m \u5929\u84dd\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[37m \u767d\u8272\u5b57 \\\\033[0m\\"\\n \\necho -e \\"\\\\033[40;37m \u9ed1\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[41;37m \u7ea2\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[42;37m \u7eff\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[43;37m \u9ec4\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[44;37m \u84dd\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[45;37m \u7d2b\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[46;37m \u5929\u84dd\u5e95\u767d\u5b57 \\\\033[0m\\"\\necho -e \\"\\\\033[47;30m \u767d\u5e95\u9ed1\u5b57 \\\\033[0m\\"\\n```\\n\\n\u63a7\u5236\u9009\u9879\u8bf4\u660e \uff1a\\n\\n```\\n\\\\33[0m \u5173\u95ed\u6240\u6709\u5c5e\u6027 \\n\\\\33[1m \u8bbe\u7f6e\u9ad8\u4eae\u5ea6 \\n\\\\33[4m \u4e0b\u5212\u7ebf \\n\\\\33[5m \u95ea\u70c1 \\n\\\\33[7m \u53cd\u663e \\n\\\\33[8m \u6d88\u9690 \\n\\\\33[30m -- \\\\33[37m \u8bbe\u7f6e\u524d\u666f\u8272 \\n\\\\33[40m -- \\\\33[47m \u8bbe\u7f6e\u80cc\u666f\u8272 \\n\\\\33[nA \u5149\u6807\u4e0a\u79fbn\u884c \\n\\\\33[nB \u5149\u6807\u4e0b\u79fbn\u884c \\n\\\\33[nC \u5149\u6807\u53f3\u79fbn\u884c \\n\\\\33[nD \u5149\u6807\u5de6\u79fbn\u884c \\n\\\\33[y;xH\u8bbe\u7f6e\u5149\u6807\u4f4d\u7f6e \\n\\\\33[2J \u6e05\u5c4f \\n\\\\33[K \u6e05\u9664\u4ece\u5149\u6807\u5230\u884c\u5c3e\u7684\u5185\u5bb9 \\n\\\\33[s \u4fdd\u5b58\u5149\u6807\u4f4d\u7f6e \\n\\\\33[u \u6062\u590d\u5149\u6807\u4f4d\u7f6e \\n\\\\33[?25l \u9690\u85cf\u5149\u6807 \\n\\\\33[?25h \u663e\u793a\u5149\u6807 \\n```\\n\\n> \u8f6c\u81ea\uff1a[onlyzq \u7684BLOG - blog.51cto.com](http://onlyzq.blog.51cto.com/1228/546459)\\n\\n## Shell\u811a\u672c\u8c03\u8bd5\u65b9\u6cd5\\n\\nShell\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7528\u4e8e\u8c03\u8bd5\u811a\u672c\u7684\u9009\u9879\uff1a\\n\\n- `-n`\uff0c\u8bfb\u4e00\u904d\u811a\u672c\u4e2d\u7684\u547d\u4ee4\u4f46\u4e0d\u6267\u884c\uff0c\u7528\u4e8e\u68c0\u67e5\u811a\u672c\u4e2d\u7684\u8bed\u6cd5\u9519\u8bef\u3002\\n- `-v`\uff0c\u4e00\u8fb9\u6267\u884c\u811a\u672c\uff0c\u4e00\u8fb9\u5c06\u6267\u884c\u8fc7\u7684\u811a\u672c\u547d\u4ee4\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002\\n- `-x`\uff0c\u63d0\u4f9b\u8ddf\u8e2a\u6267\u884c\u4fe1\u606f\uff0c\u5c06\u6267\u884c\u7684\u6bcf\u4e00\u6761\u547d\u4ee4\u548c\u7ed3\u679c\u4f9d\u6b21\u6253\u5370\u51fa\u6765\u3002\\n\\n```shell\\nsh  -n function.sh\\nsh  -v function.sh\\nsh  -x function.sh\\n```"},{"id":"sec-command-usage-in-linux","metadata":{"permalink":"/blog/sec-command-usage-in-linux","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/09-17-sec-command-usage-in-linux.md","source":"@site/blog/2016/09-17-sec-command-usage-in-linux.md","title":"linux \u547d\u4ee4 sed \u8be6\u89e3","description":"sed\u662fstream editor\u7684\u7b80\u79f0\uff0c\u4e5f\u5c31\u662f\u6d41\u7f16\u8f91\u5668\u3002","date":"2016-09-17T11:28:00.000Z","formattedDate":"2016\u5e749\u670817\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"sed","permalink":"/blog/tags/sed"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":9.025,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"linux \u547d\u4ee4 sed \u8be6\u89e3","tags":["linux","sed","tools"],"date":"2016-09-17T11:28","slug":"sec-command-usage-in-linux","authors":["inhere","network"]},"prevItem":{"title":"Shell\u811a\u672c\u4f7f\u7528","permalink":"/blog/shell-script-learn-usage"},"nextItem":{"title":"Mysql\u7684\u9501\u673a\u5236\u89e3\u8bfb","permalink":"/blog/lock-intro-in-mysql"}},"content":"sed\u662fstream editor\u7684\u7b80\u79f0\uff0c\u4e5f\u5c31\u662f\u6d41\u7f16\u8f91\u5668\u3002\\n\u5b83\u4e00\u6b21\u5904\u7406\u4e00\u884c\u5185\u5bb9\uff0c\u5904\u7406\u65f6\uff0c\u628a\u5f53\u524d\u5904\u7406\u7684\u884c\u5b58\u50a8\u5728\u4e34\u65f6\u7f13\u51b2\u533a\u4e2d\uff0c\u79f0\u4e3a\u201c\u6a21\u5f0f\u7a7a\u95f4\u201d\uff08pattern space\uff09\uff0c\\n\u63a5\u7740\u7528sed\u547d\u4ee4\u5904\u7406\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\uff0c\u5904\u7406\u5b8c\u6210\u540e\uff0c\u628a\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u9001\u5f80\u5c4f\u5e55\u3002\\n\u63a5\u7740\u5904\u7406\u4e0b\u4e00\u884c\uff0c\u8fd9\u6837\u4e0d\u65ad\u91cd\u590d\uff0c\u76f4\u5230\u6587\u4ef6\u672b\u5c3e\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n\\n> TIP: \u6587\u4ef6\u5185\u5bb9\u5e76\u6ca1\u6709\u6539\u53d8\uff0c\u9664\u975e\u4f60\u4f7f\u7528\u91cd\u5b9a\u5411\u5b58\u50a8\u8f93\u51fa\u6216\u8005\u52a0\u4e86\u9009\u9879 `-i`\\n\\n## \u4f7f\u7528\u8bed\u6cd5\\n\\nsed\u547d\u4ee4\u7684\u4f7f\u7528\u89c4\u5219\u662f\u8fd9\u6837\u7684\uff1a\\n\\n```\\nsed [option] \'command\' input_file\\n```\\n\\n\u5176\u4e2doption\u662f\u53ef\u9009\u7684\uff0c\u5e38\u7528\u7684option\u6709\u5982\u4e0b\u51e0\u79cd\uff1a\\n\\n- `-n` \u4f7f\u7528\u5b89\u9759(silent)\u6a21\u5f0f\u3002\u5728\u4e00\u822csed\u7684\u7528\u6cd5\u4e2d\uff0c\u6240\u6709\u6765\u81eastdin\u7684\u5185\u5bb9\u4e00\u822c\u90fd\u4f1a\u88ab\u5217\u51fa\u5230\u5c4f\u5e55\u4e0a\u3002\u4f46\u5982\u679c\u52a0\u4e0a`-n`\u53c2\u6570\u540e\uff0c\u5219\u53ea\u6709\u7ecf\u8fc7sed\u7279\u6b8a\u5904\u7406\u7684\u90a3\u4e00\u884c(\u6216\u8005\u52a8\u4f5c)\u624d\u4f1a\u88ab\u5217\u51fa\u6765\uff1b\\n- `-e` \u76f4\u63a5\u5728\u6307\u4ee4\u5217\u6a21\u5f0f\u4e0a\u8fdb\u884c sed \u7684\u52a8\u4f5c\u7f16\u8f91\uff1b\\n- `-f` \u76f4\u63a5\u5c06 sed \u7684\u52a8\u4f5c\u5199\u5728\u4e00\u4e2a\u6587\u4ef6\u5185\uff0c `-f filename` \u5219\u53ef\u4ee5\u6267\u884cfilename\u5185\u7684sed\u547d\u4ee4\uff1b\\n- `-r` \u8ba9sed\u547d\u4ee4\u652f\u6301\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f(\u9ed8\u8ba4\u662f\u57fa\u7840\u6b63\u5219\u8868\u8fbe\u5f0f)\uff1b\\n- `-i` \u76f4\u63a5\u4fee\u6539\u8bfb\u53d6\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u800c\u4e0d\u662f\u7531\u5c4f\u5e55\u8f93\u51fa\u3002\\n\\n\u5e38\u7528\u7684\u547d\u4ee4\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a\\n\\n- `a`  append\u5373\u8ffd\u52a0\u5b57\u7b26\u4e32\uff0c a \u7684\u540e\u9762\u8ddf\u4e0a\u5b57\u7b26\u4e32s(\u591a\u884c\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528`\\\\n`\u5206\u9694)\uff0c\u5219\u4f1a\u5728\u5f53\u524d\u9009\u62e9\u7684\u884c\u7684\u540e\u9762\u90fd\u52a0\u4e0a\u5b57\u7b26\u4e32s\uff1b\\n- `c`  \u53d6\u4ee3/\u66ff\u6362\u5b57\u7b26\u4e32\uff0cc \u540e\u9762\u8ddf\u4e0a\u5b57\u7b26\u4e32s(\u591a\u884c\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528`\\\\n`\u5206\u9694)\uff0c\u5219\u4f1a\u5c06\u5f53\u524d\u9009\u4e2d\u7684\u884c\u66ff\u6362\u6210\u5b57\u7b26\u4e32s\uff1b\\n- `d`  delete\u5373\u5220\u9664\uff0c\u8be5\u547d\u4ee4\u4f1a\u5c06\u5f53\u524d\u9009\u4e2d\u7684\u884c\u5220\u9664\uff1b\\n- `i`  insert\u5373\u63d2\u5165\u5b57\u7b26\u4e32\uff0ci \u540e\u9762\u8ddf\u4e0a\u5b57\u7b26\u4e32s(\u591a\u884c\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528`\\\\n`\u5206\u9694)\uff0c\u5219\u4f1a\u5728\u5f53\u524d\u9009\u4e2d\u7684\u884c\u7684\u524d\u9762\u90fd\u63d2\u5165\u5b57\u7b26\u4e32s\uff1b\\n- `p` print\u5373\u6253\u5370\uff0c\u8be5\u547d\u4ee4\u4f1a\u6253\u5370\u5f53\u524d\u9009\u62e9\u7684\u884c\u5230\u5c4f\u5e55\u4e0a\uff1b\\n- `s` \u66ff\u6362\uff0c\u901a\u5e38s\u547d\u4ee4\u7684\u7528\u6cd5\u662f\u8fd9\u6837\u7684\uff1a`1\uff0c2s/old/new/g`\uff0c\u5c06old\u5b57\u7b26\u4e32\u66ff\u6362\u6210new\u5b57\u7b26\u4e32\\n\\n## \u547d\u4ee4\u793a\u4f8b\\n\\n\u5047\u8bbe\u6709\u4e00\u4e2a\u672c\u5730\u6587\u4ef6test.txt\uff0c\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a\\n\\n```\\n[user@computer ~]$ cat test.txt\\nthis is first line\\nthis is second line\\nhappy everyday\\nend\\n```\\n\\n\u672c\u8282\u5c06\u4f7f\u7528\u8be5\u6587\u4ef6\u8be6\u7ec6\u6f14\u793a\u6bcf\u4e00\u4e2a\u547d\u4ee4\u7684\u7528\u6cd5\u3002\\n\\n> \u6587\u4ef6\u5185\u5bb9\u5e76\u6ca1\u6709\u6539\u53d8\uff0c\u9664\u975e\u4f60\u4f7f\u7528\u91cd\u5b9a\u5411\u5b58\u50a8\u8f93\u51fa\u6216\u8005\u52a0\u4e86\u9009\u9879 `-i`\\n\\n### a \u547d\u4ee4\\n\\n```\\n[user@computer ~]$ sed \'1a \\\\add one\' test.txt\\nthis is first line\\nadd one\\nthis is second line\\nhappy everyday\\nend\\n```\\n\\n\u672c\u4f8b\u7684\u4f5c\u7528\u662f\u5728\u7b2c\u4e00\u884c\u4e4b\u540e\u589e\u52a0\u5b57\u7b26\u4e32\u201dadd one\u201d\uff0c\u4ece\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\u5177\u4f53\u6548\u679c\u3002\\n\u672c\u4f8b\u547d\u4ee4\u90e8\u5206\u8bf4\u660e\uff1a\\n\\n- 1\u8868\u793a\u7b2c\u4e00\u884c\uff0c\u540c\u6837\u7684\u7b2c\u4e8c\u884c\u5199\u62102\uff0c\u7b2c\u4e00\u884c\u5230\u7b2c\u4e09\u884c\u5199\u6210`1,3`\uff0c\\n- \u7528`$`\u8868\u793a\u6700\u540e\u4e00\u884c\uff0c\u6bd4\u5982`2,$`\u8868\u793a\u7b2c\u4e8c\u884c\u5230\u6700\u540e\u4e00\u884c\u4e2d\u95f4\u6240\u6709\u7684\u884c(\u5305\u542b\u7b2c\u4e8c\u884c\u548c\u6700\u540e\u4e00\u884c)\\n\\n\\n```\\n[user@computer ~]$ sed \'1,$a \\\\add one\' test.txt\\nthis is first line\\nadd one\\nthis is second line\\nadd one\\nhappy everyday\\nadd one\\nend\\nadd one\\n```\\n\\n\u672c\u4f8b\u8868\u793a\u5728\u7b2c\u4e00\u884c\u548c\u6700\u540e\u4e00\u884c\u6240\u6709\u7684\u884c\u540e\u9762\u90fd\u52a0\u4e0a\u201dadd one\u201d\u5b57\u7b26\u4e32\uff0c\u4ece\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\u6548\u679c\u3002\\n\\n```\\n[user@computer ~]$ sed \'/first/a \\\\add one\' test.txt\\nthis is first line\\nadd one\\nthis is second line\\nhappy everyday\\nend\\n```\\n\\n\u672c\u4f8b\u8868\u793a\u5728\u5305\u542b\u201dfirst\u201d\u5b57\u7b26\u4e32\u7684\u884c\u7684\u540e\u9762\u52a0\u4e0a\u5b57\u7b26\u4e32\u201dadd one\u201d\uff0c\u4ece\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u884c\u5305\u542bfirst\uff0c\u6240\u4ee5\u7b2c\u4e00\u884c\u4e4b\u540e\u589e\u52a0\u4e86\u201dadd one\u201d\\n\\n```\\n[user@computer ~]$ sed \'/^ha.*day$/a \\\\add one\' test.txt\\nthis is first line\\nthis is second line\\nhappy everyday\\nadd one\\nend\\n```\\n\\n\u672c\u4f8b\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u884c\\n\\n- `^ha.*day$`\u8868\u793a\u4ee5ha\u5f00\u5934\uff0c\u4ee5day\u7ed3\u5c3e\u7684\u884c\uff0c\u5219\u53ef\u4ee5\u5339\u914d\u5230\u6587\u4ef6\u7684\u201dhappy everyday\u201d\u8fd9\u6837\uff0c\u6240\u4ee5\u5728\u8be5\u884c\u540e\u9762\u589e\u52a0\u4e86\u201dadd one\u201d\u5b57\u7b26\u4e32\u3002\\n\\n### i \u547d\u4ee4\\n\\ni \u547d\u4ee4\u4f7f\u7528\u65b9\u6cd5\u548ca\u547d\u4ee4\u4e00\u6837\u7684\uff0c\u53ea\u4e0d\u8fc7\u662f\u5728\u5339\u914d\u7684 **\u884c\u7684\u524d\u9762** \u63d2\u5165\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u76f4\u63a5\u5c06\u4e0a\u9762a\u547d\u4ee4\u7684\u793a\u4f8b\u7684a\u66ff\u6362\u6210i\u5373\u53ef\uff0c\u5728\u6b64\u5c31\u4e0d\u5570\u55e6\u4e86\u3002\\n\\n#### mac \u4e0b\u7684\u95ee\u9898\\n\\nmac \u6267\u884c`sed -i`\u6307\u4ee4\u65f6\uff0c\u603b\u662f\u51fa\u73b0 `extra characters at the end of command` \u9519\u8bef\u63d0\u793a\u3002\\n\\nunix\u4e0elinux\u5728\u6267\u884csed\u6307\u4ee4\u662f\uff0c\u662f\u6709\u4e9b\u533a\u522b\uff0c\u6539\u6210\u5982\u4e0b\u5c31\u6b63\u786e\uff1a\\n\\n```\\n sed -i \\"\\" \\"s/192.168.0.2/192.168.0.3/g\\" *.rptdesign\\n```\\n\\n\u5c31\u662f\u5728`-i`\u6307\u4ee4\u540e\u9762\u591a\u52a0\u4e00\u4e2a`\\"\\"`\u7a7a\u683c\u5373\u53ef\u3002\\n\\n### c \u547d\u4ee4\\n\\n\u5c06\u6700\u540e\u4e00\u884c\u66ff\u6362\u6210\u5b57\u7b26\u4e32\u201dadd one\u201d\uff0c\u4ece\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\u6548\u679c\u3002\\n\\n```\\n[user@computer ~]$ sed \'$c \\\\add one\' test.txt\\nthis is first line\\nthis is second line\\nthis is third line\\nthis is fourth line\\nthis is     fifth line\\nhappy everyday\\nadd one\\n```\\n\\n\u5c06\u7b2c\u56db\u884c\u5230\u6700\u540e\u4e00\u884c\u7684\u5185\u5bb9\u66ff\u6362\u6210\u5b57\u7b26\u4e32\u201dadd one\u201d\u3002\\n\\n```\\n[user@computer ~]$ sed \'4,$c \\\\add one\' test.txt\\nthis is first line\\nthis is second line\\nthis is third line\\nadd one\\n```\\n\\n\u5c06\u4ee5ha\u5f00\u5934\uff0c\u4ee5day\u7ed3\u5c3e\u7684\u884c\u66ff\u6362\u6210\u201dreplace line\u201d\u3002\\n\\n```\\n[user@computer ~]$ sed \'/^ha.*day$/c \\\\replace line\' test.txt\\nthis is first line\\nthis is second line\\nreplace line\\nend\\n```\\n\\n### d \u547d\u4ee4\\n\\n\u672c\u4f8b\u5220\u9664\u4ee5ha\u5f00\u5934\uff0c\u4ee5day\u7ed3\u5c3e\u7684\u884c\u3002\\n\\n```\\n[user@computer ~]$ sed \'/^ha.*day$/d\' test.txt\\nthis is first line\\nthis is second line\\nend\\n```\\n\\n\u672c\u4f8b\u5220\u9664\u7b2c\u56db\u884c\u5230\u6700\u540e\u4e00\u884c\u4e2d\u7684\u5185\u5bb9\u3002\\n\\n```\\n[user@computer ~]$ sed \'4,$d\' test.txt\\nthis is first line\\nthis is second line\\nthis is third line\\n```\\n\\n### p \u547d\u4ee4\\n\\n\u5728\u5c4f\u5e55\u4e0a\u6253\u5370\u7b2c\u56db\u884c\u5230\u6700\u540e\u4e00\u884c\u7684\u5185\u5bb9\uff0cp\u547d\u4ee4\u4e00\u822c\u548c-n\u9009\u9879\u4e00\u8d77\u4f7f\u7528\u3002\\n\\n```\\n[user@computer ~]$ sed -n \'4,$p\' test.txt\\nthis is fourth line\\nthis is fifth line\\nhappy everyday\\nend\\n```\\n\\n\u672c\u4f8b\u6253\u5370\u4ee5ha\u5f00\u59cb\uff0c\u4ee5day\u7ed3\u5c3e\u7684\u884c\u3002\\n\\n```\\n[user@computer ~]$ sed -n \'/^ha.*day$/p\' test.txt\\nhappy everyday\\n```\\n\\n### s \u547d\u4ee4\\n\\n\u5b9e\u9645\u8fd0\u7528\u4e2ds\u547d\u4ee4\u5f0f\u6700\u5e38\u4f7f\u7528\u5230\u7684\u3002\\n\u793a\u4f8b\uff1a\\n\\n\u5c06\u6587\u4ef6\u4e2d\u7684\u6240\u6709`line`\u66ff\u6362\u6210`text`\u3002\\n\\n- \u6700\u540e\u7684g\u662fglobal\u7684\u610f\u601d\uff0c\u4e5f\u5c31\u662f\u5168\u5c40\u66ff\u6362\uff0c\u5982\u679c\u4e0d\u52a0g\uff0c\u5219\u53ea\u4f1a\u66ff\u6362\u672c\u884c\u7684\u7b2c\u4e00\u4e2aline\u3002\\n\\n```\\n[user@computer ~]$ sed \'s/line/text/g\' test.txt\\nthis is first text\\nthis is second text\\nhappy everyday\\nend\\n```\\n\\n\u66ff\u6362\u5339\u914d\u884c\u4e2d\u7684\u67d0\u4e2a\u5b57\u7b26\u4e32\\n\\n\u9996\u5148\u5339\u914d\u4ee5ha\u5f00\u59cb\uff0c\u4ee5day\u7ed3\u5c3e\u7684\u884c\uff0c\u672c\u4f8b\u4e2d\u5339\u914d\u5230\u7684\u884c\u662f\u201dhappy everyday\u201d\u8fd9\u6837\uff0c\u7136\u540e\u518d\u5c06\u8be5\u884c\u4e2d\u7684happy\u66ff\u6362\u6210very happy\u3002\\n\\n```\\n[user@computer ~]$ sed \'/^ha.*day$/s/happy/very happy/g\' test.txt\\nthis is first line\\nthis is second line\\nvery happy everyday\\nend\\n```\\n\\n\u5f15\u7528\u66ff\u6362\\n\\n```\\n[user@computer ~]$ sed \'s/\\\\(.*\\\\)line$/\\\\1/g\' test.txt\\nthis is first\\nthis is second\\nhappy everyday\\nend\\n```\\n\\n\u8fd9\u4e2a\u4f8b\u5b50\u6709\u70b9\u590d\u6742\uff0c\u5148\u5206\u89e3\u4e00\u4e0b\u3002\\n\\n\u9996\u5148s\u547d\u4ee4\u7684\u6a21\u5f0f\u662f`s/old/new/g`\u8fd9\u6837\u7684\uff0c\u6240\u4ee5\u672c\u4f8b\u7684old\u90e8\u5206\u5373`\\\\(.*\\\\)line$`,sed\u547d\u4ee4\u4e2d\u4f7f\u7528`\\\\(\\\\)`\u5305\u88f9\u7684\u5185\u5bb9\u8868\u793a\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7b2cn\u90e8\u5206\uff0c\\n\u5e8f\u53f7\u4ece1\u5f00\u59cb\u8ba1\u7b97\uff0c\u672c\u4f8b\u4e2d\u53ea\u6709\u4e00\u4e2a`\\\\(\\\\)`\u6240\u4ee5`\\\\(.*\\\\)`\u8868\u793a\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\\n\u8fd9\u90e8\u5206\u5339\u914d\u4efb\u610f\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5`\\\\(.*\\\\)line$`\u5339\u914d\u7684\u5c31\u662f\u4ee5line\u7ed3\u5c3e\u7684\u4efb\u4f55\u884c\u3002\\n\\n\u7136\u540e\u5c06\u5339\u914d\u5230\u7684\u884c\u66ff\u6362\u6210\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7b2c\u4e00\u90e8\u5206\uff08\u672c\u4f8b\u4e2d\u76f8\u5f53\u4e8e\u5220\u9664line\u90e8\u5206\uff09\uff0c\u4f7f\u7528`\\\\1`\u8868\u793a\u5339\u914d\u5230\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\\n\u540c\u6837`\\\\2`\u8868\u793a\u7b2c\u4e8c\u90e8\u5206\uff0c`\\\\3`\u8868\u793a\u7b2c\u4e09\u90e8\u5206\uff0c\u53ef\u4ee5\u4f9d\u6b21\u8fd9\u6837\u5f15\u7528\u3002\u6bd4\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\uff1a\\n\\n```\\n[user@computer ~]$ sed \'s/\\\\(.*\\\\)is\\\\(.*\\\\)line/\\\\1\\\\2/g\' test.txt\\nthis  first\\nthis  second\\nhappy everyday\\nend\\n```\\n\\n\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2dis\u4e24\u8fb9\u7684\u90e8\u5206\u53ef\u4ee5\u7528`\\\\1`\u548c`\\\\2`\u8868\u793a\uff0c\u8be5\u4f8b\u5b50\u7684\u4f5c\u7528\u5176\u5b9e\u5c31\u662f\u5220\u9664\u4e2d\u95f4\u90e8\u5206\u7684is\u3002\\n\\n> \u8f6c\u8f7d\u6574\u7406\u81ea\uff1a[sed\u547d\u4ee4\u8be6\u89e3](http://qifuguang.me/2015/09/21/sed%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3/)"},{"id":"lock-intro-in-mysql","metadata":{"permalink":"/blog/lock-intro-in-mysql","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/09-07-lock-intro-in-mysql.md","source":"@site/blog/2016/09-07-lock-intro-in-mysql.md","title":"Mysql\u7684\u9501\u673a\u5236\u89e3\u8bfb","description":"Mysql\u7684\u9501\u673a\u5236\u89e3\u8bfb\u8bf4\u660e","date":"2016-09-07T21:17:00.000Z","formattedDate":"2016\u5e749\u67087\u65e5","tags":[{"label":"mysql","permalink":"/blog/tags/mysql"},{"label":"lock","permalink":"/blog/tags/lock"}],"readingTime":13.14,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"Mysql\u7684\u9501\u673a\u5236\u89e3\u8bfb","tags":["mysql","lock"],"date":"2016-09-07T21:17","slug":"lock-intro-in-mysql","authors":"inhere"},"prevItem":{"title":"linux \u547d\u4ee4 sed \u8be6\u89e3","permalink":"/blog/sec-command-usage-in-linux"},"nextItem":{"title":"Linux \u547d\u4ee4\u795e\u5668 lsof \u5165\u95e8","permalink":"/blog/lsof-command-usage-in-linux"}},"content":"Mysql\u7684\u9501\u673a\u5236\u89e3\u8bfb\u8bf4\u660e\\n\\n\x3c!--truncate--\x3e\\n\\n## \u57fa\u672c\u6982\u5ff5\\n\\n### \u5171\u4eab\u9501\\n\\n\u5171\u4eab\u9501\u7684\u4ee3\u53f7\u662f`S`\uff0c\u662fShare\u7684\u7f29\u5199\uff0c\u5171\u4eab\u9501\u7684\u9501\u7c92\u5ea6\u662f\u884c\u6216\u8005\u5143\u7ec4\uff08\u591a\u4e2a\u884c\uff09\u3002\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u5171\u4eab\u9501\u4e4b\u540e\uff0c\u53ef\u4ee5\u5bf9\u9501\u5b9a\u8303\u56f4\u5185\u7684\u6570\u636e**\u6267\u884c\u8bfb\u64cd\u4f5c**\u3002 \\n\\n### \u6392\u5b83\u9501\\n\\n\u6392\u5b83\u9501\u7684\u4ee3\u53f7\u662f`X`\uff0c\u662feXclusive\u7684\u7f29\u5199\uff0c\u6392\u5b83\u9501\u7684\u7c92\u5ea6\u4e0e\u5171\u4eab\u9501\u76f8\u540c\uff0c\u4e5f\u662f\u884c\u6216\u8005\u5143\u7ec4\u3002\u4e00\u4e2a\u4e8b\u52a1\u83b7\u53d6\u4e86\u6392\u5b83\u9501\u4e4b\u540e\uff0c\u53ef\u4ee5\u5bf9\u9501\u5b9a\u8303\u56f4\u5185\u7684\u6570\u636e**\u6267\u884c\u5199\u64cd\u4f5c**\u3002\\n\\n\u4f8b\uff1a\u5047\u8bbe\u6709\u4e24\u4e2a\u4e8b\u52a1t1\u548ct2\\n\\n\u5982\u679c\u4e8b\u52a1t1\u83b7\u53d6\u4e86\u4e00\u4e2a\u5143\u7ec4\u7684\u5171\u4eab\u9501\uff0c\u4e8b\u52a1t2\u8fd8\u53ef\u4ee5\u7acb\u5373\u83b7\u53d6\u8fd9\u4e2a\u5143\u7ec4\u7684\u5171\u4eab\u9501\uff0c\u4f46\u4e0d\u80fd\u7acb\u5373\u83b7\u53d6\u8fd9\u4e2a\u5143\u7ec4\u7684\u6392\u5b83\u9501\uff08\u5fc5\u987b\u7b49\u5230t1\u91ca\u653e\u5171\u4eab\u9501\u4e4b\u540e\uff09\u3002\\n\u5982\u679c\u4e8b\u52a1t1\u83b7\u53d6\u4e86\u4e00\u4e2a\u5143\u7ec4\u7684\u6392\u5b83\u9501\uff0c\u4e8b\u52a1t2\u4e0d\u80fd\u7acb\u5373\u83b7\u53d6\u8fd9\u4e2a\u5143\u7ec4\u7684\u6392\u5171\u4eab\u9501\uff0c\u4e5f\u4e0d\u80fd\u7acb\u5373\u83b7\u53d6\u8fd9\u4e2a\u5143\u7ec4\u7684\u6392\u5b83\u9501\uff08\u5fc5\u987b\u7b49\u5230t1\u91ca\u653e\u6392\u5b83\u9501\u4e4b\u540e\uff09\u3002\\n\\n### \u610f\u5411\u9501\\n\\n\u610f\u5411\u9501\u662f**\u4e00\u79cd\u8868\u9501\uff0c\u9501\u5b9a\u7684\u7c92\u5ea6\u662f\u6574\u5f20\u8868**\uff0c\u5206\u4e3a**\u610f\u5411\u5171\u4eab\u9501(IS)**\u548c**\u610f\u5411\u6392\u5b83\u9501(IX)**\u4e24\u7c7b\u3002\\n\\n\u610f\u5411\u5171\u4eab\u9501\u8868\u793a\u4e00\u4e2a\u4e8b\u52a1\u6709\u610f\u5bf9\u6570\u636e\u4e0a\u5171\u4eab\u9501\u6216\u8005\u6392\u5b83\u9501\u3002\u201c\u6709\u610f\u201d\u8fd9\u4e24\u4e2a\u5b57\u8868\u8fbe\u7684\u610f\u601d\u6bd4\u8f83\u5fae\u5999\uff0c\u8bf4\u7684\u660e\u767d\u70b9\u5c31\u662f\u6307\u4e8b\u52a1\u60f3\u5e72\u8fd9\u4e2a\u4e8b\u4f46\u8fd8\u6ca1\u771f\u53bb\u5e72\u3002\\n\u4e3e\u4f8b\u8bf4\u660e\u4e0b\u610f\u5411\u5171\u4eab\u9501\uff0c\u6bd4\u5982\u4e00\u4e2a\u4e8b\u52a1t\u6267\u884c\u4e86\u8fd9\u6837\u4e00\u4e2a\u8bed\u53e5\uff1a`select * from table lock in share model` \uff0c\u5982\u679c\u8fd9\u4e2a\u8bed\u53e5\u6267\u884c\u6210\u529f\uff0c\u5c31\u5bf9\u8868table\u4e0a\u4e86\u4e00\u4e2a\u610f\u5411\u5171\u4eab\u9501\u3002\\n`lock in share model` \u5c31\u662f\u8bf4\u4e8b\u52a1t1\u5728\u63a5\u4e0b\u6765\u8981\u6267\u884c\u7684\u8bed\u53e5\u4e2d\u8981\u83b7\u53d6S\u9501\u3002\u5982\u679ct1\u7684`select * from table lock in share model`\u6267\u884c\u6210\u529f\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765t1\u5e94\u8be5\u53ef\u4ee5\u7545\u901a\u65e0\u963b\u7684\u53bb\u6267\u884c\u53ea\u9700\u8981\u5171\u4eab\u9501\u7684\u8bed\u53e5\u4e86\u3002\\n\\n\u610f\u5411\u6392\u5b83\u9501\u7684\u542b\u4e49\u540c\u7406\u53ef\u77e5\uff0c\u4e0a\u4f8b\u4e2d\u8981\u83b7\u53d6\u610f\u5411\u6392\u5b83\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528`select * from table for update` \u3002\\n\\n`lock in share model` \u548c `for update`\u8fd9\u4e24\u4e2a\u4e1c\u897f\u5728\u6570\u636e\u7387\u7406\u8bba\u4e2d\u8fd8\u6709\u4e2a\u5b66\u540d\u53eb**\u60b2\u89c2\u9501**\uff0c\u4e0e\u60b2\u89c2\u9501\u76f8\u5bf9\u7684\u5f53\u7136\u8fd8\u6709\u4e50\u89c2\u9501\u3002\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\u5404\u79cd\u9501\u90fd\u662f\u6210\u53cc\u6210\u5bf9\u51fa\u73b0\u7684\u3002\u5173\u4e8e\u60b2\u89c2\u9501\u548c\u4e50\u89c2\u9501\u7684\u95ee\u9898\u6682\u4e14\u4e0d\u8868\u3002 \\n\\n\\n### \u9501\u7684\u4e92\u65a5\u4e0e\u517c\u5bb9\u5173\u7cfb\\n\\n\u9501\u548c\u9501\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u8981\u4e48\u662f\u76f8\u5bb9\u7684\uff0c\u8981\u4e48\u662f\u4e92\u65a5\u7684\u3002\\n\u9501a\u548c\u9501b\u76f8\u5bb9\u662f\u6307\uff1a\u64cd\u4f5c\u540c\u6837\u4e00\u7ec4\u6570\u636e\u65f6\uff0c\u5982\u679c\u4e8b\u52a1t1\u83b7\u53d6\u4e86\u9501a,\u53e6\u4e00\u4e2a\u4e8b\u52a1t2\u8fd8\u53ef\u4ee5\u83b7\u53d6\u9501b\uff1b\\n\u9501a\u548c\u9501b\u4e92\u65a5\u662f\u6307\uff1a\u64cd\u4f5c\u540c\u6837\u4e00\u7ec4\u6570\u636e\u65f6\uff0c\u5982\u679c\u4e8b\u52a1t1\u83b7\u53d6\u4e86\u9501a\uff0c\u53e6\u4e00\u4e2a\u4e8b\u52a1t2\u5728t1\u91ca\u653e\u9501a\u4e4b\u524d\u65e0\u6cd5\u83b7\u53d6\u9501b\u3002\\n\\n\u4e0a\u9762\u63d0\u5230\u7684\u5171\u4eab\u9501\u3001\u6392\u5b83\u9501\u3001\u610f\u5411\u5171\u4eab\u9501\u3001\u610f\u5411\u6392\u5b83\u9501\u76f8\u4e92\u4e4b\u524d\u90fd\u662f\u6709\u517c\u5bb9/\u4e92\u65a5\u5173\u7cfb\u7684\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u517c\u5bb9\u6027\u77e9\u9635\u8868\u793a(y\u8868\u793a\u517c\u5bb9\uff0cn\u8868\u793a\u4e0d\u517c\u5bb9):\\n\\n```\\n    X    S    IX    IS\\nX  n     n    n     n\\nS  n     y    n     y\\nIX n     n    y     y\\nIS n     y    y     y  \\n```\\n\\n\u517c\u5bb9\u6027\u77e9\u9635\u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\uff1f\\n\\nX\u548cS\u7684\u76f8\u4e92\u5173\u7cfb\u5728\u4e0a\u6587\u4e2d\u89e3\u91ca\u8fc7\u4e86\uff0cIX\u548cIS\u7684\u76f8\u4e92\u5173\u7cfb\u5168\u90e8\u662f\u517c\u5bb9\uff0c\u8fd9\u4e5f\u5f88\u597d\u7406\u89e3\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd\u53ea\u662f\u201c\u6709\u610f\u201d\uff0c\u8fd8\u5904\u4e8eYY\u9636\u6bb5\uff0c\u6ca1\u6709\u771f\u5e72\uff0c\u6240\u4ee5\u662f\u53ef\u4ee5\u517c\u5bb9\u7684\uff1b\\n\u5269\u4e0b\u7684\u5c31\u662fX\u548cIX\uff0cX\u548cIS, S\u548cIX\uff0c S\u548cIS\u7684\u5173\u7cfb\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u7531X\u548cS\u7684\u5173\u7cfb\u63a8\u5bfc\u51fa\u8fd9\u56db\u7ec4\u5173\u7cfb\u3002\\n\\n\u7b80\u5355\u7684\u8bf4\uff1aX\u548cIX\u7684=X\u548cX\u7684\u5173\u7cfb\u3002\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u4e8b\u52a1\u5728\u83b7\u53d6IX\u9501\u540e\uff0c\u63a5\u4e0b\u6765\u5c31\u6709\u6743\u5229\u83b7\u53d6X\u9501\u3002\u5982\u679cX\u548cIX\u517c\u5bb9\u7684\u8bdd\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e24\u4e2a\u4e8b\u52a1\u90fd\u83b7\u53d6\u4e86X\u9501\u7684\u60c5\u51b5\uff0c\u8fd9\u4e0e\u6211\u4eec\u5df2\u77e5\u7684X\u4e0eX\u4e92\u65a5\u662f\u77db\u76fe\u7684\uff0c\u6240\u4ee5X\u4e0eIX\u53ea\u80fd\u662f\u4e92\u65a5\u5173\u7cfb\u3002\\n\\n\u5176\u4f59\u7684\u4e09\u7ec4\u5173\u7cfb\u540c\u7406\uff0c\u53ef\u7528\u540c\u6837\u7684\u65b9\u5f0f\u63a8\u5bfc\u51fa\u6765\u3002\\n\\n## MySQL\u6709\u4e09\u79cd\u9501\u7684\u7ea7\u522b\uff1a\u9875\u7ea7\u3001\u8868\u7ea7\u3001\u884c\u7ea7\u3002\\n\\nMyISAM\u548cMEMORY\u5b58\u50a8\u5f15\u64ce\u91c7\u7528\u7684\u662f**\u8868\u7ea7\u9501\uff08table-level locking\uff09**\uff1b\\nBDB\u5b58\u50a8\u5f15\u64ce\u91c7\u7528\u7684\u662f**\u9875\u9762\u9501\uff08page-level locking\uff09**\uff0c\u4f46\u4e5f\u652f\u6301\u8868\u7ea7\u9501\uff1b\\nInnoDB\u5b58\u50a8\u5f15\u64ce\u65e2\u652f\u6301**\u884c\u7ea7\u9501\uff08row-level locking\uff09**\uff0c\u4e5f\u652f\u6301\u8868\u7ea7\u9501\uff0c\u4f46\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u91c7\u7528\u884c\u7ea7\u9501\u3002\\n\\nMySQL\u8fd93\u79cd\u9501\u7684\u7279\u6027\u53ef\u5927\u81f4\u5f52\u7eb3\u5982\u4e0b\uff1a\\n\\n- \u8868\u7ea7\u9501\uff1a\u5f00\u9500\u5c0f\uff0c\u52a0\u9501\u5feb\uff1b\u4e0d\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u5927\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u9ad8,\u5e76\u53d1\u5ea6\u6700\u4f4e\u3002\\n- \u884c\u7ea7\u9501\uff1a\u5f00\u9500\u5927\uff0c\u52a0\u9501\u6162\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u6700\u5c0f\uff0c\u53d1\u751f\u9501\u51b2\u7a81\u7684\u6982\u7387\u6700\u4f4e,\u5e76\u53d1\u5ea6\u4e5f\u6700\u9ad8\u3002\\n- \u9875\u9762\u9501\uff1a\u5f00\u9500\u548c\u52a0\u9501\u65f6\u95f4\u754c\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff1b\u4f1a\u51fa\u73b0\u6b7b\u9501\uff1b\u9501\u5b9a\u7c92\u5ea6\u754c\u4e8e\u8868\u9501\u548c\u884c\u9501\u4e4b\u95f4\uff0c\u5e76\u53d1\u5ea6\u4e00\u822c\u3002\\n\\n## MyISAM\u8868\u9501\\n\\nMyISAM\u5b58\u50a8\u5f15\u64ce\u53ea\u652f\u6301\u8868\u9501\uff0c\u662f\u73b0\u5728\u7528\u5f97\u6700\u591a\u7684\u5b58\u50a8\u5f15\u64ce\u3002\\n\\n### 1\u3001\u67e5\u8be2\u8868\u7ea7\u9501\u4e89\u7528\u60c5\u51b5\\n\\n\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5table_locks_waited\u548ctable_locks_immediate\u72b6\u6001\u53d8\u91cf\u6765\u5206\u6790\u7cfb\u7edf\u4e0a\u7684\u8868\u9501\u5b9a\u4e89\u593a\uff1a\\nmysql> show status like \u2018table%\u2019;\\n+\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2013+\u2014\u2014\u2014-+\\n| Variable_name | Value |\\n+\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2013+\u2014\u2014\u2014-+\\n| Table_locks_immediate | 76939364 |\\n| Table_locks_waited | 305089 |\\n+\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2013+\u2014\u2014\u2014-+\\n2 rows in set (0.00 sec)Table_locks_waited\u7684\u503c\u6bd4\u8f83\u9ad8\uff0c\u8bf4\u660e\u5b58\u5728\u7740\u8f83\u4e25\u91cd\u7684\u8868\u7ea7\u9501\u4e89\u7528\u60c5\u51b5\u3002\\n\\n### 2\u3001MySQL\u8868\u7ea7\u9501\u7684\u9501\u6a21\u5f0f\\n\\nMySQL\u7684\u8868\u7ea7\u9501\u6709\u4e24\u79cd\u6a21\u5f0f\uff1a**\u8868\u5171\u4eab\u8bfb\u9501\uff08Table Read Lock\uff09**\u548c **\u8868\u72ec\u5360\u5199\u9501\uff08Table Write Lock\uff09**\u3002\\n\\n> MyISAM\u5728\u6267\u884c\u67e5\u8be2\u8bed\u53e5\uff08SELECT\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u6240\u6709\u8868\u52a0\u8bfb\u9501\uff0c\u5728\u6267\u884c\u66f4\u65b0\u64cd\u4f5c\uff08UPDATE\u3001DELETE\u3001INSERT\u7b49\uff09\u524d\uff0c\u4f1a\u81ea\u52a8\u7ed9\u6d89\u53ca\u7684\u8868\u52a0\u5199\u9501\u3002\\n\\n\u6240\u4ee5\u5bf9MyISAM\u8868\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f1a\u6709\u4ee5\u4e0b\u60c5\u51b5\uff1a\\n\\na. \u5bf9MyISAM\u8868\u7684\u8bfb\u64cd\u4f5c\uff08\u52a0\u8bfb\u9501\uff09\uff0c\u4e0d\u4f1a\u963b\u585e\u5176\u4ed6\u8fdb\u7a0b\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u8bf7\u6c42\uff0c\u4f46\u4f1a\u963b\u585e\u5bf9\u540c\u4e00\u8868\u7684\u5199\u8bf7\u6c42\u3002\u53ea\u6709\u5f53\u8bfb\u9501\u91ca\u653e\u540e\uff0c\u624d\u4f1a\u6267\u884c\u5176\u5b83\u8fdb\u7a0b\u7684\u5199\u64cd\u4f5c\u3002\\nb. \u5bf9MyISAM\u8868\u7684\u5199\u64cd\u4f5c\uff08\u52a0\u5199\u9501\uff09\uff0c\u4f1a\u963b\u585e\u5176\u4ed6\u8fdb\u7a0b\u5bf9\u540c\u4e00\u8868\u7684\u8bfb\u548c\u5199\u64cd\u4f5c\uff0c\u53ea\u6709\u5f53\u5199\u9501\u91ca\u653e\u540e\uff0c\u624d\u4f1a\u6267\u884c\u5176\u5b83\u8fdb\u7a0b\u7684\u8bfb\u5199\u64cd\u4f5c\u3002\\n\\n\u4e0b\u9762\u901a\u8fc7\u4f8b\u5b50\u6765\u8fdb\u884c\u9a8c\u8bc1\u4ee5\u4e0a\u89c2\u70b9\u3002\u6570\u636e\u8868gz_phone\u91cc\u6709\u4e8c\u767e\u591a\u4e07\u6570\u636e\uff0c\u5b57\u6bb5id,phone,ua,day\u3002\u73b0\u5728\u540c\u65f6\u7528\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u5bf9\u8be5\u8868\u8fdb\u884c\u64cd\u4f5c\u5206\u6790\u3002\\n\\na\u3001\u5f53\u6211\u7528\u5ba2\u6237\u7aef1\u8fdb\u884c\u4e00\u4e2a\u6bd4\u8f83\u957f\u65f6\u95f4\u7684\u8bfb\u64cd\u4f5c\u65f6\uff0c\u5206\u522b\u7528\u5ba2\u6237\u7aef2\u8fdb\u884c\u8bfb\u548c\u5199\u64cd\u4f5c\uff1a\\n```\\n\\nclient1:\\nmysql>select count(*) from gz_phone group by ua;\\n75508 rows in set (3 min 15.87 sec) client2:\\nselect id,phone from gz_phone limit 1000,10;\\n+\u2014\u2014+\u2014\u2014-+\\n| id | phone |\\n+\u2014\u2014+\u2014\u2014-+\\n| 1001 | 2222 |\\n| 1002 | 2222 |\\n| 1003 | 2222 |\\n| 1004 | 2222 |\\n| 1005 | 2222 |\\n| 1006 | 2222 |\\n| 1007 | 2222 |\\n| 1008 | 2222 |\\n| 1009 | 2222 |\\n| 1010 | 2222 |\\n+\u2014\u2014+\u2014\u2014-+\\n10 rows in set (0.01 sec)\\nmysql> update gz_phone set phone=\u201911111111111\u2032where id=1001;\\nQuery OK, 0 rows affected (2 min 57.88 sec)\\nRows matched: 1 Changed: 0 Warnings: 0\\n```\\n\\n\u8bf4\u660e\u5f53\u6570\u636e\u8868\u6709\u4e00\u4e2a\u8bfb\u9501\u65f6\uff0c\u5176\u5b83\u8fdb\u7a0b\u7684\u67e5\u8be2\u64cd\u4f5c\u53ef\u4ee5\u9a6c\u4e0a\u6267\u884c\uff0c\u4f46\u66f4\u65b0\u64cd\u4f5c\u9700\u7b49\u5f85\u8bfb\u9501\u91ca\u653e\u540e\u624d\u4f1a\u6267\u884c\u3002\\n\\nb\u3001\u5f53\u7528\u5ba2\u6237\u7aef1\u8fdb\u884c\u4e00\u4e2a\u8f83\u957f\u65f6\u95f4\u7684\u66f4\u65b0\u64cd\u4f5c\u65f6\uff0c\u7528\u5ba2\u6237\u7aef2,3\u5206\u522b\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\uff1a\\n\\n```\\nclient1:\\nmysql> update gz_phone set phone=\u201911111111111\u2032;\\nQuery OK, 1671823 rows affected (3 min 4.03 sec)\\nRows matched: 2212070 Changed: 1671823 Warnings: 0 client2:\\nmysql> select id,phone,ua,day from gz_phone limit 10;\\n+\u2014-+\u2014\u2014-+\u2014\u2014\u2014\u2014\u2014\u2014-+\u2014\u2014\u2014\u2014+\\n| id | phone | ua | day |\\n+\u2014-+\u2014\u2014-+\u2014\u2014\u2014\u2014\u2014\u2014-+\u2014\u2014\u2014\u2014+\\n| 1 | 2222 | SonyEricssonK310c | 2007-12-19 |\\n| 2 | 2222 | SonyEricssonK750c | 2007-12-19 |\\n| 3 | 2222 | MAUI WAP Browser | 2007-12-19 |\\n| 4 | 2222 | Nokia3108 | 2007-12-19 |\\n| 5 | 2222 | LENOVO-I750 | 2007-12-19 |\\n| 6 | 2222 | BIRD_D636 | 2007-12-19 |\\n| 7 | 2222 | SonyEricssonS500c | 2007-12-19 |\\n| 8 | 2222 | SAMSUNG-SGH-E258 | 2007-12-19 |\\n| 9 | 2222 | NokiaN73-1 | 2007-12-19 |\\n| 10 | 2222 | Nokia2610 | 2007-12-19 |\\n+\u2014-+\u2014\u2014-+\u2014\u2014\u2014\u2014\u2014\u2014-+\u2014\u2014\u2014\u2014+\\n10 rows in set (2 min 58.56 sec) client3:\\nmysql> update gz_phone set phone=\u201955555\u2032where id=1;\\nQuery OK, 1 row affected (3 min 50.16 sec)\\nRows matched: 1 Changed: 1 Warnings: 0\\n```\\n\\n\u8bf4\u660e\u5f53\u6570\u636e\u8868\u6709\u4e00\u4e2a\u5199\u9501\u65f6\uff0c\u5176\u5b83\u8fdb\u7a0b\u7684\u8bfb\u5199\u64cd\u4f5c\u90fd\u9700\u7b49\u5f85\u8bfb\u9501\u91ca\u653e\u540e\u624d\u4f1a\u6267\u884c\u3002\\n\\n### 3\u3001\u5e76\u53d1\u63d2\u5165\\n\\n\u539f\u5219\u4e0a\u6570\u636e\u8868\u6709\u4e00\u4e2a\u8bfb\u9501\u65f6\uff0c\u5176\u5b83\u8fdb\u7a0b\u65e0\u6cd5\u5bf9\u6b64\u8868\u8fdb\u884c\u66f4\u65b0\u64cd\u4f5c\uff0c\u4f46\u5728\u4e00\u5b9a\u6761\u4ef6\u4e0b\uff0cMyISAM\u8868\u4e5f\u652f\u6301\u67e5\u8be2\u548c\u63d2\u5165\u64cd\u4f5c\u7684\u5e76\u53d1\u8fdb\u884c\u3002\\n\\nMyISAM\u5b58\u50a8\u5f15\u64ce\u6709\u4e00\u4e2a\u7cfb\u7edf\u53d8\u91cfconcurrent_insert\uff0c\u4e13\u95e8\u7528\u4ee5\u63a7\u5236\u5176\u5e76\u53d1\u63d2\u5165\u7684\u884c\u4e3a\uff0c\u5176\u503c\u5206\u522b\u53ef\u4ee5\u4e3a0\u30011\u62162\u3002\\n\\na. \u5f53concurrent_insert\u8bbe\u7f6e\u4e3a0\u65f6\uff0c\u4e0d\u5141\u8bb8\u5e76\u53d1\u63d2\u5165\u3002\\nb. \u5f53concurrent_insert\u8bbe\u7f6e\u4e3a1\u65f6\uff0c\u5982\u679cMyISAM\u8868\u4e2d\u6ca1\u6709\u7a7a\u6d1e\uff08\u5373\u8868\u7684\u4e2d\u95f4\u6ca1\u6709\u88ab\u5220\u9664\u7684\u884c\uff09\uff0cMyISAM\u5141\u8bb8\u5728\u4e00\u4e2a\u8fdb\u7a0b\u8bfb\u8868\u7684\u540c\u65f6\uff0c\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u4ece\u8868\u5c3e\u63d2\u5165\u8bb0\u5f55\u3002\u8fd9\u4e5f\u662fMySQL\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u3002\\nc. \u5f53concurrent_insert\u8bbe\u7f6e\u4e3a2\u65f6\uff0c\u65e0\u8bbaMyISAM\u8868\u4e2d\u6709\u6ca1\u6709\u7a7a\u6d1e\uff0c\u90fd\u5141\u8bb8\u5728\u8868\u5c3e\u5e76\u53d1\u63d2\u5165\u8bb0\u5f55\u3002\\n\\n### 4\u3001MyISAM\u7684\u9501\u8c03\u5ea6\\n\\n\u7531\u4e8eMySQL\u8ba4\u4e3a\u5199\u8bf7\u6c42\u4e00\u822c\u6bd4\u8bfb\u8bf7\u6c42\u8981\u91cd\u8981\uff0c\u6240\u4ee5\u5982\u679c\u6709\u8bfb\u5199\u8bf7\u6c42\u540c\u65f6\u8fdb\u884c\u7684\u8bdd\uff0cMYSQL\u5c06\u4f1a\u4f18\u5148\u6267\u884c\u5199\u64cd\u4f5c\u3002\u8fd9\u6837MyISAM\u8868\u5728\u8fdb\u884c\u5927\u91cf\u7684\u66f4\u65b0\u64cd\u4f5c\u65f6\uff08\u7279\u522b\u662f\u66f4\u65b0\u7684\u5b57\u6bb5\u4e2d\u5b58\u5728\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff09\uff0c\u4f1a\u9020\u6210\u67e5\u8be2\u64cd\u4f5c\u5f88\u96be\u83b7\u5f97\u8bfb\u9501\uff0c\u4ece\u800c\u5bfc\u81f4\u67e5\u8be2\u963b\u585e\u3002\\n\\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u8bbe\u7f6e\u6765\u8c03\u8282MyISAM\u7684\u8c03\u5ea6\u884c\u4e3a\uff1a\\n\\na. \u901a\u8fc7\u6307\u5b9a\u542f\u52a8\u53c2\u6570`low-priority-updates`\uff0c\u4f7fMyISAM\u5f15\u64ce\u9ed8\u8ba4\u7ed9\u4e88\u8bfb\u8bf7\u6c42\u4ee5\u4f18\u5148\u7684\u6743\u5229\u3002\\nb. \u901a\u8fc7\u6267\u884c\u547d\u4ee4`SET LOW_PRIORITY_UPDATES=1`\uff0c\u4f7f\u8be5\u8fde\u63a5\u53d1\u51fa\u7684\u66f4\u65b0\u8bf7\u6c42\u4f18\u5148\u7ea7\u964d\u4f4e\u3002\\nc. \u901a\u8fc7\u6307\u5b9a `INSERT`\u3001`UPDATE`\u3001`DELETE` \u8bed\u53e5\u7684`LOW_PRIORITY`\u5c5e\u6027\uff0c\u964d\u4f4e\u8be5\u8bed\u53e5\u7684\u4f18\u5148\u7ea7\u3002\\n\\n\u4e0a\u97623\u79cd\u65b9\u6cd5\u90fd\u662f\u8981\u4e48\u66f4\u65b0\u4f18\u5148\uff0c\u8981\u4e48\u67e5\u8be2\u4f18\u5148\u7684\u65b9\u6cd5\u3002\u8fd9\u91cc\u8981\u8bf4\u660e\u7684\u5c31\u662f\uff0c\u4e0d\u8981\u76f2\u76ee\u7684\u7ed9mysql\u8bbe\u7f6e\u4e3a\u8bfb\u4f18\u5148\uff0c\u56e0\u4e3a\u4e00\u4e9b\u9700\u8981\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u67e5\u8be2\u64cd\u4f5c\uff0c\u4e5f\u4f1a\u4f7f\u5199\u8fdb\u7a0b\u201c\u997f\u6b7b\u201d\u3002\u53ea\u6709\u6839\u636e\u4f60\u7684\u5b9e\u9645\u60c5\u51b5\uff0c\u6765\u51b3\u5b9a\u8bbe\u7f6e\u54ea\u79cd\u64cd\u4f5c\u4f18\u5148\u3002\u8fd9\u4e9b\u65b9\u6cd5\u8fd8\u662f\u6ca1\u6709\u4ece\u6839\u672c\u4e0a\u540c\u65f6\u89e3\u51b3\u67e5\u8be2\u548c\u66f4\u65b0\u7684\u95ee\u9898\u3002\\n\\n\u5728\u4e00\u4e2a\u6709\u5927\u6570\u636e\u91cf\u9ad8\u5e76\u53d1\u8868\u7684mysql\u91cc\uff0c\u6211\u4eec\u8fd8\u53ef\u91c7\u7528\u53e6\u4e00\u79cd\u7b56\u7565\u6765\u8fdb\u884c\u4f18\u5316\uff0c\u90a3\u5c31\u662f\u901a\u8fc7mysql\u4e3b\u4ece\uff08\u8bfb\u5199\uff09\u5206\u79bb\u6765\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\uff0c\u8fd9\u6837\u53ef\u907f\u514d\u4f18\u5148\u54ea\u4e00\u79cd\u64cd\u4f5c\u4ece\u800c\u53ef\u80fd\u5bfc\u81f4\u53e6\u4e00\u79cd\u64cd\u4f5c\u7684\u5835\u585e\u3002\\n\\n> \u8f6c\u81ea\uff1a[CSDN\u535a\u5ba2](http://blog.csdn.net/andyxm/article/details/44810313)"},{"id":"lsof-command-usage-in-linux","metadata":{"permalink":"/blog/lsof-command-usage-in-linux","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/08-20-lsof-command-usage-in-linux.md","source":"@site/blog/2016/08-20-lsof-command-usage-in-linux.md","title":"Linux \u547d\u4ee4\u795e\u5668 lsof \u5165\u95e8","description":"lsof \u662f\u7cfb\u7edf\u7ba1\u7406/\u5b89\u5168\u7684\u5c24\u4f2f\u5de5\u5177\u3002\u5927\u591a\u6570\u65f6\u5019\u7528\u5b83\u6765\u4ece\u7cfb\u7edf\u83b7\u5f97\u4e0e\u7f51\u7edc\u8fde\u63a5\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u4f46\u90a3\u53ea\u662f\u8fd9\u4e2a\u5f3a\u5927\u800c\u53c8\u9c9c\u4e3a\u4eba\u77e5\u7684\u5e94\u7528\u7684\u7b2c\u4e00\u6b65\u3002","date":"2016-08-20T14:00:00.000Z","formattedDate":"2016\u5e748\u670820\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"lsof","permalink":"/blog/tags/lsof"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":10.26,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"Linux \u547d\u4ee4\u795e\u5668 lsof \u5165\u95e8","tags":["linux","lsof","tools"],"date":"2016-08-20T14:00","slug":"lsof-command-usage-in-linux","authors":"inhere"},"prevItem":{"title":"Mysql\u7684\u9501\u673a\u5236\u89e3\u8bfb","permalink":"/blog/lock-intro-in-mysql"},"nextItem":{"title":"Linux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5","permalink":"/blog/compress-and-uncompress-command-in-linux"}},"content":"`lsof` \u662f\u7cfb\u7edf\u7ba1\u7406/\u5b89\u5168\u7684\u5c24\u4f2f\u5de5\u5177\u3002\u5927\u591a\u6570\u65f6\u5019\u7528\u5b83\u6765\u4ece\u7cfb\u7edf\u83b7\u5f97\u4e0e\u7f51\u7edc\u8fde\u63a5\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u4f46\u90a3\u53ea\u662f\u8fd9\u4e2a\u5f3a\u5927\u800c\u53c8\u9c9c\u4e3a\u4eba\u77e5\u7684\u5e94\u7528\u7684\u7b2c\u4e00\u6b65\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n\u5c06\u8fd9\u4e2a\u5de5\u5177\u79f0\u4e4b\u4e3a `lsof` \u771f\u662f\u540d\u526f\u5176\u5b9e\uff0c\u56e0\u4e3a\u5b83\u662f\u6307\u201c**\u5217\u51fa\u6253\u5f00\u6587\u4ef6\uff08lists openfiles\uff09**\u201d\u3002\u800c\u6709\u4e00\u70b9\u8981\u5207\u8bb0\uff0c**\u5728Unix\u4e2d\u4e00\u5207\uff08\u5305\u62ec\u7f51\u7edc\u5957\u63a5\u53e3\uff09\u90fd\u662f\u6587\u4ef6**\u3002\\n\\n\u6709\u8da3\u7684\u662f\uff0clsof\u4e5f\u662f\u6709\u7740\u6700\u591a\u5f00\u5173\u7684Linux/Unix\u547d\u4ee4\u4e4b\u4e00\u3002\u5b83\u6709\u90a3\u4e48\u591a\u7684\u5f00\u5173\uff0c\u5b83\u6709\u8bb8\u591a\u9009\u9879\u652f\u6301\u4f7f\u7528`-`\u548c`+`\u524d\u7f00\u3002\\n\\n```bash\\n$ lsof\\nusage: [-?abhlnNoOPRstUvV] [+|-c c] [+|-d s] [+D D] [+|-f[cgG]]\\n [-F [f]] [-g [s]] [-i [i]] [+|-L [l]] [+|-M] [-o [o]]\\n [-p s] [+|-r [t]] [-S [t]] [-T [t]] [-u s] [+|-w] [-x [fl]] [--] [names]\\n```\\n \\n\u6b63\u5982\u4f60\u6240\u89c1\uff0clsof\u6709\u7740\u5b9e\u5728\u662f\u4ee4\u4eba\u60ca\u8bb6\u7684\u9009\u9879\u6570\u91cf\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u83b7\u5f97\u4f60\u7cfb\u7edf\u4e0a\u8bbe\u5907\u7684\u4fe1\u606f\uff0c\u4f60\u80fd\u901a\u8fc7\u5b83\u4e86\u89e3\u5230\u6307\u5b9a\u7684\u7528\u6237\u5728\u6307\u5b9a\u7684\u5730\u70b9\u6b63\u5728\u78b0\u4ec0\u4e48\u4e1c\u897f\uff0c\u6216\u8005\u751a\u81f3\u662f\u4e00\u4e2a\u8fdb\u7a0b\u6b63\u5728\u4f7f\u7528\u4ec0\u4e48\u6587\u4ef6\u6216\u7f51\u7edc\u8fde\u63a5\u3002\\n\\n\u5bf9\u4e8e\u6211\uff0clsof\u66ff\u4ee3\u4e86netstat\u548cps\u7684\u5168\u90e8\u5de5\u4f5c\u3002\u5b83\u53ef\u4ee5\u5e26\u6765\u90a3\u4e9b\u5de5\u5177\u6240\u80fd\u5e26\u6765\u7684\u4e00\u5207\uff0c\u800c\u4e14\u8981\u6bd4\u90a3\u4e9b\u5de5\u5177\u591a\u5f97\u591a\u3002\u90a3\u4e48\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u770b\u5b83\u7684\u4e00\u4e9b\u57fa\u672c\u80fd\u529b\u5427\uff1a\\n\\n## \u5173\u952e\u9009\u9879\\n\\n\u7406\u89e3\u4e00\u4e9b\u5173\u4e8elsof\u5982\u4f55\u5de5\u4f5c\u7684\u5173\u952e\u6027\u4e1c\u897f\u662f\u5f88\u91cd\u8981\u7684\u3002\u6700\u91cd\u8981\u7684\u662f\uff0c\u5f53\u4f60\u7ed9\u5b83\u4f20\u9012\u9009\u9879\u65f6\uff0c\u9ed8\u8ba4\u884c\u4e3a\u662f\u5bf9\u7ed3\u679c\u8fdb\u884c\u201c\u6216\u201d\u8fd0\u7b97\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u6b63\u662f\u7528-i\u6765\u62c9\u51fa\u4e00\u4e2a\u7aef\u53e3\u5217\u8868\uff0c\u540c\u65f6\u53c8\u7528-p\u6765\u62c9\u51fa\u4e00\u4e2a\u8fdb\u7a0b\u5217\u8868\uff0c\u90a3\u4e48\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f60\u4f1a\u83b7\u5f97\u4e24\u8005\u7684\u7ed3\u679c\u3002\\n\\n\u4e0b\u9762\u7684\u4e00\u4e9b\u5176\u5b83\u4e1c\u897f\u9700\u8981\u7262\u8bb0\uff1a\\n\\n* \u9ed8\u8ba4 : \u6ca1\u6709\u9009\u9879\uff0clsof\u5217\u51fa\u6d3b\u8dc3\u8fdb\u7a0b\u7684\u6240\u6709\u6253\u5f00\u6587\u4ef6\\n* \u7ec4\u5408 : \u53ef\u4ee5\u5c06\u9009\u9879\u7ec4\u5408\u5230\u4e00\u8d77\uff0c\u5982-abc\uff0c\u4f46\u8981\u5f53\u5fc3\u54ea\u4e9b\u9009\u9879\u9700\u8981\u53c2\u6570\\n* -a : \u7ed3\u679c\u8fdb\u884c\u201c\u4e0e\u201d\u8fd0\u7b97\uff08\u800c\u4e0d\u662f\u201c\u6216\u201d\uff09\\n* -l : \u5728\u8f93\u51fa\u663e\u793a\u7528\u6237ID\u800c\u4e0d\u662f\u7528\u6237\u540d\\n* -h : \u83b7\u5f97\u5e2e\u52a9\\n* -t : \u4ec5\u83b7\u53d6\u8fdb\u7a0bID\\n* -U : \u83b7\u53d6UNIX\u5957\u63a5\u53e3\u5730\u5740\\n* -F : \u683c\u5f0f\u5316\u8f93\u51fa\u7ed3\u679c\uff0c\u7528\u4e8e\u5176\u5b83\u547d\u4ee4\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u683c\u5f0f\u5316\uff0c\u5982-F pcfn\uff08\u7528\u4e8e\u8fdb\u7a0bid\u3001\u547d\u4ee4\u540d\u3001\u6587\u4ef6\u63cf\u8ff0\u7b26\u3001\u6587\u4ef6\u540d\uff0c\u5e76\u4ee5\u7a7a\u7ec8\u6b62\uff09\\n\\n## \u83b7\u53d6\u7f51\u7edc\u4fe1\u606f\\n\\n\u6b63\u5982\u6211\u6240\u8bf4\u7684\uff0c\u6211\u4e3b\u8981\u5c06lsof\u7528\u4e8e\u83b7\u53d6\u5173\u4e8e\u7cfb\u7edf\u600e\u4e48\u548c\u7f51\u7edc\u4ea4\u4e92\u7684\u4fe1\u606f\u3002\u8fd9\u91cc\u63d0\u4f9b\u4e86\u5173\u4e8e\u6b64\u4fe1\u606f\u7684\u4e00\u4e9b\u4e3b\u9898\uff1a\\n\\n### \u4f7f\u7528-i\u663e\u793a\u6240\u6709\u8fde\u63a5\\n\\n\u6709\u4e9b\u4eba\u559c\u6b22\u7528netstat\u6765\u83b7\u53d6\u7f51\u7edc\u8fde\u63a5\uff0c\u4f46\u662f\u6211\u66f4\u559c\u6b22\u4f7f\u7528lsof\u6765\u8fdb\u884c\u6b64\u9879\u5de5\u4f5c\u3002\u7ed3\u679c\u4ee5\u5bf9\u6211\u6765\u8bf4\u5f88\u76f4\u89c2\u7684\u65b9\u5f0f\u5448\u73b0\uff0c\u6211\u4ec5\u4ec5\u53ea\u9700\u6539\u53d8\u6211\u7684\u8bed\u6cd5\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u540c\u6837\u7684\u547d\u4ee4\u6765\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\u3002\\n\\n```\\n# lsof -i\\n \\nCOMMAND  PID USER   FD   TYPE DEVICE SIZE NODE NAME\\ndhcpcd 6061 root 4u IPv4 4510 UDP *:bootpc\\nsshd 7703 root 3u IPv6  6499 TCP *:ssh (LISTEN)\\nsshd 7892 root 3u IPv6  6757 TCP 10.10.1.5:ssh->192.168.1.5:49901 (ESTABLISHED)\\n```\\n\\n### \u4f7f\u7528-i 6\u4ec5\u83b7\u53d6IPv6\u6d41\u91cf\\n\\n```bash\\n$ lsof -i 6\\n```\\n\\n### \u4ec5\u663e\u793aTCP\u8fde\u63a5\uff08\u540c\u7406\u53ef\u83b7\u5f97UDP\u8fde\u63a5\uff09\\n\\n\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5728-i\u540e\u63d0\u4f9b\u5bf9\u5e94\u7684\u534f\u8bae\u6765\u4ec5\u4ec5\u663e\u793aTCP\u6216\u8005UDP\u8fde\u63a5\u4fe1\u606f\u3002\\n\\n# lsof -iTCP\\n \\n```\\n$ lsof -iTCP\\n\\nCOMMAND  PID USER   FD   TYPE DEVICE SIZE NODE NAME\\nsshd 7703 root 3u IPv6 6499 TCP *:ssh (LISTEN)\\nsshd 7892 root 3u IPv6 6757 TCP 10.10.1.5:ssh->192.168.1.5:49901 (ESTABLISHED)\\n```\\n\\n### \u4f7f\u7528-i:port\u6765\u663e\u793a\u4e0e\u6307\u5b9a\u7aef\u53e3\u76f8\u5173\u7684\u7f51\u7edc\u4fe1\u606f\\n\\n\u6216\u8005\uff0c\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7aef\u53e3\u641c\u7d22\uff0c\u8fd9\u5bf9\u4e8e\u8981\u627e\u51fa\u4ec0\u4e48\u963b\u6b62\u4e86\u53e6\u5916\u4e00\u4e2a\u5e94\u7528\u7ed1\u5b9a\u5230\u6307\u5b9a\u7aef\u53e3\u5b9e\u5728\u662f\u592a\u68d2\u4e86\u3002\\n\\n```\\n# lsof -i:22\\n\\nCOMMAND  PID USER   FD   TYPE DEVICE SIZE NODE NAME\\nsshd 7703 root 3u  IPv6 6499 TCP *:ssh (LISTEN)\\nsshd 7892 root 3u  IPv6 6757 TCP 10.10.1.5:ssh->192.168.1.5:49901 (ESTABLISHED)\\n```\\n\\n### \u4f7f\u7528@host\u6765\u663e\u793a\u6307\u5b9a\u5230\u6307\u5b9a\u4e3b\u673a\u7684\u8fde\u63a5\\n\\n\u8fd9\u5bf9\u4e8e\u4f60\u5728\u68c0\u67e5\u662f\u5426\u5f00\u653e\u8fde\u63a5\u5230\u7f51\u7edc\u4e2d\u6216\u4e92\u8054\u7f51\u4e0a\u67d0\u4e2a\u6307\u5b9a\u4e3b\u673a\u7684\u8fde\u63a5\u65f6\u5341\u5206\u6709\u7528\u3002\\n\\n```\\n# lsof -i@172.16.12.5\\n \\nsshd 7892 root 3u IPv6 6757 TCP 10.10.1.5:ssh->172.16.12.5:49901 (ESTABLISHED)\\n```\\n\\n### \u4f7f\u7528@host:port\u663e\u793a\u57fa\u4e8e\u4e3b\u673a\u4e0e\u7aef\u53e3\u7684\u8fde\u63a5\\n\\n\u4f60\u4e5f\u53ef\u4ee5\u7ec4\u5408\u4e3b\u673a\u4e0e\u7aef\u53e3\u7684\u663e\u793a\u4fe1\u606f\u3002\\n\\n```\\n# lsof -i@172.16.12.5:22\\n \\nsshd 7892 root 3u IPv6 6757 TCP 10.10.1.5:ssh->172.16.12.5:49901 (ESTABLISHED)\\n```\\n\\n### \u627e\u51fa\u76d1\u542c\u7aef\u53e3\\n\\n\u627e\u51fa\u6b63\u7b49\u5019\u8fde\u63a5\u7684\u7aef\u53e3\u3002\\n\\n```\\n# lsof -i -sTCP:LISTEN\\n```\\n\\n\u4f60\u4e5f\u53ef\u4ee5grep \u201cLISTEN\u201d\u6765\u5b8c\u6210\u8be5\u4efb\u52a1\u3002\\n\\n```\\n# lsof -i | grep -i LISTEN\\n \\niTunes     400 daniel   16u  IPv4 0x4575228  0t0 TCP *:daap (LISTEN)\\n```\\n\\n### \u627e\u51fa\u5df2\u5efa\u7acb\u7684\u8fde\u63a5\\n\\n\u4f60\u4e5f\u53ef\u4ee5\u663e\u793a\u4efb\u4f55\u5df2\u7ecf\u8fde\u63a5\u7684\u8fde\u63a5\u3002\\n\\n```\\n# lsof -i -sTCP:ESTABLISHED\\n```\\n\\n\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7grep\u641c\u7d22\u201cESTABLISHED\u201d\u6765\u5b8c\u6210\u8be5\u4efb\u52a1\u3002\\n\\n```\\n# lsof -i | grep -i ESTABLISHED\\n\\nfirefox-b 169 daniel  49u IPv4 0t0 TCP 1.2.3.3:1863->1.2.3.4:http (ESTABLISHED)\\n```\\n \\n## \u7528\u6237\u4fe1\u606f\\n\\n\u4f60\u4e5f\u53ef\u4ee5\u83b7\u53d6\u5404\u79cd\u7528\u6237\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u5b83\u4eec\u5728\u7cfb\u7edf\u4e0a\u6b63\u5e72\u7740\u7684\u4e8b\u60c5\uff0c\u5305\u62ec\u5b83\u4eec\u7684\u7f51\u7edc\u6d3b\u52a8\u3001\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u7b49\u3002\\n\\n### \u4f7f\u7528-u\u663e\u793a\u6307\u5b9a\u7528\u6237\u6253\u5f00\u4e86\u4ec0\u4e48\\n\\n```\\n# lsof -u daniel\\n \\n-- snipped --\\nDock 155 daniel  txt REG   14,2   2798436   823208 /usr/lib/libicucore.A.dylib\\nDock 155 daniel  txt REG   14,2   1580212   823126 /usr/lib/libobjc.A.dylib\\nDock 155 daniel  txt REG   14,2   2934184   823498 /usr/lib/libstdc++.6.0.4.dylib\\nDock 155 daniel  txt REG   14,2    132008   823505 /usr/lib/libgcc_s.1.dylib\\nDock 155 daniel  txt REG   14,2    212160   823214 /usr/lib/libauto.dylib\\n-- snipped --\\n```\\n\\n### \u4f7f\u7528-u user\u6765\u663e\u793a\u9664\u6307\u5b9a\u7528\u6237\u4ee5\u5916\u7684\u5176\u5b83\u6240\u6709\u7528\u6237\u6240\u505a\u7684\u4e8b\u60c5\\n\\n```\\n# lsof -u ^daniel\\n \\n-- snipped --\\nDock 155 jim  txt REG   14,2   2798436   823208 /usr/lib/libicucore.A.dylib\\nDock 155 jim  txt REG   14,2   1580212   823126 /usr/lib/libobjc.A.dylib\\nDock 155 jim  txt REG   14,2   2934184   823498 /usr/lib/libstdc++.6.0.4.dylib\\nDock 155 jim  txt REG   14,2    132008   823505 /usr/lib/libgcc_s.1.dylib\\nDock 155 jim  txt REG   14,2    212160   823214 /usr/lib/libauto.dylib\\n-- snipped --\\n```\\n\\n### \u6740\u6b7b\u6307\u5b9a\u7528\u6237\u6240\u505a\u7684\u4e00\u5207\u4e8b\u60c5\\n\\n\u53ef\u4ee5\u6d88\u706d\u6307\u5b9a\u7528\u6237\u8fd0\u884c\u7684\u6240\u6709\u4e1c\u897f\uff0c\u8fd9\u771f\u4e0d\u9519\u3002\\n\\n```\\n# kill -9 `lsof -t -u daniel`\\n```\\n\\n## \u547d\u4ee4\u548c\u8fdb\u7a0b\\n\\n\u53ef\u4ee5\u67e5\u770b\u6307\u5b9a\u7a0b\u5e8f\u6216\u8fdb\u7a0b\u7531\u4ec0\u4e48\u542f\u52a8\uff0c\u8fd9\u901a\u5e38\u4f1a\u5f88\u6709\u7528\uff0c\u800c\u4f60\u53ef\u4ee5\u4f7f\u7528lsof\u901a\u8fc7\u540d\u79f0\u6216\u8fdb\u7a0bID\u8fc7\u6ee4\u6765\u5b8c\u6210\u8fd9\u4e2a\u4efb\u52a1\u3002\u4e0b\u9762\u5217\u51fa\u4e86\u4e00\u4e9b\u9009\u9879\uff1a\\n\\n### \u4f7f\u7528`-c`\u67e5\u770b\u6307\u5b9a\u7684\u547d\u4ee4\u6b63\u5728\u4f7f\u7528\u7684\u6587\u4ef6\u548c\u7f51\u7edc\u8fde\u63a5\\n\\n```\\n# lsof -c syslog-ng\\n \\nCOMMAND    PID USER   FD   TYPE     DEVICE    SIZE       NODE NAME\\nsyslog-ng 7547 root  cwd    DIR    3,3    4096   2 /\\nsyslog-ng 7547 root  rtd    DIR    3,3    4096   2 /\\nsyslog-ng 7547 root  txt    REG    3,3  113524  1064970 /usr/sbin/syslog-ng\\n-- snipped --\\n```\\n\\n### \u4f7f\u7528-p\u67e5\u770b\u6307\u5b9a\u8fdb\u7a0bID\u5df2\u6253\u5f00\u7684\u5185\u5bb9\\n\\n```\\n# lsof -p 10075\\n \\n-- snipped --\\nsshd    10068 root  mem    REG    3,3   34808 850407 /lib/libnss_files-2.4.so\\nsshd    10068 root  mem    REG    3,3   34924 850409 /lib/libnss_nis-2.4.so\\nsshd    10068 root  mem    REG    3,3   26596 850405 /lib/libnss_compat-2.4.so\\nsshd    10068 root  mem    REG    3,3  200152 509940 /usr/lib/libssl.so.0.9.7\\nsshd    10068 root  mem    REG    3,3   46216 510014 /usr/lib/liblber-2.3\\nsshd    10068 root  mem    REG    3,3   59868 850413 /lib/libresolv-2.4.so\\nsshd    10068 root  mem    REG    3,3 1197180 850396 /lib/libc-2.4.so\\nsshd    10068 root  mem    REG    3,3   22168 850398 /lib/libcrypt-2.4.so\\nsshd    10068 root  mem    REG    3,3   72784 850404 /lib/libnsl-2.4.so\\nsshd    10068 root  mem    REG    3,3   70632 850417 /lib/libz.so.1.2.3\\nsshd    10068 root  mem    REG    3,3    9992 850416 /lib/libutil-2.4.so\\n-- snipped --\\n```\\n\\n### -t\u9009\u9879\u53ea\u8fd4\u56dePID\\n\\n```\\n# lsof -t -c Mail\\n \\n350\\n```\\n\\n## \u6587\u4ef6\u548c\u76ee\u5f55\\n\\n\u901a\u8fc7\u67e5\u770b\u6307\u5b9a\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u4f60\u53ef\u4ee5\u770b\u5230\u7cfb\u7edf\u4e0a\u6240\u6709\u6b63\u4e0e\u5176\u4ea4\u4e92\u7684\u8d44\u6e90\u2014\u2014\u5305\u62ec\u7528\u6237\u3001\u8fdb\u7a0b\u7b49\u3002\\n\\n### \u663e\u793a\u4e0e\u6307\u5b9a\u76ee\u5f55\u4ea4\u4e92\u7684\u6240\u6709\u4e00\u5207\\n\\n```\\n# lsof /var/log/messages/\\n \\nCOMMAND    PID USER   FD   TYPE DEVICE   SIZE   NODE NAME\\nsyslog-ng 7547 root    4w   REG    3,3 217309 834024 /var/log/messages\\n```\\n\\n### \u663e\u793a\u4e0e\u6307\u5b9a\u6587\u4ef6\u4ea4\u4e92\u7684\u6240\u6709\u4e00\u5207\\n\\n```\\n# lsof /home/daniel/firewall_whitelist.txt\\n```\\n\\n## \u9ad8\u7ea7\u7528\u6cd5\\n\\n\u4e0etcpdump\u7c7b\u4f3c\uff0c\u5f53\u4f60\u5f00\u59cb\u7ec4\u5408\u67e5\u8be2\u65f6\uff0c\u5b83\u5c31\u663e\u793a\u4e86\u5b83\u5f3a\u5927\u7684\u529f\u80fd\u3002\\n\\n### \u663e\u793adaniel\u8fde\u63a5\u52301.1.1.1\u6240\u505a\u7684\u4e00\u5207\\n\\n```\\n# lsof -u daniel -i @1.1.1.1\\n \\nbkdr   1893 daniel 3u  IPv6 3456 TCP 10.10.1.10:1234->1.1.1.1:31337 (ESTABLISHED)\\n```\\n\\n### \u540c\u65f6\u4f7f\u7528-t\u548c-c\u9009\u9879\u4ee5\u7ed9\u8fdb\u7a0b\u53d1\u9001 HUP \u4fe1\u53f7\\n\\n```\\n# kill -HUP `lsof -t -c sshd`\\n```\\n\\n### lsof +L1\u663e\u793a\u6240\u6709\u6253\u5f00\u7684\u94fe\u63a5\u6570\u5c0f\u4e8e1\u7684\u6587\u4ef6\\n\\n\u8fd9\u901a\u5e38\uff08\u5f53\u4e0d\u603b\u662f\uff09\u8868\u793a\u67d0\u4e2a\u653b\u51fb\u8005\u6b63\u5c1d\u8bd5\u901a\u8fc7\u5220\u9664\u6587\u4ef6\u5165\u53e3\u6765\u9690\u85cf\u6587\u4ef6\u5185\u5bb9\u3002\\n\\n```\\n# lsof +L1\\n \\n(hopefully nothing)\\n```\\n\\n### \u663e\u793a\u67d0\u4e2a\u7aef\u53e3\u8303\u56f4\u7684\u6253\u5f00\u7684\u8fde\u63a5\\n\\n```\\n# lsof -i @fw.google.com:2150=2180\\n```\\n\\n## \u7ed3\u5c3e\\n\\n\u672c\u5165\u95e8\u6559\u7a0b\u53ea\u662f\u7ba1\u7aa5\u4e86lsof\u529f\u80fd\u7684\u4e00\u6591\uff0c\u8981\u67e5\u770b\u5b8c\u6574\u53c2\u8003\uff0c\u8fd0\u884cman lsof\u547d\u4ee4\u6216\u67e5\u770b\u5728\u7ebf\u7248\u672c\u3002\u5e0c\u671b\u672c\u6587\u5bf9\u4f60\u6709\u6240\u52a9\u76ca\uff0c\u4e5f\u968f\u65f6\u6b22\u8fce\u4f60\u7684\u8bc4\u8bba\u548c\u6307\u6b63\u3002\\n\\n## \u8d44\u6e90\\n\\nlsof\u624b\u518c\u9875\uff1a[http://www.netadmintools.com/html/lsof.man.html](http://www.netadmintools.com/html/lsof.man.html)\\n\u672c\u6587\u7531 Daniel Miessler\u64b0\u5199\uff0c\u9996\u6b21\u5728\u4ed6[\u535a\u5ba2](http://danielmiessler.com/study/lsof/)\u4e0a\u8d34\u51fa\\n\\n---------------------\\n\\n> \u8f6c\u81ea [Linux\u4e2d\u56fd](https://linux.cn/article-4099-2.html) \\n\\nvia: [http://linuxaria.com/howto/linux-terminal-an-lsof-primer](http://linuxaria.com/howto/linux-terminal-an-lsof-primer)\\n\u4f5c\u8005\uff1a[Daniel Miessler](https://plus.google.com/101727609700016666852/posts?rel=author) \\n\u8bd1\u8005\uff1a[GOLinux](https://github.com/GOLinux) \\n\u6821\u5bf9\uff1a[wxy](https://github.com/wxy)\\n\\n\u672c\u6587\u7531 [LCTT](https://github.com/LCTT/TranslateProject) \u539f\u521b\u7ffb\u8bd1"},{"id":"compress-and-uncompress-command-in-linux","metadata":{"permalink":"/blog/compress-and-uncompress-command-in-linux","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/08-16-compress-and-uncompress-command-in-linux.md","source":"@site/blog/2016/08-16-compress-and-uncompress-command-in-linux.md","title":"Linux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5","description":"Linux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5\u4f7f\u7528\u8bf4\u660e","date":"2016-08-16T20:25:00.000Z","formattedDate":"2016\u5e748\u670816\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"tar","permalink":"/blog/tags/tar"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":2.275,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"Linux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5","tags":["linux","tar","tools"],"date":"2016-08-16T20:25","slug":"compress-and-uncompress-command-in-linux","authors":"inhere"},"prevItem":{"title":"Linux \u547d\u4ee4\u795e\u5668 lsof \u5165\u95e8","permalink":"/blog/lsof-command-usage-in-linux"},"nextItem":{"title":"linux\u4e0b\u7684find\u6587\u4ef6\u67e5\u627e\u547d\u4ee4\u4e0egrep\u6587\u4ef6\u5185\u5bb9\u67e5\u627e\u547d\u4ee4","permalink":"/blog/the-find-and-grep-usage-on-linux"}},"content":"Linux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5\u4f7f\u7528\u8bf4\u660e\\n\\n\x3c!--truncate--\x3e\\n\\nLinux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5 \\n\\n## .tar \\n\\n- \u89e3\u5305\uff1a `tar xvf FileName.tar `\\n- \u6253\u5305\uff1a`tar cvf FileName.tar DirName` \\n\\n> \uff08\u6ce8\uff1atar\u662f\u6253\u5305\uff0c\u4e0d\u662f\u538b\u7f29\uff01\uff09 \\n\\n--------------------------------------------- \\n## .gz \\n\\n- \u89e3\u538b1\uff1a`gunzip FileName.gz` \\n- \u89e3\u538b2\uff1a`gzip -d FileName.gz `\\n- \u538b\u7f29\uff1a`gzip FileName `\\n\\n\\n## .tar.gz \\n\\n- \u89e3\u538b\uff1a`tar zxvf FileName.tar.gz `\\n- \u538b\u7f29\uff1a`tar zcvf FileName.tar.gz DirName `\\n\\n--------------------------------------------- \\n## .bz2 \\n\\n- \u89e3\u538b1\uff1a`bzip2 -d FileName.bz2` \\n- \u89e3\u538b2\uff1a`bunzip2 FileName.bz2` \\n- \u538b\u7f29\uff1a `bzip2 -z FileName` \\n\\n## .tar.bz2 \\n\\n- \u89e3\u538b\uff1a`tar jxvf FileName.tar.bz2` \\n- \u538b\u7f29\uff1a`tar jcvf FileName.tar.bz2 DirName` \\n\\n\\n--------------------------------------------- \\n\\n## .bz \\n\\n- \u89e3\u538b1\uff1a`bzip2 -d FileName.bz` \\n- \u89e3\u538b2\uff1a`bunzip2 FileName.bz` \\n- \u538b\u7f29\uff1a`\u672a\u77e5` \\n\\n## .tar.bz \\n\\n- \u89e3\u538b\uff1a`tar jxvf FileName.tar.bz` \\n- \u538b\u7f29\uff1a`\u672a\u77e5 `\\n\\n\\n--------------------------------------------- \\n\\n## .Z \\n- \u89e3\u538b\uff1a`uncompress FileName.Z` \\n- \u538b\u7f29\uff1a`compress FileName `\\n\\n## .tar.Z \\n\\n- \u89e3\u538b\uff1a`tar Zxvf FileName.tar.Z` \\n- \u538b\u7f29\uff1a`tar Zcvf FileName.tar.Z DirName` \\n\\n--------------------------------------------- \\n\\n## .tgz \\n\\n\u89e3\u538b\uff1atar zxvf FileName.tgz \\n\u538b\u7f29\uff1a\u672a\u77e5 \\n\\n## .tar.tgz \\n\\n\u89e3\u538b\uff1atar zxvf FileName.tar.tgz \\n\u538b\u7f29\uff1atar zcvf FileName.tar.tgz FileName \\n\\n--------------------------------------------- \\n## .zip \\n\\n\u89e3\u538b\uff1aunzip FileName.zip \\n\u538b\u7f29\uff1azip FileName.zip DirName \\n\\n--------------------------------------------- \\n## .rar \\n\\n\u89e3\u538b\uff1arar a FileName.rar \\n\u538b\u7f29\uff1ar ar e FileName.rar \\n\\n\\n> rar\u8bf7\u5230\uff1ahttp://www.rarsoft.com/download.htm \u4e0b\u8f7d\uff01 \\n\u89e3\u538b\u540e\u8bf7\u5c06rar_static\u62f7\u8d1d\u5230/usr/bin\u76ee\u5f55\uff08\u5176\u4ed6\u7531$PATH\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u76ee\u5f55\u4e5f\u53ef\u4ee5\uff09\uff1a \\n`$ cp rar_static /usr/bin/rar` \\n\\n--------------------------------------------- \\n\\n## .lha \\n\\n- \u89e3\u538b\uff1a`lha -e FileName.lha` \\n- \u538b\u7f29\uff1a`lha -a FileName.lha FileName `\\n\\n lha\u8bf7\u5230\uff1ahttp://www.infor.kanazawa-it.ac.jp/.../lhaunix/\u4e0b\u8f7d\uff01 \\n \\n>\u89e3\u538b\u540e\u8bf7\u5c06lha\u62f7\u8d1d\u5230/usr/bin\u76ee\u5f55\uff08\u5176\u4ed6\u7531$PATH\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u76ee\u5f55\u4e5f\u53ef\u4ee5\uff09\uff1a \\n`# cp lha /usr/bin/ `\\n\\n--------------------------------------------- \\n\\n## .rpm \\n\\n\u89e3\u5305\uff1a`rpm2cpio FileName.rpm | cpio -div `\\n\\n--------------------------------------------- \\n\\n## sEx\\n\\n.tar .tgz .tar.gz .tar.Z .tar.bz .tar.bz2 .zip .cpio .rpm .deb .slp .arj .rar .ace .lha .lzh \\n.lzx .lzs .arc .sda .sfx .lnx .zoo .cab .kar .cpt .pit .sit .sea \\n\\n- \u89e3\u538b\uff1a`sEx x FileName.*` \\n- \u538b\u7f29\uff1a`sEx a FileName.* FileName` \\n\\n> sEx\u53ea\u662f\u8c03\u7528\u76f8\u5173\u7a0b\u5e8f\uff0c\u672c\u8eab\u5e76\u65e0\u538b\u7f29\u3001\u89e3\u538b\u529f\u80fd\uff0c\u8bf7\u6ce8\u610f\uff01 \\n\\nsEx\u8bf7\u5230\uff1a http://sourceforge.net/projects/sex\u4e0b\u8f7d\uff01 \\n\\n\u89e3\u538b\u540e\u8bf7\u5c06sEx\u62f7\u8d1d\u5230/usr/bin\u76ee\u5f55\uff08\u5176\u4ed6\u7531$PATH\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u76ee\u5f55\u4e5f\u53ef\u4ee5\uff09\uff1a \\n`$ cp sEx /usr/bin/` \\n\\n> \u8f6c\u81ea\uff1a[iteye](http://verytiny.iteye.com/blog/165653)"},{"id":"the-find-and-grep-usage-on-linux","metadata":{"permalink":"/blog/the-find-and-grep-usage-on-linux","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/08-04-the-find-and-grep-usage-on-linux.md","source":"@site/blog/2016/08-04-the-find-and-grep-usage-on-linux.md","title":"linux\u4e0b\u7684find\u6587\u4ef6\u67e5\u627e\u547d\u4ee4\u4e0egrep\u6587\u4ef6\u5185\u5bb9\u67e5\u627e\u547d\u4ee4","description":"linux\u4e0b\u7684find\u6587\u4ef6\u67e5\u627e\u547d\u4ee4\u4e0egrep\u6587\u4ef6\u5185\u5bb9\u67e5\u627e\u547d\u4ee4\u7684\u4f7f\u7528\u3002","date":"2016-08-04T23:34:00.000Z","formattedDate":"2016\u5e748\u67084\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"find","permalink":"/blog/tags/find"},{"label":"grep","permalink":"/blog/tags/grep"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":4.88,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"linux\u4e0b\u7684find\u6587\u4ef6\u67e5\u627e\u547d\u4ee4\u4e0egrep\u6587\u4ef6\u5185\u5bb9\u67e5\u627e\u547d\u4ee4","tags":["linux","find","grep","tools"],"date":"2016-08-04T23:34","slug":"the-find-and-grep-usage-on-linux","authors":"inhere"},"prevItem":{"title":"Linux\u4e0b\u5e38\u7528\u538b\u7f29\u683c\u5f0f\u7684\u538b\u7f29\u4e0e\u89e3\u538b\u65b9\u6cd5","permalink":"/blog/compress-and-uncompress-command-in-linux"},"nextItem":{"title":"git\u521b\u5efa\u548c\u4f7f\u7528\u8865\u4e01patch","permalink":"/blog/create-and-apply-patch-in-git"}},"content":"linux\u4e0b\u7684find\u6587\u4ef6\u67e5\u627e\u547d\u4ee4\u4e0egrep\u6587\u4ef6\u5185\u5bb9\u67e5\u627e\u547d\u4ee4\u7684\u4f7f\u7528\u3002\\n\\n\u5728\u4f7f\u7528linux\u65f6\uff0c\u7ecf\u5e38\u9700\u8981\u8fdb\u884c\u6587\u4ef6\u67e5\u627e\u3002\u5176\u4e2d\u67e5\u627e\u7684\u547d\u4ee4\u4e3b\u8981\u6709find\u548cgrep\u3002\u4e24\u4e2a\u547d\u4ee4\u662f\u6709\u533a\u7684\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n\\n\u533a\u522b\uff1a\\n\\n1. find\u547d\u4ee4\u662f\u6839\u636e\u6587\u4ef6\u7684\u5c5e\u6027\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u6587\u4ef6\u540d\uff0c\u6587\u4ef6\u5927\u5c0f\uff0c\u6240\u6709\u8005\uff0c\u6240\u5c5e\u7ec4\uff0c\u662f\u5426\u4e3a\u7a7a\uff0c\u8bbf\u95ee\u65f6\u95f4\uff0c\u4fee\u6539\u65f6\u95f4\u7b49\u3002 \\n2. grep\u662f\u6839\u636e\u6587\u4ef6\u7684\u5185\u5bb9\u8fdb\u884c\u67e5\u627e\uff0c\u4f1a\u5bf9\u6587\u4ef6\u7684\u6bcf\u4e00\u884c\u6309\u7167\u7ed9\u5b9a\u7684\u6a21\u5f0f(patter)\u8fdb\u884c\u5339\u914d\u67e5\u627e\u3002\\n\\n## find\u547d\u4ee4\\n\\n\u57fa\u672c\u683c\u5f0f\uff1a`find  path expression`\\n\\n### 1.\u6309\u7167\u6587\u4ef6\u540d\u67e5\u627e\\n\\n\u547d\u4ee4\u793a\u4f8b         |     \u8bf4\u660e\\n-----------------|------------------------------\\n`find / -name httpd.conf`\u3000\u3000| \u5728\u6839\u76ee\u5f55\u4e0b\u67e5\u627e\u6587\u4ef6httpd.conf\uff0c\u8868\u793a\u5728\u6574\u4e2a\u786c\u76d8\u67e5\u627e\\n`find /etc -name httpd.conf`  |\u3000\u3000\u5728/etc\u76ee\u5f55\u4e0b\u6587\u4ef6httpd.conf\\n`find /etc -name \'*srm*\'`\u3000|\u3000\u4f7f\u7528\u901a\u914d\u7b26`*`(0\u6216\u8005\u4efb\u610f\u591a\u4e2a)\u3002\u8868\u793a\u5728`/etc`\u76ee\u5f55\u4e0b\u67e5\u627e\u6587\u4ef6\u540d\u4e2d\u542b\u6709\u5b57\u7b26\u4e32\u2018srm\u2019\u7684\u6587\u4ef6\\n`find . -name \'srm*\'` \u3000|\u3000\u8868\u793a\u5f53\u524d\u76ee\u5f55\u4e0b\u67e5\u627e\u6587\u4ef6\u540d\u5f00\u5934\u662f\u5b57\u7b26\u4e32\u2018srm\u2019\u7684\u6587\u4ef6\\n\\n### 2.\u6309\u7167\u6587\u4ef6\u7279\u5f81\u67e5\u627e \u3000\u3000\u3000\u3000\\n\\n\u547d\u4ee4\u793a\u4f8b         |     \u8bf4\u660e\\n-----------------|------------------------------\\n`find / -amin -10` \u3000|\u3000 \u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u6700\u540e10\u5206\u949f\u8bbf\u95ee\u7684\u6587\u4ef6(access time)\\n`find / -atime -2`\u3000|\u3000  \u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u6700\u540e48\u5c0f\u65f6\u8bbf\u95ee\u7684\u6587\u4ef6\\n`find / -empty` \u3000|\u3000 \u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u4e3a\u7a7a\u7684\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\\n`find / -group cat` \u3000|\u3000 \u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u5c5e\u4e8e group\u4e3acat\u7684\u6587\u4ef6\\n`find / -mmin -5` \u3000|\u3000 \u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u6700\u540e5\u5206\u949f\u91cc\u4fee\u6539\u8fc7\u7684\u6587\u4ef6(modify time)\\n`find / -mtime -1`\u3000|\u3000\u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u6700\u540e24\u5c0f\u65f6\u91cc\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\\n`find / -user fred`\u3000|\u3000\u67e5\u627e\u5728\u7cfb\u7edf\u4e2d\u5c5e\u4e8efred\u8fd9\u4e2a\u7528\u6237\u7684\u6587\u4ef6\\n`find / -size +10000c`\u3000|\u3000\u67e5\u627e\u51fa\u5927\u4e8e10000000\u5b57\u8282\u7684\u6587\u4ef6(c:\u5b57\u8282\uff0cw:\u53cc\u5b57\uff0ck:KB\uff0cM:MB\uff0cG:GB)\\n`find / -size -1000k` \u3000|\u3000\u67e5\u627e\u51fa\u5c0f\u4e8e1000KB\u7684\u6587\u4ef6\\n\\n### 3.\u4f7f\u7528\u6df7\u5408\u67e5\u627e\u65b9\u5f0f\u67e5\u627e\u6587\u4ef6\\n\\n\u53c2\u6570\u6709\uff1a `\uff01\uff0c-and(-a)\uff0c-or(-o)`\u3002\\n\\n\u547d\u4ee4\u793a\u4f8b         |     \u8bf4\u660e\\n-----------------|------------------------------\\n`find /tmp -size +10000c -and -mtime +2`   | \u3000\u5728`/tmp`\u76ee\u5f55\u4e0b\u67e5\u627e\u5927\u4e8e10000\u5b57\u8282\u5e76\u5728\u6700\u540e2\u5206\u949f\u5185\u4fee\u6539\u7684\u6587\u4ef6\\n`find / -user fred -or -user george`   | \u3000\u5728`/`\u76ee\u5f55\u4e0b\u67e5\u627e\u7528\u6237\u662ffred\u6216\u8005george\u7684\u6587\u4ef6\u6587\u4ef6\\n`find /tmp ! -user panda`   |\u3000\u5728`/tmp`\u76ee\u5f55\u4e2d\u67e5\u627e\u6240\u6709\u4e0d\u5c5e\u4e8epanda\u7528\u6237\u7684\u6587\u4ef6\\n\\n\\n## \u4e8c\u3001grep\u547d\u4ee4\\n\\n \u57fa\u672c\u683c\u5f0f\uff1a`find expression`\\n\\n### 1.\u4e3b\u8981\u53c2\u6570\\n\\n[options]\u4e3b\u8981\u53c2\u6570\uff1a\\n\\n```\\n\uff0dc\uff1a\u53ea\u8f93\u51fa\u5339\u914d\u884c\u7684\u8ba1\u6570\u3002\\n\uff0di\uff1a\u4e0d\u533a\u5206\u5927\u5c0f\u5199\\n\uff0dh\uff1a\u67e5\u8be2\u591a\u6587\u4ef6\u65f6\u4e0d\u663e\u793a\u6587\u4ef6\u540d\u3002\\n\uff0dl\uff1a\u67e5\u8be2\u591a\u6587\u4ef6\u65f6\u53ea\u8f93\u51fa\u5305\u542b\u5339\u914d\u5b57\u7b26\u7684\u6587\u4ef6\u540d\u3002\\n\uff0dn\uff1a\u663e\u793a\u5339\u914d\u884c\u53ca\u884c\u53f7\u3002\\n\uff0ds\uff1a\u4e0d\u663e\u793a\u4e0d\u5b58\u5728\u6216\u65e0\u5339\u914d\u6587\u672c\u7684\u9519\u8bef\u4fe1\u606f\u3002\\n\uff0dv\uff1a\u663e\u793a\u4e0d\u5305\u542b\u5339\u914d\u6587\u672c\u7684\u6240\u6709\u884c\u3002\\n```\\n\\npattern\u6b63\u5219\u8868\u8fbe\u5f0f\u4e3b\u8981\u53c2\u6570\uff1a\\n\\n```\\n\\\\\uff1a \u5ffd\u7565\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u7279\u6b8a\u5b57\u7b26\u7684\u539f\u6709\u542b\u4e49\u3002\\n^\uff1a\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5f00\u59cb\u884c\u3002\\n$: \u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7ed3\u675f\u884c\u3002\\n\\\\<\uff1a\u4ece\u5339\u914d\u6b63\u5219\u8868\u8fbe \u5f0f\u7684\u884c\u5f00\u59cb\u3002\\n\\\\>\uff1a\u5230\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u884c\u7ed3\u675f\u3002\\n[ ]\uff1a\u5355\u4e2a\u5b57\u7b26\uff0c\u5982[A]\u5373A\u7b26\u5408\u8981\u6c42 \u3002\\n[ - ]\uff1a\u8303\u56f4\uff0c\u5982[A-Z]\uff0c\u5373A\u3001B\u3001C\u4e00\u76f4\u5230Z\u90fd\u7b26\u5408\u8981\u6c42 \u3002\\n.\uff1a\u6240\u6709\u7684\u5355\u4e2a\u5b57\u7b26\u3002\\n* \uff1a\u6709\u5b57\u7b26\uff0c\u957f\u5ea6\u53ef\u4ee5\u4e3a0\u3002\\n```\\n\\n### 2.\u5b9e\u4f8b\u3000 \\n\\n\u547d\u4ee4\u793a\u4f8b         |     \u8bf4\u660e\\n-----------------|------------------------------\\n`grep \'test\' d*`\u3000|\u3000\u663e\u793a\u6240\u6709\u4ee5d\u5f00\u5934\u7684\u6587\u4ef6\u4e2d\u5305\u542b test\u7684\u884c\\n`grep \u2018test\u2019 aa bb cc` \u3000\u3000| \u663e\u793a\u5728aa\uff0cbb\uff0ccc\u6587\u4ef6\u4e2d\u5305\u542btest\u7684\u884c\\n`grep \u2018[a-z]\\\\{5\\\\}\u2019 aa` \u3000|\u3000\u663e\u793a\u6240\u6709\u5305\u542b\u6bcf\u884c\u5b57\u7b26\u4e32\u81f3\u5c11\u67095\u4e2a\u8fde\u7eed\u5c0f\u5199\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u7684\u884c\\n`grep magic /usr/src`\u3000|\u3000\u663e\u793a`/usr/src`\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6(\u4e0d\u542b\u5b50\u76ee\u5f55)\u5305\u542bmagic\u7684\u884c\\n`grep -r magic /usr/src`\u3000|\u3000\u663e\u793a`/usr/src`\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6(\u5305\u542b\u5b50\u76ee\u5f55)\u5305\u542bmagic\u7684\u884c\\n`grep -w pattern files` | \u53ea\u5339\u914d**\u6574\u4e2a\u5355\u8bcd**\uff0c\u800c\u4e0d\u662f\u5b57\u7b26\u4e32\u7684\u4e00\u90e8\u5206(\u5982\u5339\u914d\u2019magic\u2019\uff0c\u800c\u4e0d\u662f\u2019magical\u2019)\uff0c\\n\\ngrep\u8be6\u7ec6\u4f7f\u7528\u53c2\u89c1\uff1a`http://www.cnblogs.com/end/archive/2012/02/21/2360965.html`\\n\\n> \u8f6c\u81ea\uff1a[\u65ed\u4e1c\u7684\u535a\u5ba2](http://www.cnblogs.com/xudong-bupt/archive/2013/03/23/2976793.html)"},{"id":"create-and-apply-patch-in-git","metadata":{"permalink":"/blog/create-and-apply-patch-in-git","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/07-31-create-and-apply-patch-in-git.md","source":"@site/blog/2016/07-31-create-and-apply-patch-in-git.md","title":"git\u521b\u5efa\u548c\u4f7f\u7528\u8865\u4e01patch","description":"\u5728git\u4e2d\u521b\u5efa\u548c\u4f7f\u7528\u8865\u4e01patch\u8bb0\u5f55","date":"2016-07-31T15:03:00.000Z","formattedDate":"2016\u5e747\u670831\u65e5","tags":[{"label":"git","permalink":"/blog/tags/git"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":1.95,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"git\u521b\u5efa\u548c\u4f7f\u7528\u8865\u4e01patch","tags":["git","tools"],"date":"2016-07-31T15:03","slug":"create-and-apply-patch-in-git","authors":"inhere"},"prevItem":{"title":"linux\u4e0b\u7684find\u6587\u4ef6\u67e5\u627e\u547d\u4ee4\u4e0egrep\u6587\u4ef6\u5185\u5bb9\u67e5\u627e\u547d\u4ee4","permalink":"/blog/the-find-and-grep-usage-on-linux"},"nextItem":{"title":"vim\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32","permalink":"/blog/use-vimgrep-search-file-contents-in-vim"}},"content":"\u5728git\u4e2d\u521b\u5efa\u548c\u4f7f\u7528\u8865\u4e01patch\u8bb0\u5f55\\n\\n\x3c!--truncate--\x3e\\n\\n\\ngit\u6253patch\u65b9\u6cd5\\n\\n## git format-patch  \uff08\u63a8\u8350\uff09\\n\\n\u9002\u7528\u4e8egit\u7684patch\uff0c\u5305\u542bdiff\u4fe1\u606f\uff0c\u5305\u542b\u63d0\u4ea4\u4eba\uff0c\u63d0\u4ea4\u65f6\u95f4\u7b49\\n\u5982\u679c`git format-patch` \u751f\u6210\u7684\u8865\u4e01\u4e0d\u80fd\u6253\u5230\u5f53\u524d\u5206\u652f\uff0c`git am`\u4f1a\u7ed9\u51fa\u63d0\u793a\uff0c\u5e76\u534f\u52a9\u4f60\u5b8c\u6210\u6253\u8865\u4e01\u5de5\u4f5c\\n\\n### \u5bf9\u6bd4\u5206\u652f\u751f\u6210patch\\n\\n\u4f8b\uff1a\u4ecemaster checkout \u4e00\u4e2a\u65b0\u5206\u652f\u4fee\u6539\u7136\u540e\u4e0emaster\u5bf9\u6bd4\u751f\u6210patch\u3002\\n\\n```\\n$ git format-patch -M master //-M\u9009\u9879\u8868\u793a\u8fd9\u4e2apatch\u8981\u548c\u90a3\u4e2a\u5206\u652f\u6bd4\u5bf9\\n$ git am 001-xxx.patch\uff08\u4e0d\u5fc5\u91cd\u65b0commit\uff09\\n```\\n\\n### \u5c06commit\u6253\u5305\u6210patch\\n\\n```sh\\n# \u4fee\u6539\u4ee3\u7801\\n$ vi drivers/bluetooth/btusb.c\\n# \u628a\u4ee3\u7801\u6dfb\u52a0\u5230git\u7ba1\u7406\u4ed3\u5e93\\n$ git add .\\n# \u63d0\u4ea4\u4fee\u6539\\n$ git commit -m \\"some message\\"\\n# \u67e5\u770b\u65e5\u5fd7,\u83b7\u53d6\u5230hash\\n$ git log \\n# \u751f\u6210patch\\n$ git format-patch -s 1bbe3c8c19\\n```\\n\\n\u6216\u8005\u4e5f\u53ef\u4ee5\\n\\n```sh\\n$ git format-patch HEAD^ # \u6700\u8fd1\u76841\u6b21commit\u7684patch\\n$ git format-patch HEAD^^ # \u6700\u8fd1\u76842\u6b21commit\u7684patch\\n$ git format-patch HEAD^^^ # \u6700\u8fd1\u76843\u6b21commit\u7684patch\\n$ git format-patch HEAD^^^^ # \u6700\u8fd1\u76844\u6b21commit\u7684patch\\n```\\n\\n### \u6d4b\u8bd5,\u5e94\u7528patch\\n\\n```\\n# \u68c0\u67e5patch\u6587\u4ef6\\n$ git apply --stat xxx.patch\\n\\n#\u67e5\u770b\u662f\u5426\u80fd\u5e94\u7528\u6210\u529f\\n$ git apply --check xxx.patch\\n\\n# \u5e94\u7528patch\\n$ git am -s < xxx.patch\\n```\\n\\n## git diff \\n\\n\u751f\u6210\u6807\u51c6\u7684patch\uff0c\u53ea\u5305\u542bdiff\u4fe1\u606f\\n> `git diff` \u751f\u6210\u7684Patch\u517c\u5bb9\u6027\u5f3a\uff0c\u53ef\u4ee5\u7528`git apply --check` \u67e5\u770b\u8865\u4e01\u662f\u5426\u80fd\u591f\u5e72\u51c0\u987a\u5229\u5730\u5e94\u7528\u5230\u5f53\u524d\u5206\u652f\u4e2d\u3002\\n\\n\u4f8b\uff1a\u4ecemaster checkout\u4e00\u4e2a\u65b0\u5206\u652f\u4fee\u6539\u7136\u540e\u4e0emaster\u5bf9\u6bd4\u751f\u6210patch\u3002 \\n\\n```\\n$ git diff master > patch\\n$ git apply xxx.patch\uff08\u9700\u8981\u91cd\u65b0commit\uff09\\n```"},{"id":"use-vimgrep-search-file-contents-in-vim","metadata":{"permalink":"/blog/use-vimgrep-search-file-contents-in-vim","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/07-26-use-vimgrep-search-file-contents-in-vim.md","source":"@site/blog/2016/07-26-use-vimgrep-search-file-contents-in-vim.md","title":"vim\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32","description":"vim\u4e2d\u53ef\u4ee5\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32","date":"2016-07-26T20:44:00.000Z","formattedDate":"2016\u5e747\u670826\u65e5","tags":[{"label":"vim","permalink":"/blog/tags/vim"},{"label":"tools","permalink":"/blog/tags/tools"}],"readingTime":2.51,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"vim\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32","tags":["vim","tools"],"date":"2016-07-26T20:44","slug":"use-vimgrep-search-file-contents-in-vim","authors":"inhere"},"prevItem":{"title":"git\u521b\u5efa\u548c\u4f7f\u7528\u8865\u4e01patch","permalink":"/blog/create-and-apply-patch-in-git"},"nextItem":{"title":"linux \u7ec8\u7aef\u4e0b\u4e0a\u4f20\u4e0b\u8f7d\u547d\u4ee4 sftp,scp","permalink":"/blog/use-scp-or-sftp-up-down-files-in-linux"}},"content":"vim\u4e2d\u53ef\u4ee5\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32\\n\\n\x3c!--truncate--\x3e\\n\\n\u5728vim\u4e2d\u63d0\u4f9b2\u4e2d\u65b9\u6cd5\u6765\u5728\u5176\u4ed6\u6587\u4ef6\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32\uff0c\u7b2c\u4e00\u79cd\u662f`vimgrep`\u8fd8\u6709\u4e00\u79cd\u662f`grep`\u3002\\n\\n> \u5982\u679c\u53ea\u662f\u5728\u5f53\u524d\u6253\u5f00\u7684\u6587\u4ef6\u4e2d\u67e5\u627e\u5b57\u7b26\u4e32\u7684\uff0c\u4f7f\u7528 `:?` \u540e\u9762\u52a0\u4e0a\u60f3\u8981\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u5c31\u53ef\u4ee5\u3002\\n\\n\u8fd9\u91cc\u8981\u89e3\u51b3\u7684\u662f\u5728\u522b\u7684\u6587\u4ef6\u4e2d\uff0c\u4e5f\u8bb8\u8fd9\u4e2a\u6587\u4ef6\u8fd8\u6ca1\u6709\u6253\u5f00\uff0c\u6216\u8005\u9700\u8981\u5728\u591a\u4e2a\u6587\u4ef6\u4e2d\u64cd\u4f5c\uff0c\u6bd4\u5982\u5728\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u9762\u6240\u6709.c\u7684\u6587\u4ef6\u4e2d\u67e5\u627e\uff0c\u6216\u8005\u5728\u83ab\u4e2a\u6587\u4ef6\u5939\u4e2d\u67e5\u627e\u3002\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528imgrep\u6216\u8005grep\u3002\u8fd9\u91cc\u53ea\u4ecb\u7ecdvimgrep\u3002\\n\u8fd9\u662f\u4e2avim\u7684\u5185\u90e8\u547d\u4ee4\uff0c\u56e0\u4e3a\u53ef\u4ee5\u5728vim\u5185\u90e8\u76f4\u63a5\u4f7f\u7528\uff0c\\n\\n```\\n:vimgrep\\n```\\n\\n\u8fd9\u4e2a\u547d\u4ee4\u8fd8\u53ef\u7b80\u5199\u4e3avim\\n\\n```bash\\n:vim\\n```\\n\\n## \u7528\u4f8b1  \\n\\n\u5728\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u9762\u6240\u6709`.c`\u6587\u4ef6\u4e2d\u67e5\u627e\u5b57\u7b26\u4e32 `classA`\\n\\n```\\n:vimgrep /classA/gj ./*.c\\n```\\n\\n\u89e3\u91ca\u4e00\u4e0b\uff1a\\n- g: \u5982\u679c\u4e00\u884c\u4e2d\u51fa\u73b0\u591a\u5904\uff0c\u53ea\u663e\u793a\u4e00\u6b21\uff0c\u6ca1\u6709g\u5c31\u4f1a\u51fa\u73b0\u591a\u6b21\\n\\n- j: \u53ea\u662f\u5217\u51fa\u6240\u6709\u5339\u914d\u7684\u884c\uff0c\u6ca1\u6709j\u90a3\u4e48\u5c31\u4f1a\u8df3\u53bb\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u884c\\n\\n## \u7528\u4f8b2 \\n\\n\u5728\u5f53\u524d\u6587\u4ef6\u5939\u53ca\u5176\u5b50\u6587\u4ef6\u5939\u4e0b\u9762\u67e5\u627e\u5b57\u7b26\u4e32classA\\n\\n```bash\\n:vimgrep /classA/gj **/*.*\\n```\\n\\n## \u7528\u4f8b3\\n\\n\u5728\u5f53\u524d\u76ee\u5f55\u4e2d\u7684\\"includes\\"\u76ee\u5f55\u91cc\u7684\u6240\u6709\u6587\u4ef6\u4e2d,\u67e5\u627e\u5b57\u7b26\u4e32\\"the menu\\".\\n\\n```bash\\n:vimgrep /the menu/ ./includes/*.*\\n```\\n\\n\\n\\n\u641c\u7d22\u5b8c\u6bd5\u540e\u53ef\u4ee5\u4f7f\u7528`copen`\u6216\u8005`cw`\u547d\u4ee4\u6765\u6253\u5f00\u641c\u7d22\u7684\u7ed3\u679c\u3002\u4f7f\u7528`jk`\u6765\u79fb\u52a8\u9009\u4e2d\u884c\uff0c\u56de\u8f66\u53ef\u4ee5\u8df3\u5230\u5bf9\u5e94\u7684\u6587\u4ef6\u3002\\n\\n`copen` \u540e\u9762\u53ef\u4ee5\u6307\u5b9a\u7a97\u53e3\u7684\u9ad8\u5ea6\u3002\\n\\n\u6ce8\u610f\u5f53\u53bb\u5230\u641c\u5230\u5230\u7684\u6587\u4ef6\u540e\uff0c\u5f53\u524d\u7684\u7a97\u53e3\u4f1a\u88ab\u8be5\u6587\u4ef6\u8986\u76d6\uff0c\u90a3\u4e48\u600e\u4e48\u56de\u5230\u539f\u6765\u7684\u6587\u4ef6\uff0c\\n\\n```bash\\nctrl+^\\n```\\n\\n\u66f4\u591a\u7684\u4fe1\u606f\u53ef\u4ee5\u4f7f\u7528 `:help vimgrep` \u6765\u67e5\u770b\u3002\\n\\n> \u8f6c\u81ea\uff1a[ vim\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32 | \u5b66\u6b65\u56ed](http://www.xuebuyuan.com/1116549.html)"},{"id":"use-scp-or-sftp-up-down-files-in-linux","metadata":{"permalink":"/blog/use-scp-or-sftp-up-down-files-in-linux","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/07-15-use-scp-or-sftp-up-down-files-in-linux.md","source":"@site/blog/2016/07-15-use-scp-or-sftp-up-down-files-in-linux.md","title":"linux \u7ec8\u7aef\u4e0b\u4e0a\u4f20\u4e0b\u8f7d\u547d\u4ee4 sftp,scp","description":"\u5728linux\u6216\u8005mac \u7ec8\u7aef\u4e0b\u4e0a\u4f20\u4e0b\u8f7d\u547d\u4ee4 sftp,scp \u7684\u7b80\u5355\u4f7f\u7528\u4ecb\u7ecd","date":"2016-07-15T17:40:00.000Z","formattedDate":"2016\u5e747\u670815\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"macOS","permalink":"/blog/tags/mac-os"},{"label":"sftp","permalink":"/blog/tags/sftp"},{"label":"scp","permalink":"/blog/tags/scp"}],"readingTime":3.8,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"linux \u7ec8\u7aef\u4e0b\u4e0a\u4f20\u4e0b\u8f7d\u547d\u4ee4 sftp,scp","tags":["linux","macOS","sftp","scp"],"date":"2016-07-15T17:40","slug":"use-scp-or-sftp-up-down-files-in-linux","authors":"inhere"},"prevItem":{"title":"vim\u4f7f\u7528vimgrep\u5728\u5176\u4ed6\u6587\u4ef6\u4e2d\u6216\u8005\u6587\u4ef6\u5939\u4e2d\u641c\u7d22\u5b57\u7b26\u4e32","permalink":"/blog/use-vimgrep-search-file-contents-in-vim"},"nextItem":{"title":"composer.json \u4e2d\u7684 scripts \u811a\u672c","permalink":"/blog/scripts-in-php-composer-json"}},"content":"\u5728linux\u6216\u8005mac \u7ec8\u7aef\u4e0b\u4e0a\u4f20\u4e0b\u8f7d\u547d\u4ee4 sftp,scp \u7684\u7b80\u5355\u4f7f\u7528\u4ecb\u7ecd\\n\\n\x3c!--truncate--\x3e\\n\\n## scp\\n\\n\u5e2e\u52a9\u547d\u4ee4\uff1a `man scp`\\n\\nscp\u529f\u80fd\uff1a\\n\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u5230\u672c\u5730,\\n\u5982\u679c\u60f3\u4e0a\u4f20\u6216\u8005\u60f3\u4e0b\u8f7d\u76ee\u5f55\uff0c\u6700\u597d\u7684\u529e\u6cd5\u662f\u91c7\u7528tar\u538b\u7f29\u4e00\u4e0b\uff0c\u662f\u6700\u660e\u667a\u7684\u9009\u62e9.\\n\\n### \u4ece\u8fdc\u7a0b\u4e3b\u673a\u4e0b\u8f7d\u4e1c\u897f\u5230\u672c\u5730\\n\\n- \u62f7\u8d1d\u6587\u4ef6\u547d\u4ee4\\n```\\nscp user@host:/path/file /localpath  # \u5373 scp \u7528\u6237\u540d@IP:/\u6587\u4ef6\u8def\u5f84  /\u672c\u5730\u6587\u4ef6\u8def\u5f84\\n```\\n\\n- \u5982\u679c\u62f7\u76ee\u5f55\\n```\\nscp -r user@host:/dirpath /localpath  # \u5373 scp -r \u7528\u6237\u540d@IP:/\u76ee\u5f55\u8def\u5f84  /\u672c\u5730\u6587\u4ef6\u8def\u5f84\\n```\\n\\n- \u4e00\u4e9b\u53c2\u6570\\n```\\n-P \u8bbe\u7f6e\u8fde\u63a5\u7aef\u53e3\\n-v \u548c\u5927\u591a\u6570 linux \u547d\u4ee4\u4e2d\u7684 -v \u610f\u601d\u4e00\u6837 , \u7528\u6765\u663e\u793a\u8fdb\u5ea6 . \u53ef\u4ee5\u7528\u6765\u67e5\u770b\u8fde\u63a5 , \u8ba4\u8bc1 , \u6216\u662f\u914d\u7f6e\u9519\u8bef .\\n-C \u4f7f\u80fd\u538b\u7f29\u9009\u9879 .\\n-4 \u5f3a\u884c\u4f7f\u7528 IPV4 \u5730\u5740 .\\n-6 \u5f3a\u884c\u4f7f\u7528 IPV6 \u5730\u5740 .\\n```\\n\\n### \u4e0a\u4f20\u6587\u4ef6\u6216\u76ee\u5f55\u5230\u8fdc\u7a0b\u4e3b\u673a\\n\\n- \u4e0a\u4f20\u6587\u4ef6 \u5230 \u8fdc\u7a0b\u4e3b\u673a \\n```\\nscp localfile user@host:/dirpath  # \u5373 scp \u6587\u4ef6\u8def\u5f84  \u8fdc\u7a0b\u4e3b\u673a\u7528\u6237\u540d@ip:/\u5b58\u653e\u6587\u4ef6\u7684\u8def\u5f84\\n```\\n\\n- \u4e0a\u4f20\u76ee\u5f55 \u5230 \u8fdc\u7a0b\u4e3b\u673a   \\n```\\nscp -r localdir user@host:/dirpath # \u5373 scp -r  \u672c\u5730\u76ee\u5f55\u8def\u5f84   \u8fdc\u7a0b\u4e3b\u673a\u7528\u6237\u540d@ip:/\u5b58\u653e\u6587\u4ef6\u8def\u5f84\\n```\\n\\n\\n-----------------------------------------------------------------------\\n\\n## sftp \\n\\nsftp\u662f\u4e00\u4e2a\u4ea4\u4e92\u5f0f\u6587\u4ef6\u4f20\u8f93\u7a0b\u5f0f\u3002\u5b83\u7c7b\u4f3c\u4e8e ftp, \u4f46\u5b83\u8fdb\u884c\u52a0\u5bc6\u4f20\u8f93\uff0c\u6bd4FTP\u6709\u66f4\u9ad8\u7684\u5b89\u5168\u6027\u3002\\n\u4e0b\u8fb9\u5c31\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u8fdc\u7a0b\u8fde\u63a5\u4e3b\u673a\uff0c\u8fdb\u884c\u6587\u4ef6\u7684\u4e0a\u4f20\u548c\u4e0b\u8f7d\uff0c\u4ee5\u53ca\u4e00\u4e9b\u76f8\u5173\u64cd\u4f5c\u3002\\n\\n\u4e3e\u4f8b\uff0c\u5982\u8fdc\u7a0b\u4e3b\u673a\u7684 IP \u662f `202.206.64.33`\u6216\u8005\u662f\u57df\u540d`www.teste.com` \u6237\u540d\u662f  `user` ,\u5728\u547d\u4ee4\u884c\u6a21\u4e0b:\\n\\n```\\nsftp user@202.206.64.33\\n# \u6216\u8005  \\nsftp user@www.test.com\\n# \u56de\u8f66\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u8fdb\u5165\u63d0\u793a\u7b26\\nsftp>\\nsftp> help  \u83b7\u5f97\u5e2e\u52a9\\n```\\n\\n\u5982\u679c\u767b\u9646\u8fdc\u7a0b\u673a\u5668\u4e0d\u662f\u4e3a\u4e86\u4e0a\u4f20\u4e0b\u8f7d\u6587\u4ef6\uff0c\u800c\u662f\u8981\u4fee\u6539\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u7684\u67d0\u4e9b\u6587\u4ef6\u3002\u53ef\u4ee5\\n`ssh  user@202.206.64.33` \uff08\u5176\u5b9esftp\u5c31\u662fssh \u7684\u4e00\u4e2a\u7a0b\u5f0f\u3002\uff09\\n\\n\u5728sftp\u4e2dget\u8868\u793a\u4e0b\u8f7d\u5373\u5f97\u5230,put\u8868\u793a\u4e0a\u4f20\u5373\u653e\u7f6e\\n\\n```shell\\nsftp> get \u8fdc\u7a0b\u4e3b\u673a\u4e0b\u6587\u4ef6\u7684\u8def\u5f84   \u5c06\u6587\u4ef6\u4fdd\u5b58\u5230\u672c\u5730\u7535\u8111\u7684\u8def\u5f84\\nsftp> put \u672c\u5730\u6587\u4ef6\u7684\u8def\u5f84 \u5c06\u6587\u4ef6\u7248\u4fdd\u5b58\u5230\u8fdc\u7a0b\u4e3b\u673a\u7684\u8def\u5f84\\n# \u5c06\u4ece\u8fdc\u7a0b\u4e3b\u673a\u7684  /var/www/fuyatao/\u76ee\u5f55\u4e0b\u5c06 index.php \u4e0b\u8f7d\u5230\u672c\u5730  /home/fuyatao/\u76ee\u5f55\u4e0b\u3002\\nsftp> get /var/www/fuyatao/index.php  /home/fuyatao/\\n# \u628a\u672c\u5730 /home/fuyatao/downloads/\u76ee\u5f55\u4e0b\u7684 linuxgl.pdf\u6587\u4ef6\u4e0a\u4f20\u81f3\u8fdc\u7a0b\u4e3b\u673a/var/www/fuyatao/ \u76ee\u5f55\u4e0b\\nsftp> put /home/fuyatao/downloads/Linuxgl.pdf /var/www/fuyatao/\\n```\\n\\n\u4f60\u5982\u679c\u4e0d\u77e5\u9053\u8fdc\u7a0b\u4e3b\u673a\u7684\u76ee\u5f55\u662f\u4ec0\u4e48\u6837\uff0c \\n`pwd`\u547d\u4ee4\u53ef\u4ee5\u5e2e\u60a8\u67e5\u8be2\u8fdc\u7a0b\u4e3b\u673a\u7684\u5f53\u524d\u8def\u5f84\u3002\u67e5\u8be2\u672c\u673a\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 `lpwd`.\\n\u6539\u53d8\u8def\u5f84\u53ef\u4ee5\u7528cd \uff0c\u6539\u53d8\u672c\u673a\u8def\u5f84\u53ef\u4ee5\u7528 lcd;\\n`ls rm rmdir mkdir `\u8fd9\u4e9b\u547d\u4ee4\u90fd\u53ef\u4ee5\u4f7f\u7528\u3002\u540c\u7406\u8c03\u7528\u672c\u673a\u90fd\u662f\u52a0 l , \u5373 `lls lrm`.\\n\\n> \u8981\u79bb\u5f00sftp\uff0c\u7528exit \u6216quit\u3001 bye \u5747\u53ef\u3002\u8be6\u7ec6\u60c5\u51b5\u53ef\u4ee5\u67e5\u9605 man  sftp.\\n\\n--------------------------------------------------------------\\n> \u8bb0\u4f4f\uff1a\\n\u5728\u7528sftp\u548cftp\u7684\u65f6\u5019\uff0c\u6240\u6709\u6587\u4ef6\u548c\u76ee\u5f55\u90fd\u8981\u624b\u52a8\u8f93\u5165\uff0ctab\u8865\u5168\u952e\u5728\u8fd9\u4e24\u4e2a\u547d\u4ee4\u4e2d\u6ca1\u6709\u4f5c\u7528\u3002\u5f55\u5165\u7684\u65f6\u5019\u7ec6\u5fc3\uff01\\n\\n> form [blog.163.com](http://blog.163.com/chunoo@126/blog/static/814473532010676351769/)"},{"id":"scripts-in-php-composer-json","metadata":{"permalink":"/blog/scripts-in-php-composer-json","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/05-17-scripts-in-php-composer-json.md","source":"@site/blog/2016/05-17-scripts-in-php-composer-json.md","title":"composer.json \u4e2d\u7684 scripts \u811a\u672c","description":"\'scripts\'\u811a\u672c -- \u5728 Composer \u4e2d\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a PHP \u56de\u8c03\uff08\u5b9a\u4e49\u4e3a\u9759\u6001\u65b9\u6cd5\uff09\u6216\u4efb\u4f55\u547d\u4ee4\u884c\u53ef\u6267\u884c\u7684\u547d\u4ee4\u3002\u811a\u672c\u5bf9\u4e8e\u5728 Composer \u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6267\u884c\u4e00\u4e2a\u8d44\u6e90\u5305\u7684\u81ea\u5b9a\u4e49\u4ee3\u7801\u6216\u5305\u4e13\u7528\u547d\u4ee4\u662f\u975e\u5e38\u6709\u7528\u7684\u3002","date":"2016-05-17T17:21:00.000Z","formattedDate":"2016\u5e745\u670817\u65e5","tags":[{"label":"php","permalink":"/blog/tags/php"},{"label":"composer","permalink":"/blog/tags/composer"}],"readingTime":4.81,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"composer.json \u4e2d\u7684 scripts \u811a\u672c","tags":["php","composer"],"date":"2016-05-17T17:21","slug":"scripts-in-php-composer-json","authors":["inhere","network"]},"prevItem":{"title":"linux \u7ec8\u7aef\u4e0b\u4e0a\u4f20\u4e0b\u8f7d\u547d\u4ee4 sftp,scp","permalink":"/blog/use-scp-or-sftp-up-down-files-in-linux"},"nextItem":{"title":"Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528","permalink":"/blog/custom-vars-usage-in-ngnix-config"}},"content":"\'scripts\'\u811a\u672c -- \u5728 Composer \u4e2d\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a PHP \u56de\u8c03\uff08\u5b9a\u4e49\u4e3a\u9759\u6001\u65b9\u6cd5\uff09\u6216\u4efb\u4f55\u547d\u4ee4\u884c\u53ef\u6267\u884c\u7684\u547d\u4ee4\u3002\u811a\u672c\u5bf9\u4e8e\u5728 Composer \u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6267\u884c\u4e00\u4e2a\u8d44\u6e90\u5305\u7684\u81ea\u5b9a\u4e49\u4ee3\u7801\u6216\u5305\u4e13\u7528\u547d\u4ee4\u662f\u975e\u5e38\u6709\u7528\u7684\u3002 \\n\\n\x3c!--truncate--\x3e\\n\\n## \u4ec0\u4e48\u662f\u811a\u672c\uff1f\\n\\n\u4e00\u4e2a\u811a\u672c\uff0c\u5728 Composer \u4e2d\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a PHP \u56de\u8c03\uff08\u5b9a\u4e49\u4e3a\u9759\u6001\u65b9\u6cd5\uff09\u6216\u4efb\u4f55\u547d\u4ee4\u884c\u53ef\u6267\u884c\u7684\u547d\u4ee4\u3002\u811a\u672c\u5bf9\u4e8e\u5728 Composer \u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6267\u884c\u4e00\u4e2a\u8d44\u6e90\u5305\u7684\u81ea\u5b9a\u4e49\u4ee3\u7801\u6216\u5305\u4e13\u7528\u547d\u4ee4\u662f\u975e\u5e38\u6709\u7528\u7684\u3002\\n\\n> **\u6ce8\u610f\uff1a** \u53ea\u6709\u5728\u6839\u5305\u7684 `composer.json` \u4e2d\u5b9a\u4e49\u7684\u811a\u672c\u624d\u4f1a\u88ab\u6267\u884c\u3002\u5373\u4fbf\u6839\u5305\u7684\u5916\u90e8\u4f9d\u8d56\u5b9a\u4e49\u4e86\u5176\u81ea\u8eab\u7684\u811a\u672c\uff0cComposer \u4e5f\u4e0d\u4f1a\u53bb\u6267\u884c\u8fd9\u4e9b\u989d\u5916\u7684\u811a\u672c\u3002\\n\\n\\n## \u4e8b\u4ef6\u540d\u79f0\\n\\nComposer \u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5c06\u4f1a\u89e6\u53d1\u4ee5\u4e0b\u4e8b\u4ef6\uff1a\\n\\n\u4e8b\u4ef6\u540d\u79f0 |\\t\u8be6\u7ec6\u8bf4\u660e\\n-----------|-----------------\\n`pre-install-cmd`  |  \u5728 install \u547d\u4ee4\u6267\u884c\u524d\u89e6\u53d1\u3002\\n`post-install-cmd`  | \u5728 install \u547d\u4ee4\u6267\u884c\u540e\u89e6\u53d1\u3002\\n`pre-update-cmd`  |  \u5728 update \u547d\u4ee4\u6267\u884c\u524d\u89e6\u53d1\u3002\\n`post-update-cmd`  | \u5728 update \u547d\u4ee4\u6267\u884c\u540e\u89e6\u53d1\u3002\\n`pre-status-cmd`  |  \u5728 status \u547d\u4ee4\u6267\u884c\u524d\u89e6\u53d1\u3002\\n`post-status-cmd`  | \u5728 status \u547d\u4ee4\u6267\u884c\u540e\u89e6\u53d1\u3002\\n`pre-package-install` | \u5728\u8d44\u6e90\u5305\u5b89\u88c5\u524d\u89e6\u53d1\u3002\\n`post-package-install` |    \u5728\u8d44\u6e90\u5305\u5b89\u88c5\u540e\u89e6\u53d1\u3002\\n`pre-package-update` |  \u5728\u8d44\u6e90\u5305\u66f4\u65b0\u524d\u89e6\u53d1\u3002\\n`post-package-update` | \u5728\u8d44\u6e90\u5305\u66f4\u65b0\u540e\u89e6\u53d1\u3002\\n`pre-package-uninstall` |   \u5728\u8d44\u6e90\u5305\u88ab\u5378\u8f7d\u524d\u89e6\u53d1\u3002\\n`post-package-uninstall` |  \u5728\u8d44\u6e90\u5305\u88ab\u5378\u8f7d\u540e\u89e6\u53d1\u3002\\n`pre-autoload-dump`  |  \u5728\u81ea\u52a8\u52a0\u8f7d\u5668\u88ab\u8f6c\u50a8\u524d\u89e6\u53d1\uff0c\u65e0\u8bba\u662f `install/update` \u8fd8\u662f `dump-autoload` \u547d\u4ee4\u90fd\u4f1a\u89e6\u53d1\u3002\\n`post-autoload-dump` |  \u5728\u81ea\u52a8\u52a0\u8f7d\u5668\u88ab\u8f6c\u50a8\u540e\u89e6\u53d1\uff0c\u65e0\u8bba\u662f `install/update` \u8fd8\u662f `dump-autoload` \u547d\u4ee4\u90fd\u4f1a\u89e6\u53d1\u3002\\n`post-root-package-install` |   \u5728 `create-project` \u547d\u4ee4\u671f\u95f4\uff0c\u6839\u5305\u5b89\u88c5\u5b8c\u6210\u540e\u89e6\u53d1\u3002\\n`post-create-project-cmd` | \u5728 create-project \u547d\u4ee4\u6267\u884c\u540e\u89e6\u53d1\u3002\\n`pre-archive-cmd`  | occurs before the archive command is executed.\\n`post-archive-cmd` | occurs after the archive command is executed.\\n\\n\\n> **\u6ce8\u610f\uff1a**Composer \u4e0d\u4f1a\u53bb\u6267\u884c\u4efb\u4f55\u4f9d\u8d56\u5305\u4e2d\u5b9a\u4e49\u7684 install \u6216 update \u76f8\u5173\u811a\u672c\u3002\u56e0\u6b64\u4f60\u4e0d\u5e94\u8be5\u5728\u4f9d\u8d56\u5305\u4e2d\u7533\u660e `pre-update-cmd` \u6216 `pre-install-cmd`\u3002\u5982\u679c\u4f60\u9700\u8981\u5728\u6267\u884c install \u6216 update \u547d\u4ee4\u524d\u4f7f\u7528\u811a\u672c\uff0c\u8bf7\u786e\u4fdd\u5b83\u4eec\u5df2\u88ab\u5b9a\u4e49\u5728\u6839\u5305\u4e2d\u3002\\n\\n## \u5b9a\u4e49\u811a\u672c\\n\\n\u5728 `composer.json` \u7684\u6839 JSON \u5bf9\u8c61\u4e2d\u5e94\u8be5\u6709\u4e00\u4e2a\u540d\u4e3a \\"scripts\\" \u7684\u5c5e\u6027\uff0c\u5b83\u5305\u542b\u6709\u4e00\u7cfb\u5217\u7684\u4e8b\u4ef6\u540d\u79f0\uff0c\u4ee5\u53ca\u5bf9\u5e94\u7684\u4e8b\u4ef6\u811a\u672c\u3002\u4e00\u4e2a\u4e8b\u4ef6\u7684\u811a\u672c\u53ef\u4ee5\u88ab\u5b9a\u4e49\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\uff08\u4ec5\u9002\u7528\u4e8e\u5355\u4e2a\u811a\u672c\uff09\u6216\u6570\u7ec4\uff08\u5355\u4e2a\u6216\u591a\u4e2a\u811a\u672c\uff09\u3002\\n\\n\u5bf9\u4e8e\u4efb\u4f55\u7ed9\u5b9a\u7684\u4e8b\u4ef6\uff1a\\n\\n* \u811a\u672c\u5c06\u6309\u7167\u4e8b\u4ef6\u548c\u5b9a\u4e49\u7684\u987a\u5e8f\u89e6\u53d1\u3002\\n* \u4e00\u4e2a\u811a\u672c\u6570\u7ec4\u53ef\u4ee5\u5305\u542b PHP \u56de\u8c03\u548c\u547d\u4ee4\u884c\u53ef\u6267\u884c\u547d\u4ee4\u3002\\n* \u7531 PHP \u7c7b\u6587\u4ef6\u5305\u542b\u7684\u56de\u8c03\uff0c\u5176\u5b58\u653e\u7684\u4f4d\u7f6e\u5fc5\u987b\u786e\u4fdd Composer \u80fd\u591f\u6b63\u786e\u7684\u8f7d\u5165\u3002\\n\\n\u811a\u672c\u5b9a\u4e49\u5b9e\u4f8b\uff1a\\n\\n```\\n{\\n    \\"scripts\\": {\\n        \\"post-update-cmd\\": \\"MyVendor\\\\\\\\MyClass::postUpdate\\",\\n        \\"post-package-install\\": [\\n            \\"MyVendor\\\\\\\\MyClass::postPackageInstall\\"\\n        ],\\n        \\"post-install-cmd\\": [\\n            \\"MyVendor\\\\\\\\MyClass::warmCache\\",\\n            \\"phpunit -c app/\\"\\n        ]\\n    }\\n}\\n```\\n\\n\u4f7f\u7528\u524d\u9762\u5b9a\u4e49\u7684\u4f8b\u5b50\uff0c\u8fd9\u91cc\u7684 MyVendor\\\\MyClass \u7c7b\uff0c\u5c31\u53ef\u4ee5\u88ab\u4f7f\u7528\u6765\u6267\u884c PHP \u7684\u56de\u8c03\uff1a\\n\\n```\\n<?php\\n\\nnamespace MyVendor;\\n\\nuse Composer\\\\Script\\\\Event;\\n\\nclass MyClass\\n{\\n    public static function postUpdate(Event $event)\\n    {\\n        $composer = $event->getComposer();\\n        // do stuff\\n    }\\n\\n    public static function postPackageInstall(Event $event)\\n    {\\n        $installedPackage = $event->getOperation()->getPackage();\\n        // do stuff\\n    }\\n\\n    public static function warmCache(Event $event)\\n    {\\n        // make cache toasty\\n    }\\n}\\n```\\n\\n\u5f53\u4e00\u4e2a\u4e8b\u4ef6\u88ab\u89e6\u53d1\uff0cComposer \u7684\u5185\u90e8\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u5c06\u63a5\u6536\u4e00\u4e2a `Composer\\\\Script\\\\Event` \u5bf9\u8c61\uff0c\u8fd9\u662f\u4f20\u9012\u7ed9\u60a8\u7684 PHP \u56de\u8c03\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002\u8fd9\u4e2a Event \u5bf9\u8c61\u62e5\u6709\u4e00\u4e9b getter \u65b9\u6cd5\u6765\u5e2e\u52a9\u4f60\u53d6\u5f97\u5f53\u524d\u4e8b\u4ef6\u7684\u4e0a\u4e0b\u6587\uff1a\\n\\n* getComposer(): \u8fd4\u56de\u5f53\u524d\u7684 Composer\\\\Composer \u5bf9\u8c61\u5b9e\u4f8b\u3002\\n* getName(): \u8fd4\u56de\u4e8b\u4ef6\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\\n* getIO(): \u8fd4\u56de\u5f53\u524d\u7684 \u8f93\u5165\\\\\u8f93\u51fa \u6d41\uff0c\u5b83\u5b9e\u73b0\u4e86 Composer\\\\IO\\\\IOInterface \u63a5\u53e3\uff0c\u4ee5\u4fbf\u5728\u63a7\u5236\u53f0\u4e2d\u4f7f\u7528\u3002\\n\\n## \u624b\u52a8\u8fd0\u884c\u811a\u672c\\n\\n\u5982\u679c\u4f60\u60f3\u624b\u52a8\u8fd0\u884c\u4e8b\u4ef6\u811a\u672c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u8bed\u6cd5\u7ed3\u6784\uff1a\\n\\n```\\ncomposer run-script [--dev] [--no-dev] script\\n```\\n\\n\u4f8b\u5982 `composer run-script post-install-cmd` \u5c06\u4f1a\u8fd0\u884c\u6240\u6709 `post-install-cmd` \u4e8b\u4ef6\u4e0b\u5b9a\u4e49\u7684\u811a\u672c\u3002\\n\\n\\n> \u8f6c\u81ea\uff1a[composer\u811a\u672c]http://docs.phpcomposer.com/articles/scripts.html"},{"id":"custom-vars-usage-in-ngnix-config","metadata":{"permalink":"/blog/custom-vars-usage-in-ngnix-config","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/05-13-custom-vars-usage-in-ngnix-config.md","source":"@site/blog/2016/05-13-custom-vars-usage-in-ngnix-config.md","title":"Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528","description":"Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528,\u5305\u62ec\u4ece\u5e38\u7528\u7684rewrite\u7b49\u65b9\u9762\u6765\u6df1\u5165\u53d8\u91cf\u7684\u76f8\u5173\u5b9a\u4e49,\u9700\u8981\u7684\u670b\u53cb\u53ef\u4ee5\u53c2\u8003\u4e0b","date":"2016-05-13T17:21:00.000Z","formattedDate":"2016\u5e745\u670813\u65e5","tags":[{"label":"ngnix","permalink":"/blog/tags/ngnix"}],"readingTime":25.575,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528","tags":["ngnix"],"date":"2016-05-13T17:21","slug":"custom-vars-usage-in-ngnix-config","authors":["inhere","network"]},"prevItem":{"title":"composer.json \u4e2d\u7684 scripts \u811a\u672c","permalink":"/blog/scripts-in-php-composer-json"},"nextItem":{"title":"Nginx\u5185\u7f6e\u53d8\u91cf\u5927\u5168","permalink":"/blog/nginx-built-in-vars-refers"}},"content":"Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528,\u5305\u62ec\u4ece\u5e38\u7528\u7684rewrite\u7b49\u65b9\u9762\u6765\u6df1\u5165\u53d8\u91cf\u7684\u76f8\u5173\u5b9a\u4e49,\u9700\u8981\u7684\u670b\u53cb\u53ef\u4ee5\u53c2\u8003\u4e0b \\n\\n\x3c!--truncate--\x3e\\n\\n## Nginx \u7528\u6237\u53d8\u91cf\\n\\nnginx \u7684\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u7684\u5c31\u662f\u4e00\u95e8\u5fae\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u8bb8\u591a\u771f\u5b9e\u4e16\u754c\u91cc\u7684 Nginx \u914d\u7f6e\u6587\u4ef6\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u4e00\u4e2a\u7684\u5c0f\u7a0b\u5e8f\u3002\u5f53\u7136\uff0c\u662f\u4e0d\u662f\u201c\u56fe\u7075\u5b8c\u5168\u7684\u201d\u6682\u4e14\u4e0d\u8bba\uff0c\u81f3\u5c11\u636e\u6211\u89c2\u5bdf\uff0c\u5b83\u5728\u8bbe\u8ba1\u4e0a\u53d7 Perl \u548c Bourne shell \u8fd9\u4e24\u79cd\u8bed\u8a00\u7684\u5f71\u54cd\u5f88\u5927\u3002\u5728\u8fd9\u4e00\u70b9\u4e0a\uff0c\u76f8\u6bd4 Apache \u548c Lighttpd \u7b49\u5176\u4ed6 Web \u670d\u52a1\u5668\u7684\u914d\u7f6e\u8bb0\u6cd5\uff0c\u4e0d\u80fd\u4e0d\u8bf4\u7b97\u662f Nginx \u7684\u4e00\u5927\u7279\u8272\u4e86\u3002\u65e2\u7136\u662f\u7f16\u7a0b\u8bed\u8a00\uff0c\u4e00\u822c\u4e5f\u5c31\u5c11\u4e0d\u4e86\u201c\u53d8\u91cf\u201d\u8fd9\u79cd\u4e1c\u897f\uff08\u5f53\u7136\uff0cHaskell \u8fd9\u6837\u5947\u602a\u7684\u51fd\u6570\u5f0f\u8bed\u8a00\u9664\u5916\u4e86\uff09\u3002\\n\u719f\u6089 Perl\u3001Bourne shell\u3001C/C++ \u7b49\u547d\u4ee4\u5f0f\u7f16\u7a0b\u8bed\u8a00\u7684\u670b\u53cb\u80af\u5b9a\u77e5\u9053\uff0c\u53d8\u91cf\u8bf4\u767d\u4e86\u5c31\u662f\u5b58\u653e\u201c\u503c\u201d\u7684\u5bb9\u5668\u3002\u800c\u6240\u8c13\u201c\u503c\u201d\uff0c\u5728\u8bb8\u591a\u7f16\u7a0b\u8bed\u8a00\u91cc\uff0c\u65e2\u53ef\u4ee5\u662f 3.14 \u8fd9\u6837\u7684\u6570\u503c\uff0c\u4e5f\u53ef\u4ee5\u662f hello world \u8fd9\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u751a\u81f3\u53ef\u4ee5\u662f\u50cf\u6570\u7ec4\u3001\u54c8\u5e0c\u8868\u8fd9\u6837\u7684\u590d\u6742\u6570\u636e\u7ed3\u6784\u3002\u7136\u800c\uff0c\u5728 Nginx \u914d\u7f6e\u4e2d\uff0c\u53d8\u91cf\u53ea\u80fd\u5b58\u653e\u4e00\u79cd\u7c7b\u578b\u7684\u503c\uff0c\u56e0\u4e3a\u4e5f\u53ea\u5b58\u5728\u4e00\u79cd\u7c7b\u578b\u7684\u503c\uff0c\u90a3\u5c31\u662f\u5b57\u7b26\u4e32\u3002\\n\u6bd4\u5982\u6211\u4eec\u7684 nginx.conf \u6587\u4ef6\u4e2d\u6709\u4e0b\u9762\u8fd9\u4e00\u884c\u914d\u7f6e\uff1a\\n\\n```\\nset $a \\"hello world\\"; \\n```\\n\\n\u6211\u4eec\u4f7f\u7528\u4e86\u6807\u51c6 ngx_rewrite \u6a21\u5757\u7684 set \u914d\u7f6e\u6307\u4ee4\u5bf9\u53d8\u91cf $a \u8fdb\u884c\u4e86\u8d4b\u503c\u64cd\u4f5c\u3002\u7279\u522b\u5730\uff0c\u6211\u4eec\u628a\u5b57\u7b26\u4e32 hello world \u8d4b\u7ed9\u4e86\u5b83\u3002\\n\u6211\u4eec\u770b\u5230\uff0cNginx \u53d8\u91cf\u540d\u524d\u9762\u6709\u4e00\u4e2a $ \u7b26\u53f7\uff0c\u8fd9\u662f\u8bb0\u6cd5\u4e0a\u7684\u8981\u6c42\u3002\u6240\u6709\u7684 Nginx \u53d8\u91cf\u5728 Nginx \u914d\u7f6e\u6587\u4ef6\u4e2d\u5f15\u7528\u65f6\u90fd\u987b\u5e26\u4e0a $ \u524d\u7f00\u3002\u8fd9\u79cd\u8868\u793a\u65b9\u6cd5\u548c Perl\u3001PHP \u8fd9\u4e9b\u8bed\u8a00\u662f\u76f8\u4f3c\u7684\u3002\\n\u867d\u7136 $ \u8fd9\u6837\u7684\u53d8\u91cf\u524d\u7f00\u4fee\u9970\u4f1a\u8ba9\u6b63\u7edf\u7684 Java \u548c C# \u7a0b\u5e8f\u5458\u4e0d\u8212\u670d\uff0c\u4f46\u8fd9\u79cd\u8868\u793a\u65b9\u6cd5\u7684\u597d\u5904\u4e5f\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u90a3\u5c31\u662f\u53ef\u4ee5\u76f4\u63a5\u628a\u53d8\u91cf\u5d4c\u5165\u5230\u5b57\u7b26\u4e32\u5e38\u91cf\u4e2d\u4ee5\u6784\u9020\u51fa\u65b0\u7684\u5b57\u7b26\u4e32\uff1a\\n\\n```\\nset $a hello;  \\nset $b \\"$a, $a\\"; \\n```\\n\\n\u8fd9\u91cc\u6211\u4eec\u901a\u8fc7\u5df2\u6709\u7684 Nginx \u53d8\u91cf $a \u7684\u503c\uff0c\u6765\u6784\u9020\u53d8\u91cf $b \u7684\u503c\uff0c\u4e8e\u662f\u8fd9\u4e24\u6761\u6307\u4ee4\u987a\u5e8f\u6267\u884c\u5b8c\u4e4b\u540e\uff0c$a \u7684\u503c\u662f hello\uff0c\u800c $b \u7684\u503c\u5219\u662f hello, hello. \u8fd9\u79cd\u6280\u672f\u5728 Perl \u4e16\u754c\u91cc\u88ab\u79f0\u4e3a\u201c\u53d8\u91cf\u63d2\u503c\u201d\uff08variable interpolation\uff09\uff0c\u5b83\u8ba9\u4e13\u95e8\u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u8fd0\u7b97\u7b26\u53d8\u5f97\u4e0d\u518d\u90a3\u4e48\u5fc5\u8981\u3002\u6211\u4eec\u5728\u8fd9\u91cc\u4e5f\u4e0d\u59a8\u91c7\u7528\u6b64\u672f\u8bed\u3002\\n\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u6bd4\u8f83\u5b8c\u6574\u7684\u914d\u7f6e\u793a\u4f8b\uff1a\\n\\n```\\nserver {  \\n  listen 8080;  \\n \\n  location /test {  \\n    set $foo hello;  \\n    echo \\"foo: $foo\\";  \\n  }  \\n} \\n```\\n\\n\u8fd9\u4e2a\u4f8b\u5b50\u7701\u7565\u4e86 nginx.conf \u914d\u7f6e\u6587\u4ef6\u4e2d\u6700\u5916\u56f4\u7684 http \u914d\u7f6e\u5757\u4ee5\u53ca events \u914d\u7f6e\u5757\u3002\u4f7f\u7528 curl \u8fd9\u4e2a HTTP \u5ba2\u6237\u7aef\u5728\u547d\u4ee4\u884c\u4e0a\u8bf7\u6c42\u8fd9\u4e2a /test \u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\\n\\n```\\n$ curl \'http://localhost:8080/test\'  \\nfoo: hello \\n```\\n\\n\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u7b2c\u4e09\u65b9 ngx_echo \u6a21\u5757\u7684 echo \u914d\u7f6e\u6307\u4ee4\u5c06 $foo \u53d8\u91cf\u7684\u503c\u4f5c\u4e3a\u5f53\u524d\u8bf7\u6c42\u7684\u54cd\u5e94\u4f53\u8f93\u51fa\u3002\\n\u6211\u4eec\u770b\u5230\uff0cecho \u914d\u7f6e\u6307\u4ee4\u7684\u53c2\u6570\u4e5f\u652f\u6301\u201c\u53d8\u91cf\u63d2\u503c\u201d\u3002\u4e0d\u8fc7\uff0c\u9700\u8981\u8bf4\u660e\u7684\u662f\uff0c\u5e76\u975e\u6240\u6709\u7684\u914d\u7f6e\u6307\u4ee4\u90fd\u652f\u6301\u201c\u53d8\u91cf\u63d2\u503c\u201d\u3002\u4e8b\u5b9e\u4e0a\uff0c\u6307\u4ee4\u53c2\u6570\u662f\u5426\u5141\u8bb8\u201c\u53d8\u91cf\u63d2\u503c\u201d\uff0c\u53d6\u51b3\u4e8e\u8be5\u6307\u4ee4\u7684\u5b9e\u73b0\u6a21\u5757\u3002\\n\u5982\u679c\u6211\u4eec\u60f3\u901a\u8fc7 echo \u6307\u4ee4\u76f4\u63a5\u8f93\u51fa\u542b\u6709\u201c\u7f8e\u5143\u7b26\u201d\uff08$\uff09\u7684\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u6709\u6ca1\u6709\u529e\u6cd5\u628a\u7279\u6b8a\u7684 $ \u5b57\u7b26\u7ed9\u8f6c\u4e49\u6389\u5462\uff1f\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff08\u81f3\u5c11\u5230\u76ee\u524d\u6700\u65b0\u7684 Nginx \u7a33\u5b9a\u7248 1.0.10\uff09\u3002\u4e0d\u8fc7\u5e78\u8fd0\u7684\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed5\u8fc7\u8fd9\u4e2a\u9650\u5236\uff0c\u6bd4\u5982\u901a\u8fc7\u4e0d\u652f\u6301\u201c\u53d8\u91cf\u63d2\u503c\u201d\u7684\u6a21\u5757\u914d\u7f6e\u6307\u4ee4\u4e13\u95e8\u6784\u9020\u51fa\u53d6\u503c\u4e3a $ \u7684 Nginx \u53d8\u91cf\uff0c\u7136\u540e\u518d\u5728 echo \u4e2d\u4f7f\u7528\u8fd9\u4e2a\u53d8\u91cf\u3002\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\ngeo $dollar {  \\n  default \\"$\\";  \\n}  \\n \\nserver {  \\n  listen 8080;  \\n \\n  location /test {  \\n    echo \\"This is a dollar sign: $dollar\\";  \\n  }  \\n} \\n```\\n\\n\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test\'  \\nThis is a dollar sign: $ \\n```\\n\\n\u8fd9\u91cc\u7528\u5230\u4e86\u6807\u51c6\u6a21\u5757 ngx_geo \u63d0\u4f9b\u7684\u914d\u7f6e\u6307\u4ee4 geo \u6765\u4e3a\u53d8\u91cf $dollar \u8d4b\u4e88\u5b57\u7b26\u4e32 \\"$\\"\uff0c\u8fd9\u6837\u6211\u4eec\u5728\u4e0b\u9762\u9700\u8981\u4f7f\u7528\u7f8e\u5143\u7b26\u7684\u5730\u65b9\uff0c\u5c31\u76f4\u63a5\u5f15\u7528\u6211\u4eec\u7684 $dollar \u53d8\u91cf\u5c31\u53ef\u4ee5\u4e86\u3002\u5176\u5b9e ngx_geo \u6a21\u5757\u6700\u5e38\u89c4\u7684\u7528\u6cd5\u662f\u6839\u636e\u5ba2\u6237\u7aef\u7684 IP \u5730\u5740\u5bf9\u6307\u5b9a\u7684 Nginx \u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\uff0c\u8fd9\u91cc\u53ea\u662f\u501f\u7528\u5b83\u4ee5\u4fbf\u201c\u65e0\u6761\u4ef6\u5730\u201d\u5bf9\u6211\u4eec\u7684 $dollar \u53d8\u91cf\u8d4b\u4e88\u201c\u7f8e\u5143\u7b26\u201d\u8fd9\u4e2a\u503c\u3002\\n\u5728\u201c\u53d8\u91cf\u63d2\u503c\u201d\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u8fd8\u6709\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff0c\u5373\u5f53\u5f15\u7528\u7684\u53d8\u91cf\u540d\u4e4b\u540e\u7d27\u8ddf\u7740\u53d8\u91cf\u540d\u7684\u6784\u6210\u5b57\u7b26\u65f6\uff08\u6bd4\u5982\u540e\u8ddf\u5b57\u6bcd\u3001\u6570\u5b57\u4ee5\u53ca\u4e0b\u5212\u7ebf\uff09\uff0c\u6211\u4eec\u5c31\u9700\u8981\u4f7f\u7528\u7279\u522b\u7684\u8bb0\u6cd5\u6765\u6d88\u9664\u6b67\u4e49\uff0c\u4f8b\u5982\uff1a\\n\\n```\\nserver {  \\n  listen 8080;  \\n \\n  location /test {  \\n    set $first \\"hello \\";  \\n    echo \\"${first}world\\";  \\n  }  \\n} \\n```\\n\\n\u8fd9\u91cc\uff0c\u6211\u4eec\u5728 echo \u914d\u7f6e\u6307\u4ee4\u7684\u53c2\u6570\u503c\u4e2d\u5f15\u7528\u53d8\u91cf $first \u7684\u65f6\u5019\uff0c\u540e\u9762\u7d27\u8ddf\u7740 world \u8fd9\u4e2a\u5355\u8bcd\uff0c\u6240\u4ee5\u5982\u679c\u76f4\u63a5\u5199\u4f5c \\"$firstworld\\" \u5219 Nginx \u201c\u53d8\u91cf\u63d2\u503c\u201d\u8ba1\u7b97\u5f15\u64ce\u4f1a\u5c06\u4e4b\u8bc6\u522b\u4e3a\u5f15\u7528\u4e86\u53d8\u91cf $firstworld. \u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u96be\u9898\uff0cNginx \u7684\u5b57\u7b26\u4e32\u8bb0\u6cd5\u652f\u6301\u4f7f\u7528\u82b1\u62ec\u53f7\u5728 $ \u4e4b\u540e\u628a\u53d8\u91cf\u540d\u56f4\u8d77\u6765\uff0c\u6bd4\u5982\u8fd9\u91cc\u7684 ${first}. \u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u7684\u8f93\u51fa\u662f\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test  \\nhello world \\n```\\n\\nset \u6307\u4ee4\uff08\u4ee5\u53ca\u524d\u9762\u63d0\u5230\u7684 geo \u6307\u4ee4\uff09\u4e0d\u4ec5\u6709\u8d4b\u503c\u7684\u529f\u80fd\uff0c\u5b83\u8fd8\u6709\u521b\u5efa Nginx \u53d8\u91cf\u7684\u526f\u4f5c\u7528\uff0c\u5373\u5f53\u4f5c\u4e3a\u8d4b\u503c\u5bf9\u8c61\u7684\u53d8\u91cf\u5c1a\u4e0d\u5b58\u5728\u65f6\uff0c\u5b83\u4f1a\u81ea\u52a8\u521b\u5efa\u8be5\u53d8\u91cf\u3002\u6bd4\u5982\u5728\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c $a \u8fd9\u4e2a\u53d8\u91cf\u5c1a\u672a\u521b\u5efa\uff0c\u5219 set \u6307\u4ee4\u4f1a\u81ea\u52a8\u521b\u5efa $a \u8fd9\u4e2a\u7528\u6237\u53d8\u91cf\u3002\u5982\u679c\u6211\u4eec\u4e0d\u521b\u5efa\u5c31\u76f4\u63a5\u4f7f\u7528\u5b83\u7684\u503c\uff0c\u5219\u4f1a\u62a5\u9519\u3002\u4f8b\u5982\\n\\n```\\nserver {  \\n  listen 8080;  \\n  \\n  location /bad {  \\n    echo $foo;  \\n  }  \\n } \\n```\\n \\n\u6b64\u65f6 Nginx \u670d\u52a1\u5668\u4f1a\u62d2\u7edd\u52a0\u8f7d\u914d\u7f6e:\\n\\n```\\n[emerg] unknown \\"foo\\" variable\\n```\\n\\n\u662f\u7684\uff0c\u6211\u4eec\u751a\u81f3\u90fd\u65e0\u6cd5\u542f\u52a8\u670d\u52a1\uff01\\n\\n\u6709\u8da3\u7684\u662f\uff0c**Nginx \u53d8\u91cf\u7684\u521b\u5efa\u548c\u8d4b\u503c\u64cd\u4f5c\u53d1\u751f\u5728\u5168\u7136\u4e0d\u540c\u7684\u65f6\u95f4\u9636\u6bb5**\u3002\\n- Nginx \u53d8\u91cf\u7684\u521b\u5efa\u53ea\u80fd\u53d1\u751f\u5728 Nginx \u914d\u7f6e\u52a0\u8f7d\u7684\u65f6\u5019\uff0c\u6216\u8005\u8bf4 Nginx \u542f\u52a8\u7684\u65f6\u5019\uff1b\\n- \u8d4b\u503c\u64cd\u4f5c\u5219\u53ea\u4f1a\u53d1\u751f\u5728\u8bf7\u6c42\u5b9e\u9645\u5904\u7406\u7684\u65f6\u5019\u3002\\n\\n> \u8fd9\u610f\u5473\u7740\u4e0d\u521b\u5efa\u800c\u76f4\u63a5\u4f7f\u7528\u53d8\u91cf\u4f1a\u5bfc\u81f4\u542f\u52a8\u5931\u8d25\uff0c\u540c\u65f6\u4e5f\u610f\u5473\u7740\u6211\u4eec\u65e0\u6cd5\u5728\u8bf7\u6c42\u5904\u7406\u65f6\u52a8\u6001\u5730\u521b\u5efa\u65b0\u7684 Nginx \u53d8\u91cf\u3002\\n\\nNginx \u53d8\u91cf\u4e00\u65e6\u521b\u5efa\uff0c\u5176\u53d8\u91cf\u540d\u7684\u53ef\u89c1\u8303\u56f4\u5c31\u662f\u6574\u4e2a Nginx \u914d\u7f6e\uff0c\u751a\u81f3\u53ef\u4ee5\u8de8\u8d8a\u4e0d\u540c\u865a\u62df\u4e3b\u673a\u7684 server \u914d\u7f6e\u5757\u3002\\n\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\nserver {  \\n  listen 8080;  \\n \\n  location /foo {  \\n    echo \\"foo = [$foo]\\";  \\n  }  \\n \\n  location /bar {  \\n    set $foo 32;  \\n    echo \\"foo = [$foo]\\";  \\n  }  \\n} \\n```\\n \\n\u8fd9\u91cc\u6211\u4eec\u5728 `location /bar` \u4e2d\u7528 set \u6307\u4ee4\u521b\u5efa\u4e86\u53d8\u91cf `$foo`\uff0c\u4e8e\u662f**\u5728\u6574\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fd9\u4e2a\u53d8\u91cf\u90fd\u662f\u53ef\u89c1\u7684**\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728 location /foo \u4e2d\u76f4\u63a5\u5f15\u7528\u8fd9\u4e2a\u53d8\u91cf\u800c\u4e0d\u7528\u62c5\u5fc3 Nginx \u4f1a\u62a5\u9519\u3002\\n\\n\u4e0b\u9762\u662f\u5728\u547d\u4ee4\u884c\u4e0a\u7528 curl \u5de5\u5177\u8bbf\u95ee\u8fd9\u4e24\u4e2a\u63a5\u53e3\u7684\u7ed3\u679c\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/foo\'  \\nfoo = []  \\n$ curl \'http://localhost:8080/bar\'  \\nfoo = [32]  \\n$ curl \'http://localhost:8080/foo\'  \\nfoo = [] \\n```\\n\\n\u4ece\u8fd9\u4e2a\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0cset \u6307\u4ee4\u56e0\u4e3a\u662f\u5728 `location /bar` \u4e2d\u4f7f\u7528\u7684\uff0c\u6240\u4ee5**\u8d4b\u503c\u64cd\u4f5c\u53ea\u4f1a\u5728\u8bbf\u95ee /bar \u7684\u8bf7\u6c42\u4e2d\u6267\u884c**\u3002\u800c\u8bf7\u6c42 `/foo` \u63a5\u53e3\u65f6\uff0c\u6211\u4eec\u603b\u662f\u5f97\u5230\u7a7a\u7684 $foo \u503c\uff0c\u56e0\u4e3a**\u7528\u6237\u53d8\u91cf\u672a\u8d4b\u503c\u5c31\u8f93\u51fa\u7684\u8bdd\uff0c\u5f97\u5230\u7684\u4fbf\u662f\u7a7a\u5b57\u7b26\u4e32**\u3002\\n\\n\u4ece\u8fd9\u4e2a\u4f8b\u5b50\u6211\u4eec\u53ef\u4ee5\u7aa5\u89c1\u7684\u53e6\u4e00\u4e2a\u91cd\u8981\u7279\u6027\u662f\uff0c**Nginx \u53d8\u91cf\u540d\u7684\u53ef\u89c1\u8303\u56f4\u867d\u7136\u662f\u6574\u4e2a\u914d\u7f6e\uff0c\u4f46\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u6709\u6240\u6709\u53d8\u91cf\u7684\u72ec\u7acb\u526f\u672c\uff0c\u6216\u8005\u8bf4\u90fd\u6709\u5404\u53d8\u91cf\u7528\u6765\u5b58\u653e\u503c\u7684\u5bb9\u5668\u7684\u72ec\u7acb\u526f\u672c\uff0c\u5f7c\u6b64\u4e92\u4e0d\u5e72\u6270**\u3002\u6bd4\u5982\u524d\u9762\u6211\u4eec\u8bf7\u6c42\u4e86 `/bar` \u63a5\u53e3\u540e\uff0c`$foo` \u53d8\u91cf\u88ab\u8d4b\u4e88\u4e86\u503c 32\uff0c\u4f46\u5b83\u4e1d\u6beb\u4e0d\u4f1a\u5f71\u54cd\u540e\u7eed\u5bf9 `/foo` \u63a5\u53e3\u7684\u8bf7\u6c42\u6240\u5bf9\u5e94\u7684 $foo \u503c\uff08**\u5b83\u4ecd\u7136\u662f\u7a7a\u7684\uff01**\uff09\uff0c\u56e0\u4e3a\u5404\u4e2a\u8bf7\u6c42\u90fd\u6709\u81ea\u5df1\u72ec\u7acb\u7684 $foo \u53d8\u91cf\u7684\u526f\u672c\u3002\\n\u5bf9\u4e8e Nginx \u65b0\u624b\u6765\u8bf4\uff0c\u6700\u5e38\u89c1\u7684\u9519\u8bef\u4e4b\u4e00\uff0c\u5c31\u662f\u5c06 Nginx \u53d8\u91cf\u7406\u89e3\u6210\u67d0\u79cd\u5728\u8bf7\u6c42\u4e4b\u95f4\u5168\u5c40\u5171\u4eab\u7684\u4e1c\u897f\uff0c\u6216\u8005\u8bf4\u201c\u5168\u5c40\u53d8\u91cf\u201d\u3002\u800c\u4e8b\u5b9e\u4e0a\uff0cNginx \u53d8\u91cf\u7684\u751f\u547d\u671f\u662f\u4e0d\u53ef\u80fd\u8de8\u8d8a\u8bf7\u6c42\u8fb9\u754c\u7684\u3002\\n\\n\u5173\u4e8e nginx \u53d8\u91cf\u7684\u53e6\u4e00\u4e2a\u5e38\u89c1\u8bef\u533a\u662f\u8ba4\u4e3a\u53d8\u91cf\u5bb9\u5668\u7684\u751f\u547d\u671f\uff0c\u662f\u4e0e `location` \u914d\u7f6e\u5757\u7ed1\u5b9a\u7684\u3002\\n\\n\u5176\u5b9e\u4e0d\u7136,\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u6d89\u53ca\u201c\u5185\u90e8\u8df3\u8f6c\u201d\u7684\u4f8b\u5b50\uff1a\\n\\n```\\nserver {  \\n  listen 8080;  \\n  location /foo {  \\n    set $a hello;  \\n    echo_exec /bar;  \\n  }  \\n  location /bar {  \\n    echo \\"a = [$a]\\";  \\n  }  \\n} \\n```\\n\\n\u8fd9\u91cc\u6211\u4eec\u5728 location /foo \u4e2d\uff0c\u4f7f\u7528\u7b2c\u4e09\u65b9\u6a21\u5757 `ngx_echo` \u63d0\u4f9b\u7684 `echo_exec` \u914d\u7f6e\u6307\u4ee4\uff0c\u53d1\u8d77\u5230 `location /bar` \u7684\u201c\u5185\u90e8\u8df3\u8f6c\u201d\u3002\u6240\u8c13\u201c\u5185\u90e8\u8df3\u8f6c\u201d\uff0c\u5c31\u662f\u5728\u5904\u7406\u8bf7\u6c42\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4e8e\u670d\u52a1\u5668\u5185\u90e8\uff0c_\u4ece\u4e00\u4e2a `location` \u8df3\u8f6c\u5230\u53e6\u4e00\u4e2a `location` \u7684\u8fc7\u7a0b_\u3002\u8fd9\u4e0d\u540c\u4e8e\u5229\u7528 HTTP \u72b6\u6001\u7801 301 \u548c 302 \u6240\u8fdb\u884c\u7684\u201c\u5916\u90e8\u8df3\u8f6c\u201d\uff0c\u56e0\u4e3a\u540e\u8005\u662f\u7531 HTTP \u5ba2\u6237\u7aef\u914d\u5408\u8fdb\u884c\u8df3\u8f6c\u7684\uff0c\u800c\u4e14\u5728\u5ba2\u6237\u7aef\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8fd9\u6837\u7684\u754c\u9762\uff0c\u770b\u5230\u8bf7\u6c42\u7684 URL \u5730\u5740\u53d1\u751f\u4e86\u53d8\u5316\u3002\u5185\u90e8\u8df3\u8f6c\u548c Bourne shell\uff08\u6216 Bash\uff09\u4e2d\u7684 exec \u547d\u4ee4\u5f88\u50cf\uff0c\u90fd\u662f\u201c\u6709\u53bb\u65e0\u56de\u201d\u3002\u53e6\u4e00\u4e2a\u76f8\u8fd1\u7684\u4f8b\u5b50\u662f C \u8bed\u8a00\u4e2d\u7684 goto \u8bed\u53e5\u3002\\n\u65e2\u7136\u662f\u5185\u90e8\u8df3\u8f6c\uff0c\u5f53\u524d\u6b63\u5728\u5904\u7406\u7684\u8bf7\u6c42\u5c31\u8fd8\u662f\u539f\u6765\u90a3\u4e2a\uff0c\u53ea\u662f\u5f53\u524d\u7684 `location` \u53d1\u751f\u4e86\u53d8\u5316\uff0c\u6240\u4ee5\u8fd8\u662f\u539f\u6765\u7684\u90a3\u4e00\u5957 nginx \u53d8\u91cf\u7684\u5bb9\u5668\u526f\u672c\u3002\u5bf9\u5e94\u5230\u4e0a\u4f8b\uff0c\u5982\u679c\u6211\u4eec\u8bf7\u6c42\u7684\u662f /foo \u8fd9\u4e2a\u63a5\u53e3\uff0c\u90a3\u4e48\u6574\u4e2a\u5de5\u4f5c\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a\\n- \u5148\u5728 location /foo \u4e2d\u901a\u8fc7 set \u6307\u4ee4\u5c06 $a \u53d8\u91cf\u7684\u503c\u8d4b\u4e3a\u5b57\u7b26\u4e32 hello\uff0c\\n- \u7136\u540e\u901a\u8fc7 echo_exec \u6307\u4ee4\u53d1\u8d77\u5185\u90e8\u8df3\u8f6c\uff0c\\n- \u53c8\u8fdb\u5165\u5230 `location /bar` \u4e2d\uff0c\\n- \u518d\u8f93\u51fa $a \u53d8\u91cf\u7684\u503c\u3002\\n\\n\u56e0\u4e3a $a \u8fd8\u662f\u539f\u6765\u7684 $a\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u671f\u671b\u5f97\u5230 hello \u8fd9\u884c\u8f93\u51fa\u3002\u6d4b\u8bd5\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\uff1a\\n\\n```\\n$ curl localhost:8080/foo  \\na = [hello] \\n```\\n\\n\u4f46\u5982\u679c\u6211\u4eec\u4ece\u5ba2\u6237\u7aef\u76f4\u63a5\u8bbf\u95ee `/bar` \u63a5\u53e3\uff0c\u5c31\u4f1a\u5f97\u5230\u7a7a\u7684 `$a` \u53d8\u91cf\u7684\u503c\uff0c\u56e0\u4e3a\u5b83\u4f9d\u8d56\u4e8e `location /foo` \u6765\u5bf9 $a \u8fdb\u884c\u521d\u59cb\u5316\u3002\u4ece\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u6211\u4eec\u770b\u5230\uff0c**\u4e00\u4e2a\u8bf7\u6c42\u5728\u5176\u5904\u7406\u8fc7\u7a0b\u4e2d\uff0c\u5373\u4f7f\u7ecf\u5386\u591a\u4e2a\u4e0d\u540c\u7684 location \u914d\u7f6e\u5757\uff0c\u5b83\u4f7f\u7528\u7684\u8fd8\u662f\u540c\u4e00\u5957 Nginx \u53d8\u91cf\u7684\u526f\u672c**\u3002\u8fd9\u91cc\uff0c\u6211\u4eec\u4e5f\u9996\u6b21\u6d89\u53ca\u5230\u4e86\u201c\u5185\u90e8\u8df3\u8f6c\u201d\u8fd9\u4e2a\u6982\u5ff5\u3002\\n\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u6807\u51c6 `ngx_rewrite` \u6a21\u5757\u7684 rewrite \u914d\u7f6e\u6307\u4ee4\u5176\u5b9e\u4e5f\u53ef\u4ee5\u53d1\u8d77\u201c\u5185\u90e8\u8df3\u8f6c\u201d\uff0c\u4f8b\u5982\u4e0a\u9762\u90a3\u4e2a\u4f8b\u5b50\u7528 rewrite \u914d\u7f6e\u6307\u4ee4\u53ef\u4ee5\u6539\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u7684\u5f62\u5f0f\uff1a\\n\\n```\\nserver {  \\n  listen 8080;  \\n  location /foo {  \\n    set $a hello;  \\n    rewrite ^ /bar;  \\n  }  \\n  location /bar {  \\n    echo \\"a = [$a]\\";  \\n  }  \\n}\\n```\\n  \\n\u5176\u6548\u679c\u548c\u4f7f\u7528 echo_exec \u662f\u5b8c\u5168\u76f8\u540c\u7684\u3002\u540e\u9762\u6211\u4eec\u8fd8\u4f1a\u4e13\u95e8\u4ecb\u7ecd\u8fd9\u4e2a rewrite \u6307\u4ee4\u7684\u66f4\u591a\u7528\u6cd5\uff0c\u6bd4\u5982\u53d1\u8d77 301 \u548c 302 \u8fd9\u6837\u7684\u201c\u5916\u90e8\u8df3\u8f6c\u201d\u3002\u4ece\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u6211\u4eec\u770b\u5230\uff0cNginx \u53d8\u91cf\u503c\u5bb9\u5668\u7684\u751f\u547d\u671f\u662f\u4e0e\u5f53\u524d\u6b63\u5728\u5904\u7406\u7684\u8bf7\u6c42\u7ed1\u5b9a\u7684\uff0c\u800c\u4e0e location \u65e0\u5173\u3002\u524d\u9762\u6211\u4eec\u63a5\u89e6\u5230\u7684\u90fd\u662f\u901a\u8fc7 set \u6307\u4ee4\u9690\u5f0f\u521b\u5efa\u7684 Nginx \u53d8\u91cf\u3002\u8fd9\u4e9b\u53d8\u91cf\u6211\u4eec\u4e00\u822c\u79f0\u4e3a\u201c\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u201d\uff0c\u6216\u8005\u66f4\u7b80\u5355\u4e00\u4e9b\uff0c\u201c\u7528\u6237\u53d8\u91cf\u201d\u3002\u65e2\u7136\u6709\u201c\u7528\u6237\u81ea\u5b9a\u4e49\u53d8\u91cf\u201d\uff0c\u81ea\u7136\u4e5f\u5c31\u6709\u7531 Nginx \u6838\u5fc3\u548c\u5404\u4e2a Nginx \u6a21\u5757\u63d0\u4f9b\u7684\u201c\u9884\u5b9a\u4e49\u53d8\u91cf\u201d\uff0c\u6216\u8005\u8bf4\u201c\u5185\u5efa\u53d8\u91cf\u201d\uff08builtin variables\uff09\u3002\\n\\n## Nginx \u5185\u5efa\u53d8\u91cf\\n\\nNginx \u5185\u5efa\u53d8\u91cf\u6700\u5e38\u89c1\u7684\u7528\u9014\u5c31\u662f\u83b7\u53d6\u5173\u4e8e\u8bf7\u6c42\u6216\u54cd\u5e94\u7684\u5404\u79cd\u4fe1\u606f\u3002\u4f8b\u5982\u7531 ngx_http_core \u6a21\u5757\u63d0\u4f9b\u7684\u5185\u5efa\u53d8\u91cf $uri\uff0c\u53ef\u4ee5\u7528\u6765\u83b7\u53d6\u5f53\u524d\u8bf7\u6c42\u7684 URI\uff08\u7ecf\u8fc7\u89e3\u7801\uff0c\u5e76\u4e14\u4e0d\u542b\u8bf7\u6c42\u53c2\u6570\uff09\uff0c\u800c $request_uri \u5219\u7528\u6765\u83b7\u53d6\u8bf7\u6c42\u6700\u539f\u59cb\u7684 URI \uff08\u672a\u7ecf\u89e3\u7801\uff0c\u5e76\u4e14\u5305\u542b\u8bf7\u6c42\u53c2\u6570\uff09\u3002\u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\nlocation /test {  \\n  echo \\"uri = $uri\\";  \\n  echo \\"request_uri = $request_uri\\";  \\n} \\n```\\n\\n\u8fd9\u91cc\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u8fde server \u914d\u7f6e\u5757\u4e5f\u7701\u7565\u4e86\uff0c\u548c\u524d\u9762\u6240\u6709\u793a\u4f8b\u4e00\u6837\uff0c\u6211\u4eec\u76d1\u542c\u7684\u4f9d\u7136\u662f 8080 \u7aef\u53e3\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u91cc\uff0c\u6211\u4eec\u628a $uri \u548c $request_uri \u7684\u503c\u8f93\u51fa\u5230\u54cd\u5e94\u4f53\u4e2d\u53bb\u3002\u4e0b\u9762\u6211\u4eec\u7528\u4e0d\u540c\u7684\u8bf7\u6c42\u6765\u6d4b\u8bd5\u4e00\u4e0b\u8fd9\u4e2a /test \u63a5\u53e3\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test\'  \\nuri = /test  \\nrequest_uri = /test  \\n$ curl \'http://localhost:8080/test?a=3&b=4\'  \\nuri = /test  \\nrequest_uri = /test?a=3&b=4 \\n$ curl \'http://localhost:8080/test/hello%20world?a=3&b=4\'  \\nuri = /test/hello world  \\nrequest_uri = /test/hello%20world?a=3&b=4 \\n```\\n\\n\u53e6\u4e00\u4e2a\u7279\u522b\u5e38\u7528\u7684\u5185\u5efa\u53d8\u91cf\u5176\u5b9e\u5e76\u4e0d\u662f\u5355\u72ec\u4e00\u4e2a\u53d8\u91cf\uff0c\u800c\u662f\u6709\u65e0\u9650\u591a\u53d8\u79cd\u7684\u4e00\u7fa4\u53d8\u91cf\uff0c\u5373\u540d\u5b57\u4ee5 arg_ \u5f00\u5934\u7684\u6240\u6709\u53d8\u91cf\uff0c\u6211\u4eec\u4f30\u4e14\u79f0\u4e4b\u4e3a $arg_XXX \u53d8\u91cf\u7fa4\u3002\u4e00\u4e2a\u4f8b\u5b50\u662f $arg_name\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u662f\u5f53\u524d\u8bf7\u6c42\u540d\u4e3a name \u7684 URI \u53c2\u6570\u7684\u503c\uff0c\u800c\u4e14\u8fd8\u662f\u672a\u89e3\u7801\u7684\u539f\u59cb\u5f62\u5f0f\u7684\u503c\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u6bd4\u8f83\u5b8c\u6574\u7684\u793a\u4f8b\uff1a\\n\\n```\\nlocation /test {  \\n  echo \\"name: $arg_name\\";  \\n  echo \\"class: $arg_class\\";  \\n} \\n```\\n \\n\u7136\u540e\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528\u5404\u79cd\u53c2\u6570\u7ec4\u5408\u53bb\u8bf7\u6c42\u8fd9\u4e2a /test \u63a5\u53e3\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test\'  \\nname:  \\nclass:  \\n$ curl \'http://localhost:8080/test?name=Tom&class=3\'  \\nname: Tom  \\nclass: 3 \\n$ curl \'http://localhost:8080/test?name=hello%20world&class=9\'  \\nname: hello%20world  \\nclass: 9 \\n```\\n\\n\u5176\u5b9e $arg_name \u4e0d\u4ec5\u53ef\u4ee5\u5339\u914d name \u53c2\u6570\uff0c\u4e5f\u53ef\u4ee5\u5339\u914d NAME \u53c2\u6570\uff0c\u6291\u6216\u662f Name\uff0c\u7b49\u7b49\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test?NAME=Marry\'  \\nname: Marry  \\nclass:  \\n$ curl \'http://localhost:8080/test?Name=Jimmy\'  \\nname: Jimmy  \\nclass: \\n```\\n\\n> Nginx \u4f1a\u5728\u5339\u914d\u53c2\u6570\u540d\u4e4b\u524d\uff0c\u81ea\u52a8\u628a\u539f\u59cb\u8bf7\u6c42\u4e2d\u7684\u53c2\u6570\u540d\u8c03\u6574\u4e3a\u5168\u90e8\u5c0f\u5199\u7684\u5f62\u5f0f\u3002\\n\\n\\n\u5982\u679c\u4f60\u60f3\u5bf9 URI \u53c2\u6570\u503c\u4e2d\u7684 `%XX` \u8fd9\u6837\u7684\u7f16\u7801\u5e8f\u5217\u8fdb\u884c\u89e3\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9 `ngx_set_misc` \u6a21\u5757\u63d0\u4f9b\u7684 `set_unescape_uri` \u914d\u7f6e\u6307\u4ee4\uff1a\\n\\n```\\nlocation /test {  \\n  set_unescape_uri $name $arg_name;  \\n  set_unescape_uri $class $arg_class;  \\n  echo \\"name: $name\\";  \\n  echo \\"class: $class\\";  \\n} \\n```\\n\\n\u73b0\u5728\u6211\u4eec\u518d\u770b\u4e00\u4e0b\u6548\u679c\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test?name=hello%20world&class=9\'  \\nname: hello world  \\nclass: 9 \\n```\\n \\n\u7a7a\u683c\u679c\u7136\u88ab\u89e3\u7801\u51fa\u6765\u4e86\uff01\\n\u4ece\u8fd9\u4e2a\u4f8b\u5b50\u6211\u4eec\u540c\u65f6\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a `set_unescape_uri` \u6307\u4ee4\u4e5f\u50cf set \u6307\u4ee4\u90a3\u6837\uff0c\u62e5\u6709\u81ea\u52a8\u521b\u5efa Nginx \u53d8\u91cf\u7684\u529f\u80fd\u3002\u540e\u9762\u6211\u4eec\u8fd8\u4f1a\u4e13\u95e8\u4ecb\u7ecd\u5230 ngx_set_misc \u6a21\u5757\u3002\u50cf `$arg_XXX` \u8fd9\u79cd\u7c7b\u578b\u7684\u53d8\u91cf\u62e5\u6709\u65e0\u7a77\u65e0\u5c3d\u79cd\u53ef\u80fd\u7684\u540d\u5b57\uff0c\u6240\u4ee5\u5b83\u4eec\u5e76\u4e0d\u5bf9\u5e94\u4efb\u4f55\u5b58\u653e\u503c\u7684\u5bb9\u5668\u3002\u800c\u4e14\u8fd9\u79cd\u53d8\u91cf\u5728 Nginx \u6838\u5fc3\u4e2d\u662f\u7ecf\u8fc7\u7279\u522b\u5904\u7406\u7684\uff0c\u7b2c\u4e09\u65b9 Nginx \u6a21\u5757\u662f\u4e0d\u80fd\u63d0\u4f9b\u8fd9\u6837\u5145\u6ee1\u9b54\u6cd5\u7684\u5185\u5efa\u53d8\u91cf\u7684\u3002\\n\\n> \u7c7b\u4f3c `$arg_XXX` \u7684\u5185\u5efa\u53d8\u91cf\u8fd8\u6709\u4e0d\u5c11\uff0c\u6bd4\u5982\u7528\u6765\u53d6 cookie \u503c\u7684 `$cookie_XXX` \u53d8\u91cf\u7fa4\uff0c\u7528\u6765\u53d6\u8bf7\u6c42\u5934\u7684 `$http_XXX` \u53d8\u91cf\u7fa4\uff0c\u4ee5\u53ca\u7528\u6765\u53d6\u54cd\u5e94\u5934\u7684 `$sent_http_XXX` \u53d8\u91cf\u7fa4\u3002\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u4ecb\u7ecd\u4e86\uff0c\u611f\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u53c2\u8003 ngx_http_core \u6a21\u5757\u7684\u5b98\u65b9\u6587\u6863\u3002\u9700\u8981\u6307\u51fa\u7684\u662f\uff0c\u8bb8\u591a\u5185\u5efa\u53d8\u91cf\u90fd\u662f\u53ea\u8bfb\u7684\uff0c\u6bd4\u5982\u6211\u4eec\u521a\u624d\u4ecb\u7ecd\u7684 `$uri` \u548c `$request_uri`. \u5bf9\u53ea\u8bfb\u53d8\u91cf\u8fdb\u884c\u8d4b\u503c\u662f\u5e94\u5f53\u7edd\u5bf9\u907f\u514d\u7684\uff0c\u56e0\u4e3a\u4f1a\u6709\u610f\u60f3\u4e0d\u5230\u7684\u540e\u679c\uff0c\u6bd4\u5982\uff1a\\n\\n```\\nlocation /bad {  \\n  set $uri /blah;  \\n  echo $uri;  \\n } \\n ```\\n\\n\u8fd9\u4e2a\u6709\u95ee\u9898\u7684\u914d\u7f6e\u4f1a\u8ba9 Nginx \u5728\u542f\u52a8\u7684\u65f6\u5019\u62a5\u51fa\u4e00\u6761\u4ee4\u4eba\u532a\u5937\u6240\u601d\u7684\u9519\u8bef\uff1a\\n\\n```\\n[emerg] the duplicate \\"uri\\" variable in ... \\n```\\n\\n> \u5982\u679c\u4f60\u5c1d\u8bd5\u6539\u5199\u53e6\u5916\u4e00\u4e9b\u53ea\u8bfb\u7684\u5185\u5efa\u53d8\u91cf\uff0c\u6bd4\u5982 $arg_XXX \u53d8\u91cf\uff0c\u5728\u67d0\u4e9b Nginx \u7684\u7248\u672c\u4e2d\u751a\u81f3\u53ef\u80fd\u5bfc\u81f4\u8fdb\u7a0b\u5d29\u6e83\u3002\\n\\n\\n\u4e5f\u6709\u4e00\u4e9b\u5185\u5efa\u53d8\u91cf\u662f\u652f\u6301\u6539\u5199\u7684\uff0c\u5176\u4e2d\u4e00\u4e2a\u4f8b\u5b50\u662f $args. \u8fd9\u4e2a\u53d8\u91cf\u5728\u8bfb\u53d6\u65f6\u8fd4\u56de\u5f53\u524d\u8bf7\u6c42\u7684 URL \u53c2\u6570\u4e32\uff08\u5373\u8bf7\u6c42 URL \u4e2d\u95ee\u53f7\u540e\u9762\u7684\u90e8\u5206\uff0c\u5982\u679c\u6709\u7684\u8bdd \uff09\uff0c\u800c\u5728\u8d4b\u503c\u65f6\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u53c2\u6570\u4e32\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\nlocation /test {  \\n  set $orig_args $args;  \\n  set $args \\"a=3&b=4\\";  \\n  echo \\"original args: $orig_args\\";  \\n  echo \\"args: $args\\";  \\n} \\n```\\n\\n\u8fd9\u91cc\u6211\u4eec\u628a\u539f\u59cb\u7684 URL \u53c2\u6570\u4e32\u5148\u4fdd\u5b58\u5728 $orig_args \u53d8\u91cf\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u6539\u5199 $args \u53d8\u91cf\u6765\u4fee\u6539\u5f53\u524d\u7684 URL \u53c2\u6570\u4e32\uff0c\u6700\u540e\u6211\u4eec\u7528 echo \u6307\u4ee4\u5206\u522b\u8f93\u51fa $orig_args \u548c $args \u53d8\u91cf\u7684\u503c\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u8fd9\u6837\u6765\u6d4b\u8bd5\u8fd9\u4e2a /test \u63a5\u53e3\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test\'  \\noriginal args:  \\nargs: a=3&b=4 \\n$ curl \'http://localhost:8080/test?a=0&b=1&c=2\'  \\noriginal args: a=0&b=1&c=2 \\nargs: a=3&b=4 \\n```\\n \\n\u5728\u7b2c\u4e00\u6b21\u6d4b\u8bd5\u4e2d\uff0c\u6211\u4eec\u6ca1\u6709\u8bbe\u7f6e\u4efb\u4f55 URL \u53c2\u6570\u4e32\uff0c\u6240\u4ee5\u8f93\u51fa `$orig_args` \u53d8\u91cf\u7684\u503c\u65f6\u4fbf\u5f97\u5230\u7a7a\u3002\u800c\u5728\u7b2c\u4e00\u6b21\u548c\u7b2c\u4e8c\u6b21\u6d4b\u8bd5\u4e2d\uff0c\u65e0\u8bba\u6211\u4eec\u662f\u5426\u63d0\u4f9b URL \u53c2\u6570\u4e32\uff0c\u53c2\u6570\u4e32\u90fd\u4f1a\u5728 location /test \u4e2d\u88ab\u5f3a\u884c\u6539\u5199\u6210 a=3&b=4.\\n\u9700\u8981\u7279\u522b\u6307\u51fa\u7684\u662f\uff0c\u8fd9\u91cc\u7684 $args \u53d8\u91cf\u548c $arg_XXX \u4e00\u6837\uff0c\u4e5f\u4e0d\u518d\u4f7f\u7528\u5c5e\u4e8e\u81ea\u5df1\u7684\u5b58\u653e\u503c\u7684\u5bb9\u5668\u3002\u5f53\u6211\u4eec\u8bfb\u53d6 $args \u65f6\uff0cnginx \u4f1a\u6267\u884c\u4e00\u5c0f\u6bb5\u4ee3\u7801\uff0c\u4ece Nginx \u6838\u5fc3\u4e2d\u4e13\u95e8\u5b58\u653e\u5f53\u524d URL \u53c2\u6570\u4e32\u7684\u4f4d\u7f6e\u53bb\u8bfb\u53d6\u6570\u636e\uff1b\u800c\u5f53\u6211\u4eec\u6539\u5199 $args \u65f6\uff0cNginx \u4f1a\u6267\u884c\u53e6\u4e00\u5c0f\u6bb5\u4ee3\u7801\uff0c\u5bf9\u76f8\u540c\u4f4d\u7f6e\u8fdb\u884c\u6539\u5199\u3002Nginx \u7684\u5176\u4ed6\u90e8\u5206\u5728\u9700\u8981\u5f53\u524d URL \u53c2\u6570\u4e32\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u4ece\u90a3\u4e2a\u4f4d\u7f6e\u53bb\u8bfb\u6570\u636e\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9 $args \u7684\u4fee\u6539\u4f1a\u5f71\u54cd\u5230\u6240\u6709\u90e8\u5206\u7684\u529f\u80fd\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\nlocation /test {  \\n  set $orig_a $arg_a;  \\n  set $args \\"a=5\\";  \\n  echo \\"original a: $orig_a\\";  \\n  echo \\"a: $arg_a\\";  \\n} \\n```\\n\\n\u8fd9\u91cc\u6211\u4eec\u5148\u628a\u5185\u5efa\u53d8\u91cf $arg_a \u7684\u503c\uff0c\u5373\u539f\u59cb\u8bf7\u6c42\u7684 URL \u53c2\u6570 a \u7684\u503c\uff0c\u4fdd\u5b58\u5728\u7528\u6237\u53d8\u91cf $orig_a \u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u5bf9\u5185\u5efa\u53d8\u91cf $args \u8fdb\u884c\u8d4b\u503c\uff0c\u628a\u5f53\u524d\u8bf7\u6c42\u7684\u53c2\u6570\u4e32\u6539\u5199\u4e3a a=5 \uff0c\u6700\u540e\u518d\u7528 echo \u6307\u4ee4\u5206\u522b\u8f93\u51fa $orig_a \u548c $arg_a \u53d8\u91cf\u7684\u503c\u3002\u56e0\u4e3a\u5bf9\u5185\u5efa\u53d8\u91cf $args \u7684\u4fee\u6539\u4f1a\u76f4\u63a5\u5bfc\u81f4\u5f53\u524d\u8bf7\u6c42\u7684 URL \u53c2\u6570\u4e32\u53d1\u751f\u53d8\u5316\uff0c\u56e0\u6b64\u5185\u5efa\u53d8\u91cf $arg_XXX \u81ea\u7136\u4e5f\u4f1a\u968f\u4e4b\u53d8\u5316\u3002\u6d4b\u8bd5\u7684\u7ed3\u679c\u8bc1\u5b9e\u4e86\u8fd9\u4e00\u70b9\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test?a=3\'  \\noriginal a: 3 \\na: 5 \\n```\\n\\n\u6211\u4eec\u770b\u5230\uff0c\u56e0\u4e3a\u539f\u59cb\u8bf7\u6c42\u7684 URL \u53c2\u6570\u4e32\u662f a=3, \u6240\u4ee5 $arg_a \u6700\u521d\u7684\u503c\u4e3a 3, \u4f46\u968f\u540e\u901a\u8fc7\u6539\u5199 $args \u53d8\u91cf\uff0c\u5c06 URL \u53c2\u6570\u4e32\u53c8\u5f3a\u884c\u4fee\u6539\u4e3a a=5, \u6240\u4ee5\u6700\u7ec8 $arg_a \u7684\u503c\u53c8\u81ea\u52a8\u53d8\u4e3a\u4e86 5.\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e2a\u901a\u8fc7\u4fee\u6539 $args \u53d8\u91cf\u5f71\u54cd\u6807\u51c6\u7684 HTTP \u4ee3\u7406\u6a21\u5757 ngx_proxy \u7684\u4f8b\u5b50\uff1a\\n\\n```\\nserver {  \\n  listen 8080;  \\n  location /test {  \\n    set $args \\"foo=1&bar=2\\";  \\n    proxy_pass http://127.0.0.1:8081/args;  \\n  }  \\n}  \\nserver {  \\n  listen 8081;  \\n  location /args {  \\n    echo \\"args: $args\\";  \\n  }  \\n}\\n```\\n  \\n\u8fd9\u91cc\u6211\u4eec\u5728 http \u914d\u7f6e\u5757\u4e2d\u5b9a\u4e49\u4e86\u4e24\u4e2a\u865a\u62df\u4e3b\u673a\u3002\u7b2c\u4e00\u4e2a\u865a\u62df\u4e3b\u673a\u76d1\u542c 8080 \u7aef\u53e3\uff0c\u5176 /test \u63a5\u53e3\u81ea\u5df1\u901a\u8fc7\u6539\u5199 $args \u53d8\u91cf\uff0c\u5c06\u5f53\u524d\u8bf7\u6c42\u7684 URL \u53c2\u6570\u4e32\u65e0\u6761\u4ef6\u5730\u4fee\u6539\u4e3a foo=1&bar=2. \u7136\u540e /test \u63a5\u53e3\u518d\u901a\u8fc7 ngx_proxy \u6a21\u5757\u7684 proxy_pass \u6307\u4ee4\u914d\u7f6e\u4e86\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\uff0c\u6307\u5411\u672c\u673a\u7684 8081 \u7aef\u53e3\u4e0a\u7684 HTTP \u670d\u52a1 /args. \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cngx_proxy \u6a21\u5757\u5728\u8f6c\u53d1 HTTP \u8bf7\u6c42\u5230\u8fdc\u65b9 HTTP \u670d\u52a1\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u628a\u5f53\u524d\u8bf7\u6c42\u7684 URL \u53c2\u6570\u4e32\u4e5f\u8f6c\u53d1\u5230\u8fdc\u65b9\u3002\u800c\u672c\u673a\u7684 8081 \u7aef\u53e3\u4e0a\u7684 HTTP \u670d\u52a1\u6b63\u662f\u7531\u6211\u4eec\u5b9a\u4e49\u7684\u7b2c\u4e8c\u4e2a\u865a\u62df\u4e3b\u673a\u6765\u63d0\u4f9b\u7684\u3002\u6211\u4eec\u5728\u7b2c\u4e8c\u4e2a\u865a\u62df\u4e3b\u673a\u7684 location /args \u4e2d\u5229\u7528 echo \u6307\u4ee4\u8f93\u51fa\u5f53\u524d\u8bf7\u6c42\u7684 URL \u53c2\u6570\u4e32\uff0c\u4ee5\u68c0\u67e5 /test \u63a5\u53e3\u901a\u8fc7 ngx_proxy \u6a21\u5757\u5b9e\u9645\u8f6c\u53d1\u8fc7\u6765\u7684 URL \u8bf7\u6c42\u53c2\u6570\u4e32\u3002\u6211\u4eec\u6765\u5b9e\u9645\u8bbf\u95ee\u4e00\u4e0b\u7b2c\u4e00\u4e2a\u865a\u62df\u4e3b\u673a\u7684 /test \u63a5\u53e3\uff1a\\n\\n```\\n$ curl \'http://localhost:8080/test?blah=7\'  \\nargs: foo=1&bar=2 \\n```\\n\\n\u6211\u4eec\u770b\u5230\uff0c\u867d\u7136\u8bf7\u6c42\u81ea\u5df1\u63d0\u4f9b\u4e86 URL \u53c2\u6570\u4e32 blah=7\uff0c\u4f46\u5728 location /test \u4e2d\uff0c\u53c2\u6570\u4e32\u88ab\u5f3a\u884c\u6539\u5199\u6210\u4e86 foo=1&bar=2. \u63a5\u7740\u7ecf\u7531 proxy_pass \u6307\u4ee4\u5c06\u6211\u4eec\u88ab\u6539\u5199\u6389\u7684\u53c2\u6570\u4e32\u8f6c\u53d1\u7ed9\u4e86\u7b2c\u4e8c\u4e2a\u865a\u62df\u4e3b\u673a\u4e0a\u914d\u7f6e\u7684 /args \u63a5\u53e3\uff0c\u7136\u540e\u518d\u628a /args \u63a5\u53e3\u7684 URL \u53c2\u6570\u4e32\u8f93\u51fa\u3002\u4e8b\u5b9e\u8bc1\u660e\uff0c\u6211\u4eec\u5bf9 $args \u53d8\u91cf\u7684\u8d4b\u503c\u64cd\u4f5c\uff0c\u4e5f\u6210\u529f\u5f71\u54cd\u5230\u4e86 ngx_proxy \u6a21\u5757\u7684\u884c\u4e3a\u3002\\n\u5728\u8bfb\u53d6\u53d8\u91cf\u65f6\u6267\u884c\u7684\u8fd9\u6bb5\u7279\u6b8a\u4ee3\u7801\uff0c\u5728 Nginx \u4e2d\u88ab\u79f0\u4e3a\u201c\u53d6\u5904\u7406\u7a0b\u5e8f\u201d\uff08get handler\uff09\uff1b\u800c\u6539\u5199\u53d8\u91cf\u65f6\u6267\u884c\u7684\u8fd9\u6bb5\u7279\u6b8a\u4ee3\u7801\uff0c\u5219\u88ab\u79f0\u4e3a\u201c\u5b58\u5904\u7406\u7a0b\u5e8f\u201d\uff08set handler\uff09\u3002\u4e0d\u540c\u7684 Nginx \u6a21\u5757\u4e00\u822c\u4f1a\u4e3a\u5b83\u4eec\u7684\u53d8\u91cf\u51c6\u5907\u4e0d\u540c\u7684\u201c\u5b58\u53d6\u5904\u7406\u7a0b\u5e8f\u201d\uff0c\u4ece\u800c\u8ba9\u8fd9\u4e9b\u53d8\u91cf\u7684\u884c\u4e3a\u5145\u6ee1\u9b54\u6cd5\u3002\u5176\u5b9e\u8fd9\u79cd\u6280\u5de7\u5728\u8ba1\u7b97\u4e16\u754c\u5e76\u4e0d\u9c9c\u89c1\u3002\u6bd4\u5982\u5728\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\uff0c\u7c7b\u7684\u8bbe\u8ba1\u8005\u4e00\u822c\u4e0d\u4f1a\u628a\u7c7b\u7684\u6210\u5458\u53d8\u91cf\u76f4\u63a5\u66b4\u9732\u7ed9\u7c7b\u7684\u7528\u6237\uff0c\u800c\u662f\u53e6\u884c\u63d0\u4f9b\u4e24\u4e2a\u65b9\u6cd5\uff08method\uff09\uff0c\u5206\u522b\u7528\u4e8e\u8be5\u6210\u5458\u53d8\u91cf\u7684\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u5e38\u5e38\u88ab\u79f0\u4e3a\u201c\u5b58\u53d6\u5668\u201d\uff08accessor\uff09\u3002\\n\\n> \u8f6c\u81ea\uff1a[\u6d45\u6790Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528](http://www.jb51.net/article/77593.htm)\\n\\n\u66f4\u591anginx\u5185\u7f6e\u53d8\u91cf\u8bf7\u770b [nginx\u5185\u7f6e\u53d8\u91cf\u5927\u5168](05-13-nginx-built-in-vars-refers.md)"},{"id":"nginx-built-in-vars-refers","metadata":{"permalink":"/blog/nginx-built-in-vars-refers","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/05-13-nginx-built-in-vars-refers.md","source":"@site/blog/2016/05-13-nginx-built-in-vars-refers.md","title":"Nginx\u5185\u7f6e\u53d8\u91cf\u5927\u5168","description":"\u5728\u914d\u7f6e\u57fa\u4e8enginx\u670d\u52a1\u5668\u7684\u7f51\u7ad9\u65f6\uff0c\u5fc5\u7136\u4f1a\u7528\u5230 nginx\u5185\u7f6e\u53d8\u91cf \uff0c\u4e0b\u9762\u7b14\u8005\u5c06\u5b83\u6574\u7406\u6210\u5217\u8868\uff0c\u628a\u6700\u65b0\u7248\u672c\u7684\u53d8\u91cf\u5217\u51fa\u6765\uff0c\u4ee5\u65b9\u4fbf\u505a\u914d\u7f6e\u65f6\u67e5\u8be2","date":"2016-05-13T16:51:00.000Z","formattedDate":"2016\u5e745\u670813\u65e5","tags":[{"label":"nginx","permalink":"/blog/tags/nginx"}],"readingTime":6.105,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"Nginx\u5185\u7f6e\u53d8\u91cf\u5927\u5168","tags":["nginx"],"date":"2016-05-13T16:51","slug":"nginx-built-in-vars-refers","authors":["inhere","network"]},"prevItem":{"title":"Nginx\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u7684\u7f16\u5199\u4f7f\u7528","permalink":"/blog/custom-vars-usage-in-ngnix-config"},"nextItem":{"title":"vim \u4f7f\u7528\u8bb0\u5f55","permalink":"/blog/vim-usage-records"}},"content":"\u5728\u914d\u7f6e\u57fa\u4e8enginx\u670d\u52a1\u5668\u7684\u7f51\u7ad9\u65f6\uff0c\u5fc5\u7136\u4f1a\u7528\u5230 **nginx\u5185\u7f6e\u53d8\u91cf** \uff0c\u4e0b\u9762\u7b14\u8005\u5c06\u5b83\u6574\u7406\u6210\u5217\u8868\uff0c\u628a\u6700\u65b0\u7248\u672c\u7684\u53d8\u91cf\u5217\u51fa\u6765\uff0c\u4ee5\u65b9\u4fbf\u505a\u914d\u7f6e\u65f6\u67e5\u8be2\\n\\n\x3c!--truncate--\x3e\\n\\n## nginx\u5185\u7f6e\u53d8\u91cf\\n\\n\u5185\u7f6e\u53d8\u91cf\u5b58\u653e\u5728  `ngx_http_core_module` \u6a21\u5757\u4e2d\uff0c\u53d8\u91cf\u7684\u547d\u540d\u65b9\u5f0f\u548capache \u670d\u52a1\u5668\u53d8\u91cf\u662f\u4e00\u81f4\u7684\u3002\\n\u603b\u800c\u8a00\u4e4b\uff0c\u8fd9\u4e9b\u53d8\u91cf\u4ee3\u8868\u7740\u5ba2\u6237\u7aef\u8bf7\u6c42\u5934\u7684\u5185\u5bb9\uff0c\u4f8b\u5982`$http_user_agent`, `$http_cookie`, \u7b49\u7b49\u3002\u4e0b\u9762\u662fnginx\u652f\u6301\u7684\u6240\u6709\u5185\u7f6e\u53d8\u91cf\uff1a\\n\\n\u53d8\u91cf\u540d |  \u8bf4\u660e\\n--------|------------------\\n`$arg_{name}` | \u8bf7\u6c42\u4e2d\u7684\u7684\u53c2\u6570\u540d\uff0c\u5373\u201c?\u201d\u540e\u9762\u7684name=value\u5f62\u5f0f\u7684e.g. `?title=test` \u53ef\u7528 `$arg_title`\u83b7\u53d6\u5230\\n`$args` | \u8bf7\u6c42\u4e2d\u7684\u53c2\u6570\u503c\\n`$binary_remote_addr` | \u5ba2\u6237\u7aef\u5730\u5740\u7684\u4e8c\u8fdb\u5236\u5f62\u5f0f, \u56fa\u5b9a\u957f\u5ea6\u4e3a4\u4e2a\u5b57\u8282\\n`$body_bytes_sent` | \u4f20\u8f93\u7ed9\u5ba2\u6237\u7aef\u7684\u5b57\u8282\u6570\uff0c\u54cd\u5e94\u5934\u4e0d\u8ba1\u7b97\u5728\u5185\uff1b\u8fd9\u4e2a\u53d8\u91cf\u548cApache\u7684mod_log_config\u6a21\u5757\u4e2d\u7684\u201c%B\u201d\u53c2\u6570\u4fdd\u6301\u517c\u5bb9\\n`$bytes_sent` | \u4f20\u8f93\u7ed9\u5ba2\u6237\u7aef\u7684\u5b57\u8282\u6570 (1.3.8, 1.2.5)\\n`$connection` | TCP\u8fde\u63a5\u7684\u5e8f\u5217\u53f7 (1.3.8, 1.2.5)\\n`$connection_requests` | TCP\u8fde\u63a5\u5f53\u524d\u7684\u8bf7\u6c42\u6570\u91cf (1.3.8, 1.2.5)\\n`$content_length` | \u201cContent-Length\u201d \u8bf7\u6c42\u5934\u5b57\u6bb5\\n`$content_type` | \u201cContent-Type\u201d \u8bf7\u6c42\u5934\u5b57\u6bb5\\n`$cookie_name` | cookie\u540d\u79f0\\n`$document_root` | \u5f53\u524d\u8bf7\u6c42\u7684\u6587\u6863\u6839\u76ee\u5f55\u6216\u522b\u540d\\n`$document_uri` | \u540c `$uri`\\n`$host` | \u4f18\u5148\u7ea7\u5982\u4e0b\uff1aHTTP\u8bf7\u6c42\u884c\u7684\u4e3b\u673a\u540d>\u201dHOST\u201d\u8bf7\u6c42\u5934\u5b57\u6bb5>\u7b26\u5408\u8bf7\u6c42\u7684\u670d\u52a1\u5668\u540d\\n`$hostname` | \u4e3b\u673a\u540d\\n`$http_{name}` | \u5339\u914d\u4efb\u610f\u8bf7\u6c42\u5934\u5b57\u6bb5\uff1b\u53d8\u91cf\u540d\u4e2d\u7684\u540e\u534a\u90e8\u5206\u201cname\u201d\u53ef\u4ee5\u66ff\u6362\u6210\u4efb\u610f\u8bf7\u6c42\u5934\u5b57\u6bb5\uff0c\u5982\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u9700\u8981\u83b7\u53d6http\u8bf7\u6c42\u5934\uff1a\u201cAccept-Language\u201d\uff0c\u90a3\u4e48\u5c06\u201c\uff0d\u201d\u66ff\u6362\u4e3a\u4e0b\u5212\u7ebf\uff0c\u5927\u5199\u5b57\u6bcd\u66ff\u6362\u4e3a\u5c0f\u5199\uff0c\u5f62\u5982\uff1a`$http_accept_language`\u5373\u53ef\u3002\\n`$https` | \u5982\u679c\u5f00\u542f\u4e86SSL\u5b89\u5168\u6a21\u5f0f\uff0c\u503c\u4e3a\u201con\u201d\uff0c\u5426\u5219\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002\\n`$is_args` | \u5982\u679c\u8bf7\u6c42\u4e2d\u6709\u53c2\u6570\uff0c\u503c\u4e3a\u201c?\u201d\uff0c\u5426\u5219\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002\\n`$limit_rate` | \u7528\u4e8e\u8bbe\u7f6e\u54cd\u5e94\u7684\u901f\u5ea6\u9650\u5236\uff0c\u8be6\u89c1 limit_rate\u3002\\n`$msec` | \u5f53\u524d\u7684Unix\u65f6\u95f4\u6233 (1.3.9, 1.2.6)\\n`$nginx_version` | nginx\u7248\u672c\\n`$pid` | \u5de5\u4f5c\u8fdb\u7a0b\u7684PID\\n`$pipe` | \u5982\u679c\u8bf7\u6c42\u6765\u81ea\u7ba1\u9053\u901a\u4fe1\uff0c\u503c\u4e3a\u201cp\u201d\uff0c\u5426\u5219\u4e3a\u201c.\u201d (1.3.12, 1.2.7)\\n`$proxy_protocol_addr` | \u83b7\u53d6\u4ee3\u7406\u8bbf\u95ee\u670d\u52a1\u5668\u7684\u5ba2\u6237\u7aef\u5730\u5740\uff0c\u5982\u679c\u662f\u76f4\u63a5\u8bbf\u95ee\uff0c\u8be5\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002(1.5.12)\\n`$query_string` | \u540c `$args` \\n`$realpath_root` | \u5f53\u524d\u8bf7\u6c42\u7684\u6587\u6863\u6839\u76ee\u5f55\u6216\u522b\u540d\u7684\u771f\u5b9e\u8def\u5f84\uff0c\u4f1a\u5c06\u6240\u6709\u7b26\u53f7\u8fde\u63a5\u8f6c\u6362\u4e3a\u771f\u5b9e\u8def\u5f84\u3002\\n`$remote_addr` | \u5ba2\u6237\u7aef\u5730\u5740\\n`$remote_port` | \u5ba2\u6237\u7aef\u7aef\u53e3\\n`$remote_user` | \u7528\u4e8eHTTP\u57fa\u7840\u8ba4\u8bc1\u670d\u52a1\u7684\u7528\u6237\u540d\\n`$request` | \u4ee3\u8868\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5730\u5740\\n`$request_body` | \u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u4e3b\u4f53,\u6b64\u53d8\u91cf\u53ef\u5728location\u4e2d\u4f7f\u7528\uff0c\u5c06\u8bf7\u6c42\u4e3b\u4f53\u901a\u8fc7proxy_pass, fastcgi_pass, uwsgi_pass, \u548c scgi_pass\u4f20\u9012\u7ed9\u4e0b\u4e00\u7ea7\u7684\u4ee3\u7406\u670d\u52a1\u5668\u3002\\n`$request_body_file` | \u5c06\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e3b\u4f53\u4fdd\u5b58\u5728\u4e34\u65f6\u6587\u4ef6\u4e2d\u3002\u6587\u4ef6\u5904\u7406\u7ed3\u675f\u540e\uff0c\u6b64\u6587\u4ef6\u9700\u5220\u9664\u3002\u5982\u679c\u9700\u8981\u4e4b\u4e00\u5f00\u542f\u6b64\u529f\u80fd\uff0c\u9700\u8981\u8bbe\u7f6eclient_body_in_file_only\u3002\u5982\u679c\u5c06\u6b21\u6587\u4ef6\u4f20\u9012\u7ed9\u540e\u7aef\u7684\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u9700\u8981\u7981\u7528`request body`\uff0c\u5373\u8bbe\u7f6e`proxy_pass_request_body off\uff0cfastcgi_pass_request_body off, uwsgi_pass_request_body off, or scgi_pass_request_body off` \u3002\\n`$request_completion` | \u5982\u679c\u8bf7\u6c42\u6210\u529f\uff0c\u503c\u4e3a\u201dOK\u201d\uff0c\u5982\u679c\u8bf7\u6c42\u672a\u5b8c\u6210\u6216\u8005\u8bf7\u6c42\u4e0d\u662f\u4e00\u4e2a\u8303\u56f4\u8bf7\u6c42\u7684\u6700\u540e\u4e00\u90e8\u5206\uff0c\u5219\u4e3a\u7a7a\u3002\\n`$request_filename` | \u5f53\u524d\u8fde\u63a5\u8bf7\u6c42\u7684\u6587\u4ef6\u8def\u5f84\uff0c\u7531root\u6216alias\u6307\u4ee4\u4e0eURI\u8bf7\u6c42\u751f\u6210\u3002\\n`$request_length` | \u8bf7\u6c42\u7684\u957f\u5ea6 (\u5305\u62ec\u8bf7\u6c42\u7684\u5730\u5740, http\u8bf7\u6c42\u5934\u548c\u8bf7\u6c42\u4e3b\u4f53) (1.3.12, 1.2.7)\\n`$request_method` | HTTP\u8bf7\u6c42\u65b9\u6cd5\uff0c\u901a\u5e38\u4e3a\u201cGET\u201d\u6216\u201cPOST\u201d\\n`$request_time` | \u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42\u4f7f\u7528\u7684\u65f6\u95f4 (1.3.9, 1.2.6); \u4ece\u8bfb\u53d6\u5ba2\u6237\u7aef\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5f00\u59cb\u8ba1\u65f6\u3002\\n`$request_uri` | \u8fd9\u4e2a\u53d8\u91cf\u7b49\u4e8e\u5305\u542b\u4e00\u4e9b\u5ba2\u6237\u7aef\u8bf7\u6c42\u53c2\u6570\u7684\u539f\u59cbURI\uff0c\u5b83\u65e0\u6cd5\u4fee\u6539\uff0c\u8bf7\u67e5\u770b`$uri`\u66f4\u6539\u6216\u91cd\u5199URI\uff0c\u4e0d\u5305\u542b\u4e3b\u673a\u540d\uff0c\u4f8b\u5982\uff1a`/cnphp/test.php?arg=freemouse`\u3002\\n`$scheme` | \u8bf7\u6c42\u4f7f\u7528\u7684Web\u534f\u8bae, \u201chttp\u201d \u6216 \u201chttps\u201d\\n`$sent_http_{name}` | \u53ef\u4ee5\u8bbe\u7f6e\u4efb\u610fhttp\u54cd\u5e94\u5934\u5b57\u6bb5\uff1b \u53d8\u91cf\u540d\u4e2d\u7684\u540e\u534a\u90e8\u5206\u201cname\u201d\u53ef\u4ee5\u66ff\u6362\u6210\u4efb\u610f\u54cd\u5e94\u5934\u5b57\u6bb5\uff0c\u5982\u9700\u8981\u8bbe\u7f6e\u54cd\u5e94\u5934Content-length\uff0c\u90a3\u4e48\u5c06\u201c\uff0d\u201d\u66ff\u6362\u4e3a\u4e0b\u5212\u7ebf\uff0c\u5927\u5199\u5b57\u6bcd\u66ff\u6362\u4e3a\u5c0f\u5199\uff0c\u5f62\u5982\uff1a`$sent_http_content_length 4096`\u5373\u53ef\u3002\\n`$server_addr` | \u670d\u52a1\u5668\u7aef\u5730\u5740\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u4e3a\u4e86\u907f\u514d\u8bbf\u95eelinux\u7cfb\u7edf\u5185\u6838\uff0c\u5e94\u5c06ip\u5730\u5740\u63d0\u524d\u8bbe\u7f6e\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\\n`$server_name` | \u670d\u52a1\u5668\u540d\uff0cwww.cnphp.info\\n`$server_port` | \u670d\u52a1\u5668\u7aef\u53e3\\n`$server_protocol` | \u670d\u52a1\u5668\u7684HTTP\u7248\u672c, \u901a\u5e38\u4e3a \u201cHTTP/1.0\u201d \u6216 \u201cHTTP/1.1\u201d\\n`$status` | HTTP\u54cd\u5e94\u4ee3\u7801 (1.3.2, 1.2.2)\\n`$tcpinfo_rtt, $tcpinfo_rttvar, $tcpinfo_snd_cwnd, $tcpinfo_rcv_space` | \u5ba2\u6237\u7aefTCP\u8fde\u63a5\u7684\u5177\u4f53\u4fe1\u606f\\n`$time_iso8601` | \u670d\u52a1\u5668\u65f6\u95f4\u7684ISO 8610\u683c\u5f0f (1.3.12, 1.2.7)\\n`$time_local` | \u670d\u52a1\u5668\u65f6\u95f4\uff08LOG Format \u683c\u5f0f\uff09 (1.3.12, 1.2.7)\\n`$uri` | \u8bf7\u6c42\u4e2d\u7684\u5f53\u524dURI(\u4e0d\u5e26\u8bf7\u6c42\u53c2\u6570\uff0c\u53c2\u6570\u5728`$args`\u4e2d)\uff0c\u53ef\u4ee5\u4e0d\u540c\u4e8e\u6d4f\u89c8\u5668\u4f20\u9012\u7684`$request_uri`\u7684\u503c\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7\u5185\u90e8\u91cd\u5b9a\u5411\uff0c\u6216\u8005\u4f7f\u7528index\u6307\u4ee4\u8fdb\u884c\u4fee\u6539\uff0c$uri\u4e0d\u5305\u542b\u4e3b\u673a\u540d\uff0c\u5982`/foo/bar.html`\u3002\\n\\n> \u8f6c\u81ea\uff1a[\u6700\u65b0\u7248 nginx\u5185\u7f6e\u53d8\u91cf \u5927\u5168](http://www.cnphp.info/nginx-embedded-variables-lasted-version.html)"},{"id":"vim-usage-records","metadata":{"permalink":"/blog/vim-usage-records","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/04-11-vim-usage-records.md","source":"@site/blog/2016/04-11-vim-usage-records.md","title":"vim \u4f7f\u7528\u8bb0\u5f55","description":"vim \u4f7f\u7528\u8bb0\u5f55, \u5e38\u7528\u5feb\u6377\u952e\u548c\u547d\u4ee4","date":"2016-04-11T21:51:00.000Z","formattedDate":"2016\u5e744\u670811\u65e5","tags":[{"label":"vim","permalink":"/blog/tags/vim"},{"label":"usage","permalink":"/blog/tags/usage"}],"readingTime":8.485,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"vim \u4f7f\u7528\u8bb0\u5f55","tags":["vim","usage"],"date":"2016-04-11T21:51","slug":"vim-usage-records","authors":["inhere","network"]},"prevItem":{"title":"Nginx\u5185\u7f6e\u53d8\u91cf\u5927\u5168","permalink":"/blog/nginx-built-in-vars-refers"},"nextItem":{"title":"git \u4f7f\u7528\u8bb0\u5f55","permalink":"/blog/git-usage-records"}},"content":"vim \u4f7f\u7528\u8bb0\u5f55, \u5e38\u7528\u5feb\u6377\u952e\u548c\u547d\u4ee4\\n\\n\x3c!--truncate--\x3e\\n\\n## \u5e38\u7528\u5feb\u6377\u952e\u548c\u547d\u4ee4\\n\\n### \u56de\u5230 \u6b63\u5e38\u6a21\u5f0f`normal-mode` \\n1. \u5728\u4efb\u4f55\u6a21\u5f0f\u4e0b \u6309 `Esc`\\n2. \u6309 `Ctrl+[`\\n\\n### \u5e38\u7528\u5feb\u6377\u952e \\n\\n- \u8fdb\u5165\u63d2\u5165\u6a21\u5f0f\\n`i` \u5728\u5149\u6807\u524d\u5f00\u59cb\u63d2\u5165\\n`a` \u5728\u5149\u6807\u540e\u5f00\u59cb\u63d2\u5165\\n`A` \u5728\u884c\u672b\u5f00\u59cb\u63d2\u5165\\n`o` \u5728\u5f53\u524d\u884c\u7684\u4e0b\u4e00\u884c\u65b0\u5efa\u7a7a\u767d\u884c\u5f00\u59cb\u63d2\u5165\\n`O` \u5728\u5f53\u524d\u884c\u7684\u4e0a\u4e00\u884c\u65b0\u5efa\u7a7a\u767d\u884c\u5f00\u59cb\u63d2\u5165\\n\\n- \u8df3\u8f6c(\u5728`normal-mode`\u4e0b)\\n\\n\u6309\u952e       |         \u8bf4\u660e    |     \u5ef6\u4f38\\n----------|------------------|------------------\\n`0`  |  \u884c\u5934      | `y0` \u4ece\u5149\u6807\u4f4d\u7f6e\u590d\u5236\u5230\u884c\u5934 `d0` \u4ece\u5149\u6807\u4f4d\u7f6e\u5220\u9664\u5230\u884c\u5934 \\n`^`  |  \u884c\u5934(\u975e\u7a7a\u767d\u5b57\u7b26) | `y^` \u548c `d^` \u540c\u4e0a\\n`Shift+4\\\\$` | \u884c\u5c3e        | `y\\\\$` \u4ece\u5149\u6807\u4f4d\u7f6e\u590d\u5236\u5230\u884c\u5c3e `d\\\\$` \u4ece\u5149\u6807\u4f4d\u7f6e\u5220\u9664\u5230\u884c\u5c3e \\n`w` | (\u4ece\u5de6\u81f3\u53f3)\u524d\u8fdb\u4e00\u4e2a\u5355\u8bcd        | `yw` \u5411\u524d\u590d\u5236\u4e00\u4e2a\u5355\u8bcd `dw` \u5411\u524d\u5220\u9664\u4e00\u4e2a\u5355\u8bcd\\n`W` | \u524d\u8fdb\u4e00\u4e2a\u5355\u8bcd(\u8df3\u8fc7\u7b26\u53f7\uff0c\u5982\u7a7a\u683c\u7b49)  | \u540c\u4e0a\\n`b` | \u540e\u9000\u4e00\u4e2a\u5355\u8bcd        | `yb` \u5411\u540e\u590d\u5236\u4e00\u4e2a\u5355\u8bcd `db` \u5411\u540e\u5220\u9664\u4e00\u4e2a\u5355\u8bcd\\n`B` | \u540e\u9000\u4e00\u4e2a\u5355\u8bcd(\u8df3\u8fc7\u7b26\u53f7\uff0c\u5982\u7a7a\u683c\u7b49) | \u540c\u4e0a\\n\\n- \u64cd\u4f5c(\u5728`normal-mode`\u4e0b)\\n\\n\u6309\u952e       |         \u8bf4\u660e    |     \u5ef6\u4f38\\n----------|------------------|------------------\\n`d` | \u5220\u9664(\u9009\u5b9a\u7684\u8303\u56f4) | `dd` \u5220\u9664\u5f53\u524d\u884c\uff0c `dw` \u5411\u524d\u5220\u9664\u4e00\u4e2a\u5355\u8bcd\uff0c`db` \u5411\u540e\u5220\u9664\u4e00\u4e2a\u5355\u8bcd\uff0c\\n`u` |   \u64a4\u9500\u4e0a\u4e00\u6b65\u7684\u64cd\u4f5c |\\n`Ctrl+r` | \u6062\u590d\u4e0a\u4e00\u6b65\u88ab\u64a4\u9500\u7684\u64cd\u4f5c | \\n\\n## \u4f7f\u7528\u95ee\u9898\u8bb0\u5f55\\n\\n### \u6539\u52a8\u4e86\u53ea\u8bfb\u6587\u4ef6\u5982\u4f55\u5feb\u901f\u4fdd\u5b58\\n\\n```\\n:w !sudo tee %\\n```\\n\\n### \u5feb\u901f\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u63d2\u5165\u5230\u5f53\u524d\u5149\u6807\u4f4d\u7f6e\\n\\n```\\n:r  /etc/network/interface\\n```\\n\\n\u8fd9\u6837interface\u7684\u6587\u4ef6\u5185\u5bb9\u5c31\u6dfb\u52a0\u5230\u5f53\u524d\u6587\u4ef6\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u4e86\u3002\\n\\n### \u5982\u4f55\u4e34\u65f6\u56de\u5230 shell \u73af\u5883\uff0c\u53c8\u5982\u4f55\u8fd4\u56de\u6b63\u5728\u7f16\u8f91\u7684vim \\n- `:sh` \u5c06\u542f\u52a8\u4e00\u4e2a\u5b50 shell\uff0c\u4f7f\u7528 `C-d (\u5373 ctrl+d)` \u8fd4\u56de vim\\n\\n### \u5982\u4f55\u5168\u9009\\n- \u5148\u4f7f\u7528`G (\u5373 Shift+g)` \u8df3\u5230 \u6587\u4ef6\u5c3e\uff0c \u6309 `V (\u5373 Ctrl+v)` \u8fdb\u5165\u53ef\u89c6\u6a21\u5f0f\uff0c\u518d\u6309 \u4e24\u6b21`g` \u8df3\u5230\u6587\u4ef6\u5934\uff0c\u5373\u5168\u9009\u4e86\u6240\u6709\u6587\u672c\\n\\n### \u5982\u4f55\u5173\u95edvim\u4e00\u4e2a\u7a97\u53e3\u6253\u5f00\u7684\u591a\u4e2a\u6587\u4ef6\u4e2d\u7684\u4e00\u4e2a\uff1f\\n - \u5207\u6362\u5230\u4f60\u60f3\u5173\u95ed\u7684\u6587\u4ef6\uff0c \u6309 `ZZ (\u5373 Shift+z+z)` \u5373\u53ef\u4fdd\u5b58\u5e76\u9000\u51fa\\n - \u5207\u6362\u5230\u4f60\u60f3\u5173\u95ed\u7684\u6587\u4ef6\u7a97\u53e3. \u7136\u540e\u547d\u4ee4\u6a21\u5f0f\u8f93\u5165 `:bd` \u5373 `: buffers delete`\\n - \u4f7f\u7528 `:ls` \u6d4f\u89c8\u6240\u6709\u7f13\u51b2\u533a\u6587\u4ef6\uff0c\u627e\u5230\u8981\u5173\u95ed\u7684\u6587\u4ef6\u6240\u5728\u7684\u7f16\u53f7\uff0c\u4f7f\u7528 `:bd number` e.g. `:bd 2`\\n\\n### \u5982\u4f55\u91cd\u65b0\u8f7d\u5165\u6587\u4ef6 \\n\\n1. \u91cd\u65b0\u8f7d\u5165\u5f53\u524d\u6587\u4ef6\uff1a\\n    - `:e`\\n    - `:e!`  \u653e\u5f03\u5f53\u524d\u4fee\u6539\uff0c\u5f3a\u5236\u91cd\u65b0\u8f7d\u5165\\n2. \u91cd\u65b0\u8f7d\u5165\u6240\u6709\u6253\u5f00\u7684\u6587\u4ef6\uff1a\\n    - `:bufdo e` \u6216\u8005 ` :bufdo :e!`\\n\\n>`:bufdo`\u547d\u4ee4\u8868\u793a\u628a\u540e\u9762\u7684\u547d\u4ee4\u5e94\u7528\u5230\u6240\u6709buffer\u4e2d\u7684\u6587\u4ef6\u3002\\n\\n### \u6dfb\u52a0\u548c\u5220\u9664\u6ce8\u91ca\u7684\u5feb\u6377\u65b9\u6cd5 \uff1f\\n\\n - \u6309\u952e\u64cd\u4f5c\uff1a\\n    - \u6ce8\u91ca\uff1a`ctrl+v` \uff08Window \u5219\u662f `ctrl+q` \uff09 \u8fdb\u5165\u5217\u7f16\u8f91\u6a21\u5f0f,\u5411\u4e0b\u6216\u5411\u4e0a\u79fb\u52a8\u5149\u6807,\u628a\u9700\u8981\u6ce8\u91ca\u7684\u884c\u7684\u5f00\u5934\u6807\u8bb0\u8d77\u6765,\\n\u7136\u540e\u6309\u5927\u5199\u7684`L`,\u518d\u63d2\u5165\u6ce8\u91ca\u7b26,\u6bd4\u5982`#` \u6216 `//`,\u518d\u6309`Esc`,\u5c31\u4f1a\u5168\u90e8\u6ce8\u91ca\u4e86\u3002\\n\\n    - \u5220\u9664\uff1a\u5148\u6309`v`,\u8fdb\u5165`visual\u6a21\u5f0f`,\u6a2a\u5411\u9009\u4e2d\u5217\u7684\u4e2a\u6570(\u5982\u201d#\u201d\u6ce8\u91ca\u7b26\u53f7,\u9700\u8981\u9009\u4e2d\u4e24\u5217),\\n\u518d\u6309`Esc`,\u518d\u6309`ctrl+v` \u8fdb\u5165\u5217\u7f16\u8f91\u6a21\u5f0f,\u5411\u4e0b\u6216\u5411\u4e0a\u79fb\u52a8\u5149\u6807,\u9009\u4e2d\u6ce8\u91ca\u90e8\u5206,\u7136\u540e\u6309`d`, \u5c31\u4f1a\u5220\u9664\u6ce8\u91ca\u7b26\u53f7\uff08e.g. `#`\uff09\u3002 \\n\\n>PS\uff1a\u5f53\u7136\u4e0d\u4e00\u5b9a\u662fshell\u7684\u6ce8\u91ca\u7b26\u201d#\u201d\uff0c\u4e5f\u53ef\u4ee5\u662f\u201d//\u201d\uff0c\u6216\u8005\u5176\u4ed6\u4efb\u610f\u7684\u5b57\u7b26\uff1bvim\u624d\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f\u6ce8\u91ca\u7b26\u5462\uff0c\u90fd\u662f\u5b57\u7b26\u800c\u5df2\u3002\\n\\n  \\n - \u4f7f\u7528\u66ff\u6362\u547d\u4ee4\uff1a(\u6240\u6709\u66ff\u6362\u547d\u4ee4\u672b\u5c3e\u52a0\u4e0ac\uff0c\u6bcf\u4e2a\u66ff\u6362\u90fd\u5c06\u9700\u8981\u7528\u6237\u786e\u8ba4\u3002 \u5982 `:%s/old/new/gc`\uff0c\u52a0\u4e0ai\u5219\u5ffd\u7565\u5927\u5c0f\u5199(ignore)\u3002)\\n    - `:% s/^/\\\\/\\\\//g`     \u5728\u5168\u90e8\u5185\u5bb9\u7684\u884c\u9996\u6dfb\u52a0//\u53f7\u6ce8\u91ca\\n    - `:2,50 s/^/\\\\/\\\\//g`  \u57282~50\u884c\u9996\u6dfb\u52a0//\u53f7\u6ce8\u91ca\\n    - `:2,50 s/^\\\\/\\\\///g`  \u57282~50\u884c\u9996\u5220\u9664//\u53f7\\n    - ` :.,109s/^/#/g`  \u8fd9\u91cc\u6211\u628a\u5149\u6807\u79fb\u52a8\u5230102\u884c\uff0c\u524d\u9762\u7684` . `\u4ee3\u8868\u5f53\u524d\u884c\uff0c\u8868\u793a\u4ece\u5f53\u524d\u884c\u5230\u7b2c109\u884c\u6240\u6709\u5f00\u5934\u90fd\u7528#\u66ff\u6362\uff0c\\n    - ` :102,109s/^/#/g` \u4e5f\u53ef\u4ee5\u8fd9\u6837\u5199 \\n    - ` :.,+7s/^/#/g` \u518d\u6216\u8005 `:102,+7s/^/#/g` \u90fd\u662f\u4e00\u6837\u7684\u6548\u679c\u3002\\n \\n### \u4f7f\u7528\u5e2e\u52a9\uff1f \\n\\n> `:help command` \u67e5\u770b\u6307\u5b9a\u547d\u4ee4\u7684\u5e2e\u52a9\\n`Ctrl+]` \u6253\u5f00\u5e2e\u52a9\u6587\u6863\u4e2d\u7684\u6587\u672c\u94fe\u63a5\uff0c `Ctrl+t` \u53ef\u8fd4\u56de\u4e4b\u524d\u7684\u6587\u4ef6\\n\\n### \u4e0d\u5c0f\u5fc3\u5728\u5f53\u524d\u9762\u677f\u6253\u5f00\u4e86\u65b0\u7684\u6587\u4ef6\u8986\u76d6\u4e86\u6b63\u5728\u7f16\u8f91\u7684\u6587\u4ef6. \u5982\u4f55\u8fd4\u56de\u4e4b\u524d\u6253\u5f00\u7684\u6587\u4ef6\uff1f\\n1. \u4f7f\u7528 `Ctrl+^ (\u5373 Ctrl+Shift+6)` \u6216\u8005 `Ctrl+6` \u53ef\u5feb\u901f\u8fd4\u56de\u4e4b\u524d\u6253\u5f00\u7684\u6587\u4ef6\uff0c\u518d\u6309\u53c8\u4f1a\u56de\u5230\u5f53\u524d\u6587\u4ef6\\n2. \u4f7f\u7528 `:ls` \u6d4f\u89c8\u6240\u6709\u7f13\u51b2\u533a\u6587\u4ef6\uff0c\u627e\u5230\u8981\u7f16\u8f91\u7684\u6587\u4ef6\u6240\u5728\u7684\u7f16\u53f7\uff0c\u4f7f\u7528 `:b number` e.g. `:b 2`\\n\\n### \u524d\u8fdb\u548c\u540e\u9000\u529f\u80fd\\n\\n\u53ef\u4ee5\u5728\u6587\u4ef6\u4e2d\u66fe\u7ecf\u6d4f\u89c8\u8fc7\u7684\u4f4d\u7f6e\u4e4b\u95f4\u6765\u56de\u79fb\u52a8\u3002\u5728 vim \u4e2d\u4f7f\u7528 `Ctrl-o` \u6267\u884c\u540e\u9000\uff0c\u4f7f\u7528 `Ctrl-i` \u6267\u884c\u524d\u8fdb\u3002\\n\\n###  \u683c\u5f0f\u5316\u7c98\u8d34\\n\\nvim\u7c98\u8d34\u4ee3\u7801\u65e0\u6cd5\u4fdd\u6301\u539f\u6765\u7684\u683c\u5f0f\uff0c\u6709\u6ce8\u91ca\u7684\u8bdd\u8fd8\u4f1a\u628a\u4f59\u4e0b\u7684\u884c\u90fd\u7ed9\u52a0\u4e0a\u6ce8\u91ca\u3002\u5f88\u4e0d\u65b9\u4fbf\u3002\\n\\n\u5728\u7c98\u8d34\u524d\uff1a `:set paste` \u518d\u7c98\u8d34\u5c31\u4e0d\u4f1a\u6709\u8fd9\u4e2a\u95ee\u9898\u4e86\uff0c\u7c98\u8d34\u540e `:set nopaste` \u8fd8\u539f\u8bbe\u7f6e\u3002\\n\\n> \u53ef\u4ee5\u5728\u914d\u7f6e\u91cc\u8bbe\u7f6e\u5feb\u6377\u952e\u66f4\u65b9\u4fbf\u5207\u6362\\n\\n\\n## tab \u6807\u7b7e\u9875\u7684\u4f7f\u7528\\n- \u547d\u4ee4\uff1a\\n```\\n:tabnew [++opt\u9009\u9879] \uff3b\uff0bcmd\uff3d \u6587\u4ef6  \u5efa\u7acb\u5bf9\u6307\u5b9a\u6587\u4ef6\u65b0\u7684tab\\n:tabc       \u5173\u95ed\u5f53\u524d\u7684tab\\n:tabo       \u5173\u95ed\u6240\u6709\u5176\u4ed6\u7684tab\\n:tabs       \u67e5\u770b\u6240\u6709\u6253\u5f00\u7684tab\\n:tabp      \u524d\u4e00\u4e2a\\n:tabn      \u540e\u4e00\u4e2a\\n:tabfrist     \u7b2c\u4e00\u4e2a\\n:tablast     \u6700\u540e\u4e00\u4e2a\\n```\\n- \u6807\u51c6\u6a21\u5f0f\u4e0b\uff1a\\n`gt` , `gT` \u53ef\u4ee5\u76f4\u63a5\u5728tab\u4e4b\u95f4\u5207\u6362\u3002\\n\u5728\u524d\u9762\u52a0\u4e0a\u6570\u5b57\u4e5f\u53ef\u4ee5\u5207\u5230\u6307\u5b9a\u7684tab, e.g. `2gt` \u8df3\u5230\u7b2c\u4e8c\u4e2atab\\n\u66f4\u591a\u53ef\u4ee5\u67e5\u770b\u5e2e\u52a9 `:help table` \uff0c `help -p`\\n\\n### \u590d\u5236\u526a\u5207\\n\\nVim \u670912\u4e2a\u7c98\u8d34\u677f\u4f9d\u6b21\u7f16\u53f7\u4e3a\uff1a`0\u30011\u30012\u3001...\u30019\u3001a\u3001\\"\u3001+`\uff0c\u5176\u4e2d `+` \u53f7\u4e3a\u7cfb\u7edf\u7c98\u8d34\u677f\uff0c`\u201d` \u4e3a\u4e34\u65f6\u7c98\u8d34\u677f\u3002\u7cfb\u7edf\u526a\u5207\u677f\u4e2d\u7684\u5185\u5bb9\u53ef\u5728\u5176\u4ed6\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u3002\\n\u4e0a\u9762\u7684\u590d\u5236\u6307\u4ee4\u90fd\u53ef\u4ee5\u914d\u5408\u526a\u5207\u677f\u8fdb\u884c\u64cd\u4f5c\u3002\\n\\n- `\\"nyw` \u590d\u5236\u5f53\u524d\u5355\u8bcd\u5230 n \u53f7\u526a\u5207\u677f\uff08\u53cc\u5f15\u53f7\u5f00\u59cb\uff09 \\n- `\\"np` \u7c98\u8d34 n \u53f7\u526a\u5207\u677f\u5185\u5bb9\u5230\u5f53\u524d\u4f4d\u7f6e\u540e \\n- `\\"+y` \u590d\u5236\u5f53\u524d\u884c\u5230\u7cfb\u7edf\u526a\u5207\u677f\\n- `\\"+ny` \u590d\u5236\u5f53\u524d\u884c\u52a0\u4e0b\u9762 n \u884c\u5230\u7cfb\u7edf\u526a\u5207\u677f\\n- `\\"+p` \u7c98\u8d34\u7cfb\u7edf\u526a\u5207\u677f\u5185\u5bb9\u5230\u5f53\u524d\u4f4d\u7f6e\u540e\\n\\n> \u4e0a\u9762\u7684\u64cd\u4f5c\u82e5\u65e0\u6cd5\u590d\u5236\u6216\u526a\u5207\u5230\u7cfb\u7edf\u526a\u5207\u677f\uff0c\u5219\u53ef\u80fd\u662f\u6ca1\u6709\u6253\u5f00 `clipboard`\u3002\u53ef\u7528 `:ve`\u67e5\u770b\u662f\u5426\u529f\u80fd\u6253\u5f00\u3002\\n\\n- `Shift-Insert` \u4e5f\u53ef\u590d\u5236\u7cfb\u7edf\u526a\u5207\u677f\u7684\u5185\u5bb9\u5230vim\\n\\n\u53e6\u5916\u7684\u5b9e\u73b0\u590d\u5236\u65b9\u6cd5(\u6765\u81ea[\u5728\u65e0clipboard \u7684vim \u4e2d\uff0c \u5982\u4f55\u4f7f\u7528\u7cfb\u7edf\u526a\u5207\u677f][vim-cp])\uff1a\\n\\n1. \u6309\u4f4fshift \u952e\uff0c\u9f20\u6807\u9009\u62e9\u3002\\n\u6309\u4f4f `Shift` \u952e\u4e0d\u677e\u624b\uff0c\u7528 `\u9f20\u6807\u5de6\u952e` \u9009\u62e9\u6587\u672c\uff0c\u518d\u4f7f\u7528 \u9f20\u6807\u53f3\u952e \u53ef\u6253\u5f00\u7cfb\u7edf\u53f3\u952e\u83dc\u5355(\u6b64\u65f6\u4ecd\u7136\u4e0d\u8981\u677e\u5f00`Shift`)\uff0c\u9009\u62e9`\u590d\u5236`\u5373\u53ef\u3002\\n2. \u8bbe\u7f6e\u9009\u9879\uff0c\u5173\u95edmouse, \u518d\u7528\u9f20\u6807\u9009\u62e9\u3002\\n\\n\\n[vim-cp]:http://blog.csdn.net/hejinjing_tom_com/article/details/25876287"},{"id":"git-usage-records","metadata":{"permalink":"/blog/git-usage-records","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/04-11-git-usage-records.md","source":"@site/blog/2016/04-11-git-usage-records.md","title":"git \u4f7f\u7528\u8bb0\u5f55","description":"git \u4f7f\u7528\u4e00\u4e9b\u8bb0\u5f55\uff0c\u5e38\u7528\u547d\u4ee4\u548c\u4e00\u4e9b\u7279\u6b8a\u9009\u9879","date":"2016-04-11T16:51:00.000Z","formattedDate":"2016\u5e744\u670811\u65e5","tags":[{"label":"git","permalink":"/blog/tags/git"}],"readingTime":7.275,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"git \u4f7f\u7528\u8bb0\u5f55","tags":["git"],"date":"2016-04-11T16:51","slug":"git-usage-records","authors":["inhere","network"]},"prevItem":{"title":"vim \u4f7f\u7528\u8bb0\u5f55","permalink":"/blog/vim-usage-records"},"nextItem":{"title":"\u5b89\u88c5centos 7 \u540e\u7684\u4e00\u4e9b\u8bbe\u7f6e\u8bb0\u5f55","permalink":"/blog/centos7-init-setting-after-install"}},"content":"`git` \u4f7f\u7528\u4e00\u4e9b\u8bb0\u5f55\uff0c\u5e38\u7528\u547d\u4ee4\u548c\u4e00\u4e9b\u7279\u6b8a\u9009\u9879\\n\\n\x3c!--truncate--\x3e\\n\\n## pull\u548cmerge\\n\\n\u63d0\u5021\u6dfb\u52a0\u9009\u9879 `--no-ff` -- _\u4e0d\u4f7f\u7528\u5feb\u901f\u5408\u5e76_\\n\\n## \u6587\u4ef6\u6743\u9650\u4fee\u6539\u5f15\u8d77\u7684\u51b2\u7a81\\n\\n\u901a\u5e38\u662f\u56e0\u4e3a\u5f00\u53d1\u73af\u5883\u548c\u8fd0\u884c\u73af\u5883\u662f\u4e0d\u540c\u7684\u7cfb\u7edf\uff0c\u53d1\u5e03\u9879\u76ee\u5230\u7ebf\u4e0a\u65f6\uff0c\u5f88\u591a\u65f6\u5019\u9700\u8981\u4fee\u6539\u6587\u4ef6\u7684\u6743\u9650\u3002\u4f46git\u628a\u6587\u4ef6\u6743\u9650\u4e5f\u5217\u5165\u4e86\u7248\u672c\u7ba1\u7406\u3002\\n\\n### \u89e3\u51b3\u529e\u6cd5\uff1a\\n\\ngit\u4e2d\u53ef\u4ee5\u52a0\u5165\u5ffd\u7565\u6587\u4ef6\u6743\u9650\u7684\u914d\u7f6e\uff0c\u5177\u4f53\u5982\u4e0b\uff1a\\n\\n```\\n$ git config core.filemode false // \u4ec5\u5bf9\u5f53\u524d\u9879\u76ee\u6709\u6548\\n$ git config --global core.filemode false // \u5c06\u914d\u7f6e\u5e94\u7528\u5230\u5168\u5c40\\n```\\n\\n\u8fd9\u6837\u5c31\u8bbe\u7f6e\u4e86\u5ffd\u7565\u6587\u4ef6\u6743\u9650\u3002\u67e5\u770b\u4e0b\u914d\u7f6e\uff1a\\n\\n```\\n$ git config -l\\n\\nalias.co=checkout\\nalias.br=branch\\ncore.filemode=false\\ncore.repositoryformatversion=0\\n```\\n\\n\\n## Git\u6253TAG\\n\\n> \u6253TAG\u4e5f\u5c31\u662f\u53d1\u5e03\u7248\u672c\\n\\n```\\n$ git tag -a v1.2 -m \\"version 1.4\\"\\n$ git push --tags\\n```\\n\\n## Git\u6253\u5305\u6e90\u7801\\n\\n\u5bf9Git\u7ba1\u7406\u7684\u6e90\u7801\u8fdb\u884c\u538b\u7f29\u6253\u5305\uff0c\u5982\u679c\u4f7f\u7528`tar xvzf xxxx.tag.gz xxxxx`\u7684\u8bdd\u5e76\u4e0d\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u9009\u62e9\uff0c\u56e0\u4e3a\u4f1a\u5c06`.git/`\u76ee\u5f55\u4e0b\u7684\u4e2d\u95f4\u6587\u4ef6\u5168\u90e8\u538b\u7f29\uff0c\u5982\u679c\u53ea\u60f3\u8981\u67d0\u4e00\u4e2a\u7248\u672c\u7684\u6e90\u7801\u3002\\nGit\u63d0\u4f9b\u4e86`archive` \u5b83\u4f1a\u7ed9\u6253\u5305\u4e00\u4efd\u7eaf\u51c0\u7684\u4ee3\u7801\u3002\u5f53\u7136\u8fd9\u4e2a\u53ea\u9002\u7528\u4e8e\u53d1\u90e8\u4e00\u4e2a\u7248\u672c\u7684\u6e90\u7801\uff0c\u800c\u4e0d\u662f\u5907\u4efdGit\u7ba1\u7406\u7684\u6574\u5957\u6e90\u7801\u3002\\n\\n```\\n$ git archive xxxx\\n```\\n\\n> xxx\u4ee3\u8868SHA-1 Hash\u503c\u3002\\n\\n## Git\u53eaclone\u6700\u65b0\u7248\u672c\u4ee3\u7801\u4e0d\u8981.git\u76ee\u5f55\\n\\n```\\ngit clone --depth=1 git://someserver/somerepo dirformynewrepo\\nrm -rf !$/.git\\n```\\n\\n## \u4e0d\u4ea7\u751f merge commit\\n\\n\u901a\u5e38 `merge/pull` \u4f1a\u4ea7\u751f\u4e00\u4e2a merge commit,\u8ba9\u63d0\u4ea4\u8bb0\u5f55\u770b\u8d77\u6765\u4e0d\u592a\u7f8e\u89c2\uff0c\u53ef\u4ee5\u4f7f\u7528 `rebase`\u9009\u9879\u6765\u5408\u5e76commit\\n\\n```\\n$ git pull --rebase origin master\\n```\\n\\n## \u5408\u5e76\u65f6\u53ea\u4ea7\u751f\u5408\u5e76\u63d0\u4ea4\\n\\n> \u8fd8\u6709\u5176\u5b83\u8bf4\u6cd5\uff1a\u5408\u5e76\u65f6\u4e0d\u5408\u5e76\u5386\u53f2\uff1b\u5408\u5e76\u65f6\u5c06\u6240\u6709commit\u5408\u4e3a\u4e00\u4e2a\u3002\\n\\n```\\ngit pull --squash another\\n```\\n\\n\u4e00\u822c\u7528\u4e8emaster\u5206\u652f\uff0c\u50cflinus\u7684linux\u5185\u6838\u4e00\u6837\u3002\\n\u66f4\u591a\u4fe1\u606f\u89c1\u300aGit merge no history commit\u300b\u300agit merge \u2013squash\u4ecb\u7ecd\u300b\\n\\n## \u6dfb\u52a0\u7a7a\u76ee\u5f55\\n\\n```\\n$ find . -type d -empty -exec touch {}/.gitkeep \\\\;\\n```\\n\\n\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\u5c06\u4f1a\u5728\u7a7a\u76ee\u5f55\u4e2d\u6dfb\u52a0\u4e00\u4e2a`.gitkeep`\u6587\u4ef6\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u7a7a\u76ee\u5f55\u4e0d\u88ab\u5ffd\u7565\uff0c\u4e14\u4e0d\u5f71\u54cd\u539f\u4ee3\u7801\u7684\u7ed3\u6784\u3002\\n\\n\u4ee5\u4e0a\u53c2\u8003\u8f6c\u81ea [Git\u6df1\u5ea6\u4f7f\u7528\u7ecf\u9a8c\u603b\u7ed3](http://blog.csdn.net/kangear/article/details/13169395)\\n\\n## \u8f93\u51fa\u6700\u540e\u4e00\u6b21\u63d0\u4ea4\u7684\u6539\u53d8\\n\\n\u8fd9\u4e2a\u547d\u4ee4\uff0c\u6211\u7ecf\u5e38\u4f7f\u7528\u5b83 \u6765\u53d1\u9001\u5176\u4ed6\u6ca1\u6709\u4f7f\u7528git\u7684\u4eba\u6765\u68c0\u67e5\u6216\u8005\u96c6\u6210\u6240\u4fee\u6539\u7684\u3002\u5b83\u4f1a\u8f93\u51fa\u6700\u8fd1\u63d0\u4ea4\u7684\u4fee\u6539\u5185\u5bb9\u5230\u4e00\u4e2azip\u6587\u4ef6\u4e2d\u3002\\n\\n```\\ngit archive -o ../updated.zip HEAD $(git diff --name-only HEAD^)\\n```\\n\\n## \u8f93\u51fa\u4e24\u4e2a\u63d0\u4ea4\u95f4\u7684\u6539\u53d8\\n\u7c7b\u4f3c\u7684\uff0c\u5982\u679c\u4f60\u9700\u8981\u8f93\u51fa\u67d0\u4e24\u4e2a\u63d0\u4ea4\u95f4\u7684\u6539\u53d8\u65f6\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u3002\\n\\n```\\ngit archive -o ../latest.zip NEW_COMMIT_ID_HERE $(git diff --name-only OLD_COMMIT_ID_HERE NEW_COMMIT_ID_HERE)\\n```\\n\\n## \u514b\u9686 \u6307\u5b9a\u7684\u8fdc\u7a0b\u5206\u652f\\n\\n\u5982\u679c\u4f60\u6e34\u671b\u53ea\u514b\u9686\u8fdc\u7a0b\u4ed3\u5e93\u7684\u4e00\u4e2a\u6307\u5b9a\u5206\u652f\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u4ed3\u5e93\u5206\u652f\uff0c\u8fd9\u5bf9\u4f60\u5e2e\u52a9\u5f88\u5927\u3002\\n\\n```\\ngit init\\ngit remote add -t BRANCH_NAME_HERE -f origin REMOTE_REPO_URL_PATH_HERE\\ngit checkout BRANCH_NAME_HERE\\n```\\n\\n## \u5e94\u7528 \u4ece\u4e0d\u76f8\u5173\u7684\u672c\u5730\u4ed3\u5e93\u6765\u7684\u8865\u4e01\\n\\n\u5982\u679c\u4f60\u9700\u8981\u5176\u5b83\u4e00\u4e9b\u4e0d\u76f8\u5173\u7684\u672c\u5730\u4ed3\u5e93\u4f5c\u4e3a\u4f60\u73b0\u5728\u4ed3\u5e93\u7684\u8865\u4e01\uff0c\u8fd9\u91cc\u5c31\u662f\u901a\u5f80\u90a3\u91cc\u7684\u6377\u5f84\u3002\\n\\n```\\ngit --git-dir=PATH_TO_OTHER_REPOSITORY_HERE/.git format-patch -k -1 --stdout COMMIT_HASH_ID_HERE| git am -3 -k\\n```\\n\\n## \u68c0\u6d4b \u4f60\u7684\u5206\u652f\u7684\u6539\u53d8\u662f\u5426\u4e3a\u5176\u5b83\u5206\u652f\u7684\u4e00\u90e8\u5206\\n\\n`cherry`\u547d\u4ee4\u8ba9\u6211\u4eec\u68c0\u6d4b\u4f60\u7684\u5206\u652f\u7684\u6539\u53d8\u662f\u5426\u51fa\u73b0\u5728\u5176\u5b83\u4e00\u4e9b\u5206\u652f\u4e2d\u3002\u5b83\u901a\u8fc7+\u6216\u8005-\u7b26\u53f7\u6765\u663e\u793a\u4ece\u5f53\u524d\u5206\u652f\u4e0e\u6240\u7ed9\u7684\u5206\u652f\u4e4b\u95f4\u7684\u6539\u53d8\uff1a\u662f\u5426\u5408\u5e76\u4e86(merged)\u3002.+ \u6307\u793a\u6ca1\u6709\u51fa\u73b0\u5728\u6240\u7ed9\u5206\u652f\u4e2d\uff0c\u53cd\u4e4b\uff0c- \u5c31\u8868\u793a\u51fa\u73b0\u5728\u4e86\u6240\u7ed9\u7684\u5206\u652f\u4e2d\u4e86\u3002\u8fd9\u91cc\u5c31\u662f\u5982\u4f55\u53bb\u68c0\u6d4b\uff1a\\n\\n```\\ngit cherry -v OTHER_BRANCH_NAME_HERE\\n# \u4f8b\u5982: \u68c0\u6d4bmaster\u5206\u652f\\ngit cherry -v master\\n```\\n\\n## \u5f00\u59cb\u4e00\u4e2a\u65e0\u5386\u53f2\u7684\u65b0\u5206\u652f\\n\\n\u6709\u65f6\uff0c\u4f60\u9700\u8981\u5f00\u59cb\u4e00\u4e2a\u65b0\u5206\u652f\uff0c\u4f46\u662f\u53c8\u4e0d\u60f3\u628a\u5f88\u957f\u5f88\u957f\u7684\u5386\u53f2\u8bb0\u5f55\u5e26\u8fdb\u6765\uff0c\u4f8b\u5982\uff0c\u4f60\u60f3\u5728\u516c\u4f17\u533a\u57df\uff08\u5f00\u6e90\uff09\u653e\u7f6e\u4f60\u7684\u4ee3\u7801\uff0c\u4f46\u662f\u53c8\u4e0d\u60f3\u522b\u4eba\u77e5\u9053\u5b83\u7684\u5386\u53f2\u8bb0\u5f55\u3002\\n\\n```\\ngit checkout --orphan NEW_BRANCH_NAME_HERE\\n```\\n\\n## \u65e0\u5207\u6362\u5206\u652f\u7684\u4ece\u5176\u5b83\u5206\u652fCheckout\u6587\u4ef6\\n\\n\u4e0d\u60f3\u5207\u6362\u5206\u652f\uff0c\u4f46\u662f\u53c8\u60f3\u4ece\u5176\u5b83\u5206\u652f\u4e2d\u83b7\u5f97\u4f60\u9700\u8981\u7684\u6587\u4ef6\uff1a\\n\\n```\\ngit checkout BRANCH_NAME_HERE -- PATH_TO_FILE_IN_BRANCH_HERE\\n```\\n\\n## \u5ffd\u7565\u5df2\u8ffd\u8e2a\u6587\u4ef6\u7684\u53d8\u52a8\\n\\n\u5982\u679c\u60a8\u6b63\u5728\u4e00\u4e2a\u56e2\u961f\u4e2d\u5de5\u4f5c\uff0c\u800c\u4e14\u5927\u5bb6\u90fd\u5728\u540c\u4e00\u6761branch\u4e0a\u9762\u5de5\u4f5c\uff0c\u90a3\u4e48\u60a8\u5f88\u6709\u53ef\u80fd\u4f1a\u7ecf\u5e38\u7528\u5230fetch\u548cmerge\u3002\u4f46\u662f\u6709\u65f6\u5019\u8fd9\u6837\u4f1a\u91cd\u7f6e\u60a8\u7684\u73af\u5883\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u6b64\u7684\u8bdd\uff0c\u60a8\u5c31\u5f97\u5728\u6bcf\u6b21merge\u540e\u4fee\u6539\u5b83\u3002\u4f7f\u7528\u8fd9\u4e00\u547d\u4ee4\uff0c\u60a8\u5c31\u80fd\u8981\u6c42git\u5ffd\u89c6\u6307\u5b9a\u6587\u4ef6\u7684\u53d8\u52a8\u3002\u8fd9\u6837\uff0c\u4e0b\u56de\u4f60\u518dmerge\u7684\u8bdd\uff0c\u8fd9\u4e2a\u6587\u4ef6\u5c31\u4e0d\u4f1a\u88ab\u4fee\u6539\u4e86\u3002\\n\\n```\\ngit update-index --assume-unchanged PATH_TO_FILE_HERE\\n```\\n\\n## \u68c0\u67e5\u63d0\u4ea4\u7684\u53d8\u52a8\u662f\u5426\u662frelease\u7684\u4e00\u90e8\u5206\\n\\nname-rev\u547d\u4ee4\u80fd\u544a\u8bc9\u60a8\u4e00\u4e2acommit\u76f8\u5bf9\u4e8e\u6700\u8fd1\u4e00\u6b21release\u7684\u4f4d\u7f6e\u3002\u4f7f\u7528\u8fd9\u6761\u547d\u4ee4\uff0c\u60a8\u5c31\u53ef\u4ee5\u68c0\u67e5\u60a8\u6240\u505a\u51fa\u7684\u6539\u52a8\u662f\u5426\u662frelease\u7684\u4e00\u90e8\u5206\u4e86\u3002\\n\\n```\\ngit name-rev --name-only COMMIT_HASH_HERE\\n```\\n\\n## \u4f7f\u7528rebase\u63a8\u9001\u800c\u975emerge\\n\\n\u5982\u679c\u60a8\u6b63\u5728\u56e2\u961f\u4e2d\u5de5\u4f5c\u5e76\u4e14\u6574\u4e2a\u56e2\u961f\u90fd\u5728\u540c\u4e00\u6761branch\u4e0a\u9762\u5de5\u4f5c\uff0c\u90a3\u4e48\u60a8\u5c31\u5f97\u7ecf\u5e38\u5730\u8fdb\u884cfetch/merge\u6216\u8005pull\u3002Git\u4e2d\uff0c\u5206\u652f\u7684\u5408\u5e76\u4ee5\u6240\u63d0\u4ea4\u7684merge\u6765\u8bb0\u5f55\uff0c\u4ee5\u6b64\u8868\u660e\u4e00\u6761feature\u5206\u652f\u4f55\u65f6\u4e0e\u4e3b\u5206\u652f\u5408\u5e76\u3002\u4f46\u662f\u5728\u591a\u56e2\u961f\u6210\u5458\u5171\u540c\u5de5\u4f5c\u4e8e\u4e00\u6761branch\u7684\u60c5\u5f62\u4e2d\uff0c\u5e38\u89c4\u7684merge\u4f1a\u5bfc\u81f4log\u4e2d\u51fa\u73b0\u591a\u6761\u6d88\u606f\uff0c\u4ece\u800c\u4ea7\u751f\u6df7\u6dc6\u3002\u56e0\u6b64\uff0c\u60a8\u53ef\u4ee5\u5728pull\u7684\u65f6\u5019\u4f7f\u7528rebase\uff0c\u4ee5\u6b64\u6765\u51cf\u5c11\u65e0\u7528\u7684merge\u6d88\u606f\uff0c\u4ece\u800c\u4fdd\u6301\u5386\u53f2\u8bb0\u5f55\u7684\u6e05\u6670\u3002\\n\\n```\\ngit pull --rebase\\n```\\n\\n\u60a8\u4e5f\u53ef\u4ee5\u5c06\u67d0\u6761branch\u914d\u7f6e\u4e3a\u603b\u662f\u4f7f\u7528rebase\u63a8\u9001\uff1a\\n\\n```\\ngit config branch.BRANCH_NAME_HERE.rebase true\\n```\\n\\n\u8f6c\u81ea [10 \u4e2a\u5f88\u6709\u7528\u7684\u9ad8\u7ea7 Git \u547d\u4ee4](http://www.oschina.net/translate/10-useful-advanced-git-commands)"},{"id":"centos7-init-setting-after-install","metadata":{"permalink":"/blog/centos7-init-setting-after-install","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/04-09-centos7-init-setting-after-install.md","source":"@site/blog/2016/04-09-centos7-init-setting-after-install.md","title":"\u5b89\u88c5centos 7 \u540e\u7684\u4e00\u4e9b\u8bbe\u7f6e\u8bb0\u5f55","description":"\u5b89\u88c5centos 7 \u540e\u7684\u4e00\u4e9b\u5e38\u7528\u8bbe\u7f6e\u8bb0\u5f55","date":"2016-04-09T16:51:00.000Z","formattedDate":"2016\u5e744\u67089\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"centos","permalink":"/blog/tags/centos"}],"readingTime":3.87,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"\u5b89\u88c5centos 7 \u540e\u7684\u4e00\u4e9b\u8bbe\u7f6e\u8bb0\u5f55","tags":["linux","centos"],"date":"2016-04-09T16:51","slug":"centos7-init-setting-after-install","authors":"inhere"},"prevItem":{"title":"git \u4f7f\u7528\u8bb0\u5f55","permalink":"/blog/git-usage-records"},"nextItem":{"title":"git \u627e\u56de\u4e22\u5931 commit","permalink":"/blog/revert-lost-commit-by-git-reflog"}},"content":"\u5b89\u88c5centos 7 \u540e\u7684\u4e00\u4e9b\u5e38\u7528\u8bbe\u7f6e\u8bb0\u5f55\\n\\n\x3c!--truncate--\x3e\\n\\n###  \u6dfb\u52a0\u7528\u6237\u5230 sudoers\\n\\n\u521a\u5b89\u88c5\u7cfb\u7edf\u540e \u4f7f\u7528 `sudo [command] ...` \u4f1a\u62a5\u9519\u8bef\u4fe1\u606f  `\u8be5\u7528\u6237\u4e0d\u5b58\u5728\u7fa4\u7ec4sudoers\u4e2d`\\n\\n```\\n$ su  // \u5207\u6362\u5230 root\\n$ vim /etc/sudoers\\n```\\n\\n\u627e\u5230 ` root  ALL=(ALL)   ALL`, \u540e\u9762\u6362\u884c\u5e76\u5c06\u5f53\u524d\u7528\u6237\u6dfb\u52a0\u8fdb\u53bb  \\n\\n```\\nroot  ALL=(ALL)   ALL\\n xxx   ALL=(ALL)   ALL\\n```\\n\\n\u4fdd\u5b58\u5e76\u9000\u51fa\\n\\n### \u65e0\u6cd5\u4f7f\u7528\u4e2d\u6587\u8f93\u5165\\n\\n\u5b9e\u9645\u4e0a \u5b89\u88c5\u7684\u7cfb\u7edf\u5df2\u7ecf\u6709\u62fc\u97f3\u8f93\u5165\u6cd5\u4e86\uff0c\u8bf7\u770b http://blog.csdn.net/alex_my/article/details/38223449\\n\\n### windows,linux \u53cc\u7cfb\u7edf\\n\\n\u6700\u597d\u662f\u5148\u5b89\u88c5\u4e86windows\u540e\u518d\u5b89\u88c5linux\u7cfb\u7edf\\n\\n- \u6302\u8f7d ntfs \u5206\u533a\\n\u8bf7\u770b [\u5b89\u88c5\u53cc\u7cfb\u7edf\u540e\uff0ccentos 7 \u5982\u4f55\u6302\u8f7d windows \u5206\u533a](http://yzone.net/blog/31)\\n\\n- \u6062\u590dwindows\u7684\u5f15\u5bfc\u9879\\n\u6253\u5f00\u7ec8\u7aef, \u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u5c31\u4f1a\u81ea\u52a8\u67e5\u627e\u786c\u76d8\u4e0a\u5df2\u6709\u7684\u7cfb\u7edf\uff0c\u5e76\u6dfb\u52a0\u76f8\u5e94\u7684\u5f15\u5bfc\\n\\n```\\n$ sudo update-grub // ubuntu \u4e00\u7c7b\u53ef\u7528\\n$ sudo grub2-mkconfig -o /boot/grub2/grub.cfg // centos \u4e00\u7c7b\u53ef\u7528\\n```\\n\\n- \u5220\u9664linux\u7cfb\u7edf\\nwindows\u4e0a\u4e0b\u5728\u4e00\u4e2a\u5206\u533a\u52a9\u624b\u4e4b\u7c7b\u7684\u5de5\u5177\uff0c\u6062\u590d\u7cfb\u7edf\u786c\u76d8\u7684`mbr`, \u5728\u683c\u5f0f\u5316 linux\u6240\u5728\u5206\u533a\u5373\u53ef\\n\\n### \u6dfb\u52a0 \u963f\u91cc\u4e91\u7684epel\u6e90\\n\\n1.\u5907\u4efd(\u5982\u6709\u914d\u7f6e\u5176\u4ed6epel\u6e90)\\n\\n```\\nmv /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.backup\\nmv /etc/yum.repos.d/epel-testing.repo /etc/yum.repos.d/epel-testing.repo.backup\\n```\\n\\n2.\u4e0b\u8f7d\u65b0repo \u5230`/etc/yum.repos.d/`\\n\\n```\\n// epel(RHEL 7) \\n$ sudo wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo\\n$ sudo yum update // update\\n```\\n\\n### \u4fee\u6539home\u4e0b\u7684\u4e2d\u6587\u76ee\u5f55\u4e3a\u82f1\u6587\u76ee\u5f55\\n\\n\u6253\u5f00\u7ec8\u7aef\uff0c\u5728\u7ec8\u7aef\u4e0b\u8f93\u5165\u547d\u4ee4\uff1a\\n\\n```\\n$ export LANG=en_US\\n$ xdg-user-dirs-gtk-update\\n```\\n\\n\u8fd9\u4e2a\u65f6\u5019\u4f1a\u5f39\u51fa\u4e00\u4e2a\u914d\u7f6e\u754c\u9762\uff0c\u63d0\u793a\u662f\u5426\u5c06\u4e2d\u6587\u76ee\u5f55\u5207\u6362\u4e3a\u82f1\u6587\u76ee\u5f55\u3002\u9009\u4e2d\u4e0d\u518d\u63d0\u793a\uff0c\u786e\u5b9a\u3002\u7cfb\u7edf\u4f1a\u5220\u9664\u6ca1\u6709\u5185\u5bb9\u7684\u4e2d\u6587\u76ee\u5f55\uff0c\u800c\u6709\u5185\u5bb9\u7684\u76ee\u5f55\u4f1a\u4fdd\u6301\u3002\\n\u5e76\u521b\u5efa8\u4e2a\u76f8\u5e94\u7684\u82f1\u6587\u76ee\u5f55\u5982\u4e0b\uff1a\u201cDesktop\u201d\u3001\u201cDownload\u201d\u3001\u201cTemplates\u201d\u3001\u201cPublic\u201d\u3001\u201cDocuments\u201d\u3001\u201cMusic\u201d\u3001\u201cPictures\u201d\u3001\u201cVideos\u201d\u3002\\n\u6b64\u65f6\uff0c\u60a8\u5728\u201c\u4f4d\u7f6e\u201d\u91cc\u770b\u5230\u7684\u5e38\u7528\u4e2d\u6587\u76ee\u5f55\u5df2\u7ecf\u53d8\u6210\u82f1\u6587\u76ee\u5f55\u3002\u53ea\u9700\u8981\u5c06\u539f\u4e2d\u6587\u76ee\u5f55\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u76f8\u5e94\u82f1\u6587\u76ee\u5f55\uff0c\u5e76\u5220\u9664\u4e2d\u6587\u76ee\u5f55\u5373\u53ef\u3002\\n\u63a5\u4e0b\u6765\u518d\u6267\u884c\\n   \\n```   \\n$ export LANG=zh_CN.UTF-8\\n```\\n\\n\u4ee5\u663e\u793a\u4e2d\u6587\u3002\\n\\n## \u4e00\u4e9b\u5e38\u7528\u5de5\u5177\\n\\n### tmux\\n\u5b89\u88c5 tmux  `sudo yum install tmux`\\n\\n### git\\n\u4ed3\u5e93\u4e2d\u7684git\u7248\u672c\u6709\u4e9b\u8001\u4e86\uff0c\u63a8\u8350\u624b\u52a8\u5b89\u88c5\u6700\u65b0\u7248\u7684\\n\u4e0b\u8f7d\u4f9d\u8d56\u5305\\n\\n```\\n$ sudo yum install zlib-devel perl-ExtUtils-MakeMaker openssl-devel libcurl-devel expat-devel asciidoc xmlto\\n```\\n\\n\u6e90\u7801\u4e0b\u8f7d\u5730\u5740 `https://github.com/git/git/releases`\\n\\n```\\n$ wget -c https://github.com/git/git/archive/v2.8.1.tar.gz\\n$ cd git-2.8.1/\\n$ make prefix=/usr/local all doc  // all \u5bf9\u6240\u6709\u7528\u6237\u53ef\u7528\uff0cdoc \u662f\u751f\u6210\u6587\u6863 \\n$ make prefix=/usr/local/git install\\n```\\n\\n\u52a0\u5165\u73af\u5883\u53d8\u91cf`vim  ~/.bashrc`\\n\\n```\\nexport PATH=/usr/local/git/bin:$PATH\\n```\\n\\n\\n### zsh \u548c oh-my-zsh\\n\\n\u67e5\u770b\u5df2\u6709\u7684shell `cat /etc/shells `\\n\u82e5\u6ca1\u6709\uff0c\u5148\u5b89\u88c5 zsh \\n\\n```\\n$ sudo yum install zsh\\n$ chsh -s /bin/zsh \\n```\\n\\n> \u82e5\u7528chsh\u547d\u4ee4\u4fee\u6539\u65e0\u6548\uff0c\u5219\u8fdb\u5165`/etc/passwd`\u4e2d\u4fee\u6539\u5f53\u524d\u7528\u6237\u7684shell\u73af\u5883\u3002\\n\\n\u5b89\u88c5oh-my-zsh -- [oh-my-zsh \u4e3b\u9875](https://github.com/robbyrussell/oh-my-zsh)\\n\\n```\\nsh -c \\"$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)\\"\\n```\\n\\n### rar \u538b\u7f29\u6587\u4ef6\u652f\u6301\\n\\n\u5728liunx\u4e0b\u539f\u672c\u662f\u4e0d\u652f\u6301rar\u6587\u4ef6\u7684\uff0c\u9700\u8981\u5b89\u88c5liunx\u4e0b\u7684winrar\u7248\u672c\uff0c\u64cd\u4f5c\u5982\u4e0b\\n\\n> \u4e0b\u8f7d\u9875\u9762 http://www.rarsoft.com/download.htm\\n\\n```\\n$ wget -O ~/Downloads/rarlinux-x64-5.3.tar.gz http://www.rarsoft.com/rar/rarlinux-x64-5.3.0.tar.gz\\n$ cd ~/Downloads/\\n$ tar -zxvf rarlinux-x64-5.3.tar.gz \\n$ cd rar  \\n$ sudo make                \\n[sudo] password for inhere: \\nmkdir -p /usr/local/bin\\nmkdir -p /usr/local/lib\\ncp rar unrar /usr/local/bin\\ncp rarfiles.lst /etc\\ncp default.sfx /usr/local/lib\\n```\\n\\n\u4e24\u4e2a\u5e38\u7528\u547d\u4ee4\uff1a\\n\\n```\\nrar x yhcsh.rar //\u89e3\u538b yhcsh.rar \u5230\u5f53\u524d\u76ee\u5f55\\nrar yhcsh.rar ./yhcsh/  //\u5c06 yhcsh \u76ee\u5f55\u6253\u5305\u4e3a yhcsh.rar\\n```"},{"id":"revert-lost-commit-by-git-reflog","metadata":{"permalink":"/blog/revert-lost-commit-by-git-reflog","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/04-01-revert-lost-commit-by-git-reflog.md","source":"@site/blog/2016/04-01-revert-lost-commit-by-git-reflog.md","title":"git \u627e\u56de\u4e22\u5931 commit","description":"\u5728\u4f7f\u7528git\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5e38\u6709\u5931\u8bef\u7684\u65f6\u5019\uff0c\u6709\u65f6\u628a\u9700\u8981\u7684\u4e1c\u897f\u7ed9\u5220\u4e86\u6216\u8005\u4f7f\u7528rebase\u8986\u76d6\u6389\u4e86\u4e00\u4e9b\u6709\u7528\u7684\u4ee3\u7801\u3002","date":"2016-04-01T12:30:00.000Z","formattedDate":"2016\u5e744\u67081\u65e5","tags":[{"label":"git","permalink":"/blog/tags/git"},{"label":"git-log","permalink":"/blog/tags/git-log"},{"label":"git-reflog","permalink":"/blog/tags/git-reflog"}],"readingTime":2.475,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"}],"frontMatter":{"title":"git \u627e\u56de\u4e22\u5931 commit","tags":["git","git-log","git-reflog"],"date":"2016-04-01T12:30","slug":"revert-lost-commit-by-git-reflog","authors":"inhere"},"prevItem":{"title":"\u5b89\u88c5centos 7 \u540e\u7684\u4e00\u4e9b\u8bbe\u7f6e\u8bb0\u5f55","permalink":"/blog/centos7-init-setting-after-install"},"nextItem":{"title":"Ubuntu \u4e0b\u6302\u8f7d\u4ee5\u53ca\u5378\u8f7dWindows\u5206\u533a","permalink":"/blog/mount-windows-pattern-on-ubuntu"}},"content":"\u5728\u4f7f\u7528git\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5e38\u6709\u5931\u8bef\u7684\u65f6\u5019\uff0c\u6709\u65f6\u628a\u9700\u8981\u7684\u4e1c\u897f\u7ed9\u5220\u4e86\u6216\u8005\u4f7f\u7528rebase\u8986\u76d6\u6389\u4e86\u4e00\u4e9b\u6709\u7528\u7684\u4ee3\u7801\u3002\\n\\n\u4e0d\u8fc7\u6ca1\u6709\u5173\u7cfb\uff0cgit\u7ed9\u4e86\u6211\u4eec\u4e00\u5c42\u5b89\u5168\u7f51\uff0c\u8ba9\u4eec\u80fd\u6709\u673a\u4f1a\u628a\u5931\u53bb\u7684\u4e1c\u897f\u7ed9\u627e\u56de\u6765\u3002 \\n\\n\x3c!--truncate--\x3e\\n\\n## \u67e5\u627e\u4e22\u5931\u7684\u8bb0\u5f55\\n\u5047\u8bbe\u4f60\u4e0d\u5c0f\u5fc3\u63d0\u4ea4\u4e86\u4e9b\u4f60\u4e0d\u60f3\u8981\u7684\u4e1c\u897f\uff0c\u4e0d\u5f97\u4e0d\u505a\u4e00\u6b21\u5f3a\u5236\u91cd\u7f6e\u6765\u6062\u590d\u5230\u4e4b\u524d\u7684\u72b6\u6001\u3002\\n\u7136\u540e\uff0c\u4f60\u610f\u8bc6\u5230\u5728\u8fd9\u4e00\u8fc7\u7a0b\u4e2d\u4f60\u4e22\u5931\u4e86\u5176\u5b83\u4e00\u4e9b\u4fe1\u606f\u5e76\u4e14\u60f3\u8981\u628a\u5b83\u4eec\u627e\u56de\u6765\uff0c\u6216\u8005\u81f3\u5c11\u7785\u4e00\u773c\u3002\u8fd9\u6b63\u662f`git reflog`\u53ef\u4ee5\u505a\u5230\u7684\u3002\\n\\n\u4e00\u4e2a\u7b80\u5355\u7684`git log`\u547d\u4ee4\u53ef\u4ee5\u4e3a\u4f60\u5c55\u793a\u6700\u540e\u4e00\u6b21commit\uff0c\u4ee5\u53ca\u5b83\u7684\u7236\u4eb2\uff0c\u8fd8\u6709\u5b83\u7236\u4eb2\u7684\u7236\u4eb2\u7b49\u7b49\u3002\u800c`git reflog`\u5219\u5217\u51fa\u4e86head\u66fe\u7ecf\u6307\u5411\u8fc7\u7684\u4e00\u7cfb\u5217commit\u3002\\n\\n> \u8981\u660e\u767d\u5b83\u4eec(\u4e22\u5931\u7684\u8bb0\u5f55)\u53ea\u5b58\u5728\u4e8e\u4f60\u672c\u673a\u4e2d,\u800c\u4e0d\u662f\u4f60\u7684\u7248\u672c\u4ed3\u5e93\u7684\u4e00\u90e8\u5206\uff0c\u4e5f\u4e0d\u5305\u542b\u5728push\u548cmerge\u64cd\u4f5c\u4e2d\u3002\\n\\n- \u5982\u679c\u6211\u8fd0\u884c`git log`\u547d\u4ee4\uff0c\u6211\u53ef\u4ee5\u770b\u5230\u4e00\u4e9bcommit\uff0c\u5b83\u4eec\u90fd\u662f\u6211\u4ed3\u5e93\u7684\u4e00\u90e8\u5206\uff1a\\n\\n```\\n$ git log -4\\ncommit 6b8df20b71fcd1622109c2319c13df3120cd3716\\nAuthor: xyz <xyz@compay.com>\\nDate:   Wed Mar 30 17:41:42 2016 +0800\\n\\n    update\\n\\ncommit bcb250dcda7ec609dda522d0bff38161a57e20d0\\nAuthor: xyz <xyz@compay.com>\\nDate:   Wed Mar 30 15:51:00 2016 +0800\\n\\n    update\\n\\ncommit 93d354756f8941201d0c53c7947766f6bd5955bf\\nAuthor: xyz <xyz@compay.com>\\nDate:   Wed Mar 30 13:38:07 2016 +0800\\n\\n    update Model.php,rename BaseController to Controller\\n\\ncommit 185bcfce1a9c3fb4164f675318d5ad0086ea39d1\\nAuthor: xyz <xyz@compay.com>\\nDate:   Wed Mar 30 11:35:39 2016 +0800\\n\\n    database operate update\\n\\n```\\n\\n- `git reflog`\u547d\u4ee4\u5219\u5c55\u793a\u4e86\u4e00\u6b21`9d7aabc HEAD@{1}: commit: update`\uff0c\u5b83\u662f\u4e00\u4e2a\u4e22\u5931\u6389\u7684\u63d0\u4ea4\u8bb0\u5f55\uff1a\\n\\n```\\n$ git reflog -4\\n6b8df20 HEAD@{0}: commit (amend): update\\n9d7aabc HEAD@{1}: commit: update\\nbcb250d HEAD@{2}: commit: update\\n93d3547 HEAD@{3}: commit (amend): update Model.php,rename BaseController to Controller\\n\\n```\\n\\n\u4f7f\u7528`git log 9d7aabc -p` \u6216\u8005 `git show 9d7aabc`\u67e5\u770b\u4e22\u5931\u4e86\u90a3\u4e9b\u6539\u52a8\\n\\n## \u5982\u4f55\u6062\u590d\u5462\\n\\n- \u4f7f\u7528rebase\uff0c\u7528\u547d\u4ee4`git rebase`\u6765\u8fdb\u884c\u6062\u590d\uff1a`$ git rebase 9d7aabc`\\n- \u4f7f\u7528merge\uff0c\u7528\u5408\u5e76\u547d\u4ee4`git merge`\u6765\u8fdb\u884c\u6062\u590d\uff1a`$ git merge 9d7aabc`\\n\\n\\n> \u53e6\u5916\u6709\u4e00\u7bc7\u535a\u6587\u4f7f\u7528 `git fsck --lost-found` [\u5982\u4f55\u627e\u56degit \u4e2d\u4e22\u5931\u7684\u63d0\u4ea4(commit) ](http://liuhui998.com/2010/10/22/recover_lost_commits_with_git/)"},{"id":"mount-windows-pattern-on-ubuntu","metadata":{"permalink":"/blog/mount-windows-pattern-on-ubuntu","editUrl":"https://github.com/inhere/inhere.github.io/tree/main/blog/2016/03-16-mount-windows-pattern-on-ubuntu.md","source":"@site/blog/2016/03-16-mount-windows-pattern-on-ubuntu.md","title":"Ubuntu \u4e0b\u6302\u8f7d\u4ee5\u53ca\u5378\u8f7dWindows\u5206\u533a","description":"\u5982\u4f55\u5728Linux(Ubuntu) \u4e0b\u6302\u8f7d\u4ee5\u53ca\u5378\u8f7dWindows\u5206\u533a, \u81ea\u52a8\u6302\u8f7d","date":"2016-03-16T13:00:00.000Z","formattedDate":"2016\u5e743\u670816\u65e5","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"ubuntu","permalink":"/blog/tags/ubuntu"},{"label":"windows","permalink":"/blog/tags/windows"}],"readingTime":3.775,"hasTruncateMarker":true,"authors":[{"name":"inhere","title":"docs maintainer","url":"https://github.com/inhere","imageURL":"https://github.com/inhere.png","key":"inhere"},{"name":"From Network","title":"Contents from network","key":"network"}],"frontMatter":{"title":"Ubuntu \u4e0b\u6302\u8f7d\u4ee5\u53ca\u5378\u8f7dWindows\u5206\u533a","tags":["linux","ubuntu","windows"],"date":"2016-03-16T13:00","slug":"mount-windows-pattern-on-ubuntu","authors":["inhere","network"]},"prevItem":{"title":"git \u627e\u56de\u4e22\u5931 commit","permalink":"/blog/revert-lost-commit-by-git-reflog"}},"content":"\u5982\u4f55\u5728Linux(Ubuntu) \u4e0b\u6302\u8f7d\u4ee5\u53ca\u5378\u8f7dWindows\u5206\u533a, \u81ea\u52a8\u6302\u8f7d \\n\\n\x3c!--truncate--\x3e\\n## 1. \u624b\u5de5\u6302\u8f7d\\n\\n1) \u9996\u5148\u4f60\u5f97\u77e5\u9053Linux\u4e0b\u5bf9\u786c\u76d8\u5206\u533a\u7684\u79f0\u547c\u3002\\n\\n```\\nsudo fdisk -l\\n\\nDisk /dev/sda: 160.0 GB, 160041885696 bytes\\n255 heads, 63 sectors/track, 19457 cylinders\\nUnits = cylinders of 16065 * 512 = 8225280 bytes\\nDisk identifier: 0xf0b1ebb0\\n\\n   Device Boot      Start         End      Blocks   Id  System\\n/dev/sda1   *           1        2612    20980858+   7  HPFS/NTFS\\n/dev/sda2            2613       19457   135307462+   f  W95 Ext\'d (LBA)\\n/dev/sda5            2613        6529    31463271    7  HPFS/NTFS\\n/dev/sda6           11753       19457    61890381    7  HPFS/NTFS\\n/dev/sda7            6530        6778     2000061   82  Linux swap / Solaris\\n/dev/sda8            6779       11752    39953623+  83  Linux\\n```\\n\\n> \u5176\u4e2d\u662f/dev/sda1 \u548c /dev/sda2\u4e3b\u5206\u533a\uff0c\u5176\u4f59\u7684\u662f\u903b\u8f91\u5206\u533a\u3002/dev/sda1 \u662fWindows \u4e0b\u7684c\u76d8\uff0c`/dev/sda5` \u662fWindows \u4e0b\u7684D\u76d8\uff0c`/dev/sda6` \u662fWindows \u4e0b\u7684F\u76d8\uff0c\uff08\u6211\u7684E\u76d8\u662f\u5149\u9a71\uff09\u3002\\n\\n2) \u786e\u5b9a\u4f60\u6240\u7528\u7684Linux\u7cfb\u7edf\u7684locale\uff08\u8fd9\u4e2alocale\u5305\u62ec\u4e86\u7cfb\u7edf\u4f7f\u7528\u7684\u8bed\u8a00\u548c\u5b57\u7b26\u7684\u7f16\u7801\u7b49\u4fe1\u606f\uff09\u3002\u4e2d\u6587 Linux \u5e38\u7528\u7684locale\u662fzh_CN.gb2312\uff0czh_CN.gbk\uff0czh_CN.gb18030 \u548c zh_CN.UTF-8 \u3002\\n\\n\u5728\u9ed8\u8ba4\u5b89\u88c5\u4e2d\uff0cDebian Linux\u548cMandriva Linux\u7684locale\u662fzh_CN.gb2312,\u800cUbuntu Linux\u548cFedora Linux\u7684locale\u662fzh_CN.UTF-8 \u3002\u6700\u597d\u4e0d\u8981\u968f\u4fbf\u66f4\u6539locale\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u5f88\u591a\u4e71\u7801\u7684\u60c5\u5f62\u3002\u8981\u67e5\u770b\u7cfb\u7edf\u7684locale\uff0c\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e0b\u8f93\u5165\u4e0b\u9762\u7684\u547d\u4ee4\u67e5\u770b\uff1a\\n\\n`echo $LANG`\\n\\n3) \u4f60\u5f97\u77e5\u9053\u4f60\u7684windows\u5206\u533a\u7684\u683c\u5f0f\uff0c\u8fd9\u4e2a\u5728windows\u7684\u5206\u533a\u7684\u5c5e\u6027\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u4e00\u822c\u662ffat32\u548cntfs\u683c\u5f0f\u7684\u3002\\n\\n\u5047\u8bbe\u4f60\u7684locale\u662fzh_CN.UTF-8\uff0c\u8981\u6302\u8f7d\u4e00\u4e2a/dev/sda1\u7684fat32\u683c\u5f0f\u7684windows\u5206\u533a\u5230/mnt/C\u76ee\u5f55\uff08\u82e5\u8fd9\u4e2a\u76ee\u5f55\u4e0d\u5b58\u5728\u624b\u5de5\u65b0\u5efa\u4e00\u4e2asudo mkdir /mnt/C\uff09\uff0c\u53ef\u4ee5\u5728\u7ec8\u7aef\u4e0b\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4(\u5728Ubuntu\u91cc\u8fd8\u9700\u8981\u5728\u8fd9\u884c\u547d\u4ee4\u524d\u52a0\u4e0asudo)\uff1a\\n\\n```bash\\nmount -t vfat /dev/sda1 /mnt/C -o iocharset=utf8\\n```\\n\\n\u5982\u679c\u4f60\u7684locale\u4e0d\u662fzh_CN.UTF-8\uff0c\u628a\u4e0a\u9762\u547d\u4ee4\u7684utf8\u6539\u4e3agb2312\uff1b\u5982\u679c\u8fd9\u4e2awindows\u5206\u533a\u662fntfs\u683c\u5f0f\u7684\uff0c\u5c06\u4e0a\u9762\u547d\u4ee4\u7684vfat\u6539\u4e3antfs\u3002\\n\\n\u8fd9\u6837\u6302\u8f7d\u7684ntfs\u683c\u5f0f\u7684\u5206\u533a\uff0c\u53ea\u6709root\u80fd\u8bfb\u53d6\uff0c\u5982\u679c\u9700\u8981\u8ba9\u666e\u901a\u7528\u6237\u4e5f\u80fd\u8bfb\u53d6\uff0c\u9700\u8981\u518d\u52a0\u4e0aumask=022\u9009\u9879\uff0c\u5982\u4e0b\uff1a\\n\\n```bash\\nmount -t ntfs /dev/sda1 /mnt/C -o iocharset=utf8,umask=022\\n```\\n\\n\u7c7b\u4f3c\u5730\uff0c\u5982\u679c\u8981\u8ba9\u6302\u8f7d\u7684\u5206\u533a\u5141\u8bb8\u6240\u6709\u7528\u6237\u8bfb\u53d6\u548c\u4fee\u6539\uff0c\u53ef\u4ee5\u5c06\u4e0a\u9762\u7684`umask=022`\uff0c\u6539\u4e3a`umask=0`\u5c31\u53ef\u4ee5\u4e86\u3002\\n\\n4) \u5378\u8f7d\u5206\u533a\u5c31\u7b80\u5355\u591a\u4e86\uff1a\\n\\n```bash\\numount /dev/sda1\\n```\\n\\n\u6709\u65f6\u5019\u5378\u8f7d\u5206\u533a\u65f6\u63d0\u793a\u5206\u533a\u7e41\u5fd9\uff08device is busy\uff09\uff0c\u53ef\u4ee5\u5148\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u770b\u770b\u54ea\u4e2a\u8fdb\u7a0b\u5728\u4f7f\u7528\u6b64\u5206\u533a\uff1a\\n\\n```bash\\nfuser -cu /dev/sda1\\n```\\n\\n\u5047\u5982\u5c4f\u5e55\u7684\u8f93\u51fa\u4e3a\\n\\n```bash\\n/dev/sda1: 8463m(cck)\\n```\\n\\n\u5219\u53ef\u4ee5\u7528\u6b64\u547d\u4ee4\u770b\u8fd9\u4e2a\u8fdb\u7a0b\u5bf9\u5e94\u7684\u7a0b\u5e8f\u540d\u5b57\uff1a\\n\\n```bash\\nps 8463\\n```\\n\\n\u7136\u540e\u53ef\u4ee5\u7528\u6b64\u547d\u4ee4\u7ed3\u675f\u6b64\u8fdb\u7a0b\uff1a\\n\\n```bash\\nkill -9 8463\\n```\\n\\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u6b63\u5e38\u5378\u8f7d\u5206\u533a\u4e86\u3002 \\n\\n\\n## 2. \u81ea\u52a8\u6302\u8f7d\\n\\n\u8981\u8ba9Linux\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u6302\u8f7dwindows\u5206\u533a\uff0c\u53ef\u4ee5\u628a\u4e0a\u8ff0\u7684\u547d\u4ee4\u5199\u5165 `/etc/fstab` \u6587\u4ef6\u4e2d\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff1a\\n\\n```\\n# <file system> <mount point>   <type>  <options>       <dump>  <pass>\\nproc            /proc           proc    defaults        0       0\\n# / was on /dev/sda8 during installation\\nUUID=c75b08d0-5763-4754-a269-09e759b746da /               ext4    errors=remount-ro 0       1\\n# swap was on /dev/sda7 during installation\\nUUID=86cd7015-66f4-4e91-bf36-f109818f8da4 none            swap    sw              0       0\\n\\n/dev/sda1 /mnt/C ntfs utf8,umask=022 0 0\\n/dev/sda5 /mnt/D ntfs utf8,umask=022 0 0\\n/dev/sda6 /mnt/F ntfs utf8,umask=022 0 0\\n```\\n\\nFrom: [Ubuntu \u4e0b\u6302\u8f7dWindows\u5206\u533a](http://blog.csdn.net/heyutao007/article/details/5447324)"}]}')}}]);